<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Active Directory, Azure AD, Windows security research"><meta name=author content=neutron><link href=https://neutronsec.com/active_directory/deeper_down_the_rabbithole/credentialed_enumeration_from_windows/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.4+insiders-4.23.1"><title>Credentialed Enumeration - Windows - neutronsec</title><link rel=stylesheet href=../../../assets/stylesheets/main.6148a559.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=neutronsec class="md-header__button md-logo" aria-label=neutronsec data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> neutronsec </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Credentialed Enumeration - Windows </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../about/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../docs/ class="md-tabs__link md-tabs__link--active"> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=neutronsec class="md-nav__button md-logo" aria-label=neutronsec data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> neutronsec </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../blog/ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Archive data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blog/archive/2022/ class=md-nav__link> <span class=md-ellipsis> 2022 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Categories data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blog/category/blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> </a> </li> <li class=md-nav__item> <a href=../../../blog/category/hackthebox/ class=md-nav__link> <span class=md-ellipsis> HackTheBox </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../../../docs/ class="md-nav__link "> <span class=md-ellipsis> Notes </span> </a> <label class="md-nav__link " for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> <span class=md-ellipsis> Cheatsheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1 type=checkbox id=__nav_4_2_1> <label class=md-nav__link for=__nav_4_2_1> <span class=md-ellipsis> Pentesting / CTF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pentesting / CTF" data-md-level=3> <label class=md-nav__title for=__nav_4_2_1> <span class="md-nav__icon md-icon"></span> Pentesting / CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1_1 type=checkbox id=__nav_4_2_1_1> <label class=md-nav__link for=__nav_4_2_1_1> <span class=md-ellipsis> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=4> <label class=md-nav__title for=__nav_4_2_1_1> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cheat_sheets/active_directory/cheatsheet_aid/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/active_directory/enumeration_and_attacks/ class=md-nav__link> <span class=md-ellipsis> Enumeration/Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/active_directory/exploitation/ class=md-nav__link> <span class=md-ellipsis> Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_1_2 type=checkbox id=__nav_4_2_1_2> <label class=md-nav__link for=__nav_4_2_1_2> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=4> <label class=md-nav__title for=__nav_4_2_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cheat_sheets/privesc/linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/privesc/windows/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/cheatsheet-77/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/linux_shortcuts/ class=md-nav__link> <span class=md-ellipsis> Linux Shortcuts </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/windows/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/shells_payloads/ class=md-nav__link> <span class=md-ellipsis> Shells & Payloads </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/web_requests/ class=md-nav__link> <span class=md-ellipsis> Web requests </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/deobfuscation/ class=md-nav__link> <span class=md-ellipsis> (De)Obfuscation </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/brute_forcing/ class=md-nav__link> <span class=md-ellipsis> Brute Forcing </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/common_apps/ class=md-nav__link> <span class=md-ellipsis> Common Applications </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/web_attacks/ class=md-nav__link> <span class=md-ellipsis> Web Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/file_transfer/ class=md-nav__link> <span class=md-ellipsis> File Transfer </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/footprinting/ class=md-nav__link> <span class=md-ellipsis> Footprinting </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/cheatsheet_ptpf/ class=md-nav__link> <span class=md-ellipsis> Pivoting, Tunnel, Port Forwarding </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/info_gathering_web/ class=md-nav__link> <span class=md-ellipsis> Information Gathering - Web </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/msf/ class=md-nav__link> <span class=md-ellipsis> MSF </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/password_attacks/ class=md-nav__link> <span class=md-ellipsis> Password Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/attacking_common_services/ class=md-nav__link> <span class=md-ellipsis> Attacking Common Services </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/ffuf/ class=md-nav__link> <span class=md-ellipsis> FFUF </span> </a> </li> <li class=md-nav__item> <a href=../../../cheat_sheets/hydra/ class=md-nav__link> <span class=md-ellipsis> Hydra </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3 checked> <label class=md-nav__link for=__nav_4_3> <span class=md-ellipsis> Red Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1 type=checkbox id=__nav_4_3_1 checked> <label class=md-nav__link for=__nav_4_3_1> <span class=md-ellipsis> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=3> <label class=md-nav__title for=__nav_4_3_1> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_1 type=checkbox id=__nav_4_3_1_1> <label class=md-nav__link for=__nav_4_3_1_1> <span class=md-ellipsis> Initial Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Initial Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_1> <span class="md-nav__icon md-icon"></span> Initial Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../initial_enum/external_recon_enum_principles/ class=md-nav__link> <span class=md-ellipsis> External Recon </span> </a> </li> <li class=md-nav__item> <a href=../../initial_enum/init_enum_domain/ class=md-nav__link> <span class=md-ellipsis> Initial Enumeration of the Domain </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_2 type=checkbox id=__nav_4_3_1_2> <label class=md-nav__link for=__nav_4_3_1_2> <span class=md-ellipsis> Gaining a Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Gaining a Foothold" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_2> <span class="md-nav__icon md-icon"></span> Gaining a Foothold </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foothold/llmnr_nbtns_poisonong_from_linux/ class=md-nav__link> <span class=md-ellipsis> LLMNR/NBT-NS Poisoning - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../foothold/llmnr_nbtns_poisonong_from_windows/ class=md-nav__link> <span class=md-ellipsis> LLMNR/NBT-NS Poisoning - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_3 type=checkbox id=__nav_4_3_1_3> <label class=md-nav__link for=__nav_4_3_1_3> <span class=md-ellipsis> Hunting for a User </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Hunting for a User" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_3> <span class="md-nav__icon md-icon"></span> Hunting for a User </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../userhunting/enumerate_retrieve_pwdpol/ class=md-nav__link> <span class=md-ellipsis> Enumerating & Retrieving PwdPols </span> </a> </li> <li class=md-nav__item> <a href=../../userhunting/pwd_spraying_target_user_list/ class=md-nav__link> <span class=md-ellipsis> Pwd Spraying - Making a Targeted User List </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_4 type=checkbox id=__nav_4_3_1_4> <label class=md-nav__link for=__nav_4_3_1_4> <span class=md-ellipsis> PwSpray </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PwSpray data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_4> <span class="md-nav__icon md-icon"></span> PwSpray </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../spray_responsibility/internal_pwd_spray_from_linux/ class=md-nav__link> <span class=md-ellipsis> Internal Spraying - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../spray_responsibility/internal_pwd_spray_from_windows/ class=md-nav__link> <span class=md-ellipsis> Internal Spraying - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_5 type=checkbox id=__nav_4_3_1_5 checked> <label class=md-nav__link for=__nav_4_3_1_5> <span class=md-ellipsis> Post Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Foothold" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_5> <span class="md-nav__icon md-icon"></span> Post Foothold </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../enumerating_security_controls/ class=md-nav__link> <span class=md-ellipsis> Enumerating Security Controls </span> </a> </li> <li class=md-nav__item> <a href=../credentialed_enumeration_from_linux/ class=md-nav__link> <span class=md-ellipsis> Credentialed Enumeration - Linux </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Credentialed Enumeration - Windows </span> </a> </li> <li class=md-nav__item> <a href=../living_off_the_land/ class=md-nav__link> <span class=md-ellipsis> Living Off The Land </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_6 type=checkbox id=__nav_4_3_1_6> <label class=md-nav__link for=__nav_4_3_1_6> <span class=md-ellipsis> Kerberoasting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kerberoasting data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_6> <span class="md-nav__icon md-icon"></span> Kerberoasting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cooking_with_fire/kerberoasting_from_linux/ class=md-nav__link> <span class=md-ellipsis> Kerberoasting - Linux </span> </a> </li> <li class=md-nav__item> <a href=../../cooking_with_fire/kerberoasting_from_windows/ class=md-nav__link> <span class=md-ellipsis> Kerberoasting - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_7 type=checkbox id=__nav_4_3_1_7> <label class=md-nav__link for=__nav_4_3_1_7> <span class=md-ellipsis> ACLs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ACLs data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_7> <span class="md-nav__icon md-icon"></span> ACLs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../acls/acl_enumeration/ class=md-nav__link> <span class=md-ellipsis> ACL Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../acls/acl_abuse/ class=md-nav__link> <span class=md-ellipsis> ACL Abuse Tactics </span> </a> </li> <li class=md-nav__item> <a href=../../acls/dcsync/ class=md-nav__link> <span class=md-ellipsis> DCSync </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_8 type=checkbox id=__nav_4_3_1_8> <label class=md-nav__link for=__nav_4_3_1_8> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_8> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../stacking_the_deck/privileged_access/ class=md-nav__link> <span class=md-ellipsis> Privileged Access </span> </a> </li> <li class=md-nav__item> <a href=../../stacking_the_deck/kerberos_double_hop/ class=md-nav__link> <span class=md-ellipsis> Kerberos Double Hop </span> </a> </li> <li class=md-nav__item> <a href=../../stacking_the_deck/bleeding_edge_vulns/ class=md-nav__link> <span class=md-ellipsis> Vulnerabilities </span> </a> </li> <li class=md-nav__item> <a href=../../stacking_the_deck/miscellaneous_misconfigurations/ class=md-nav__link> <span class=md-ellipsis> Misconfigurations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_9 type=checkbox id=__nav_4_3_1_9> <label class=md-nav__link for=__nav_4_3_1_9> <span class=md-ellipsis> Domain Trusts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Domain Trusts" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_9> <span class="md-nav__icon md-icon"></span> Domain Trusts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../why_so_trusting/domain_trusts_primer/ class=md-nav__link> <span class=md-ellipsis> Domain Trusts Primer </span> </a> </li> <li class=md-nav__item> <a href=../../why_so_trusting/atk_dom_trust_child_parent_trust_from_win/ class=md-nav__link> <span class=md-ellipsis> Attacking Domain Trusts - Child -> Parent - from Windows </span> </a> </li> <li class=md-nav__item> <a href=../../why_so_trusting/atk_dom_trust_child_parent_trust_from_linux/ class=md-nav__link> <span class=md-ellipsis> Attacking Domain Trusts - Child -> Parent - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_10 type=checkbox id=__nav_4_3_1_10> <label class=md-nav__link for=__nav_4_3_1_10> <span class=md-ellipsis> Cross-Forest Trust Abuse </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cross-Forest Trust Abuse" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_10> <span class="md-nav__icon md-icon"></span> Cross-Forest Trust Abuse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cross_forest_trust/cross_forest_trust_abuse_from_win/ class=md-nav__link> <span class=md-ellipsis> Cross-Forest Trust Abuse - from Windows </span> </a> </li> <li class=md-nav__item> <a href=../../cross_forest_trust/cross_forest_trust_abuse_from_linux/ class=md-nav__link> <span class=md-ellipsis> Cross-Forest Trust Abuse - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_1_11 type=checkbox id=__nav_4_3_1_11> <label class=md-nav__link for=__nav_4_3_1_11> <span class=md-ellipsis> Defensive Considerations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Defensive Considerations" data-md-level=4> <label class=md-nav__title for=__nav_4_3_1_11> <span class="md-nav__icon md-icon"></span> Defensive Considerations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../defensive_considerations/hardening_ad/ class=md-nav__link> <span class=md-ellipsis> Hardening Active Directory </span> </a> </li> <li class=md-nav__item> <a href=../../defensive_considerations/additional_auditing_techniques/ class=md-nav__link> <span class=md-ellipsis> Additional AD Auditing Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2 type=checkbox id=__nav_4_3_2> <label class=md-nav__link for=__nav_4_3_2> <span class=md-ellipsis> Footprinting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_4_3_2> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/domain_information/ class=md-nav__link> <span class=md-ellipsis> Domain Information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_2 type=checkbox id=__nav_4_3_2_2> <label class=md-nav__link for=__nav_4_3_2_2> <span class=md-ellipsis> Host Based Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/ftp/ class=md-nav__link> <span class=md-ellipsis> FTP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/smb/ class=md-nav__link> <span class=md-ellipsis> SMB </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/nfs/ class=md-nav__link> <span class=md-ellipsis> NFS </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/smtp/ class=md-nav__link> <span class=md-ellipsis> SMTP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/imap_pop3/ class=md-nav__link> <span class=md-ellipsis> IMAP/POP3 </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/snmp/ class=md-nav__link> <span class=md-ellipsis> SNMP </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/mysql/ class=md-nav__link> <span class=md-ellipsis> MySQL </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/mssql/ class=md-nav__link> <span class=md-ellipsis> MSSQL </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/ipmi/ class=md-nav__link> <span class=md-ellipsis> IPMI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_3 type=checkbox id=__nav_4_3_2_3> <label class=md-nav__link for=__nav_4_3_2_3> <span class=md-ellipsis> Remote Management Protocols </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../footprinting/linux_remote_management_protocol/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../footprinting/windows_remote_management_protocol/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_3 type=checkbox id=__nav_4_3_3> <label class=md-nav__link for=__nav_4_3_3> <span class=md-ellipsis> Attacking Common Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking Common Services" data-md-level=3> <label class=md-nav__title for=__nav_4_3_3> <span class="md-nav__icon md-icon"></span> Attacking Common Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../attacking_common_services/interacting/ class=md-nav__link> <span class=md-ellipsis> Interacting </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_ftp/ class=md-nav__link> <span class=md-ellipsis> FTP </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_smb/ class=md-nav__link> <span class=md-ellipsis> SMB </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_sql/ class=md-nav__link> <span class=md-ellipsis> SQL Databases </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_rdp/ class=md-nav__link> <span class=md-ellipsis> RDP </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../attacking_common_services/attacking_email_services/ class=md-nav__link> <span class=md-ellipsis> Email Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4 type=checkbox id=__nav_4_3_4> <label class=md-nav__link for=__nav_4_3_4> <span class=md-ellipsis> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_4_3_4> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1 type=checkbox id=__nav_4_3_4_1> <label class=md-nav__link for=__nav_4_3_4_1> <span class=md-ellipsis> Windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Windows data-md-level=4> <label class=md-nav__title for=__nav_4_3_4_1> <span class="md-nav__icon md-icon"></span> Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_1 type=checkbox id=__nav_4_3_4_1_1> <label class=md-nav__link for=__nav_4_3_4_1_1> <span class=md-ellipsis> Getting the Lay of the Land </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_1> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/gtlotl/ class=md-nav__link> <span class=md-ellipsis> Situational Awareness </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/init_enum/ class=md-nav__link> <span class=md-ellipsis> Initial Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/comm_with_ps/ class=md-nav__link> <span class=md-ellipsis> Communication with Processes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_2 type=checkbox id=__nav_4_3_4_1_2> <label class=md-nav__link for=__nav_4_3_4_1_2> <span class=md-ellipsis> Windows User Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_2> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/seimpersonate_seassignprimarytoken/ class=md-nav__link> <span class=md-ellipsis> SeImpersonate and SeAssignPrimaryToken </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/sebugpriv/ class=md-nav__link> <span class=md-ellipsis> SeDebugPrivilege </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/setakeownershippriv/ class=md-nav__link> <span class=md-ellipsis> SeTakeOwnershipPrivilege </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_3 type=checkbox id=__nav_4_3_4_1_3> <label class=md-nav__link for=__nav_4_3_4_1_3> <span class=md-ellipsis> Windows Group Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_3> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/builtin_groups/ class=md-nav__link> <span class=md-ellipsis> Windows Built-in Groups </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/eventlog_readers/ class=md-nav__link> <span class=md-ellipsis> Event Log Readers </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/dnsadmins/ class=md-nav__link> <span class=md-ellipsis> DnsAdmins </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/hyperv_admins/ class=md-nav__link> <span class=md-ellipsis> Hyper-V Administrators </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/print_operators/ class=md-nav__link> <span class=md-ellipsis> Print Operators </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/server_operators/ class=md-nav__link> <span class=md-ellipsis> Server Operators </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_4 type=checkbox id=__nav_4_3_4_1_4> <label class=md-nav__link for=__nav_4_3_4_1_4> <span class=md-ellipsis> Attacking the OS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_4> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/user_account_control/ class=md-nav__link> <span class=md-ellipsis> User Account Control </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/weak_permissions/ class=md-nav__link> <span class=md-ellipsis> Weak Permissions </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/vulnerable_services/ class=md-nav__link> <span class=md-ellipsis> Vulnerable Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_5 type=checkbox id=__nav_4_3_4_1_5> <label class=md-nav__link for=__nav_4_3_4_1_5> <span class=md-ellipsis> Credential Theft </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_5> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/other_files/ class=md-nav__link> <span class=md-ellipsis> Other Files </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/further_credential_theft/ class=md-nav__link> <span class=md-ellipsis> Further Credential Theft </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_1_6 type=checkbox id=__nav_4_3_4_1_6> <label class=md-nav__link for=__nav_4_3_4_1_6> <span class=md-ellipsis> Additional Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_1_6> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/windows/interacting_with_users/ class=md-nav__link> <span class=md-ellipsis> Interacting with Users </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/windows/miscellaneous_techniques/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_2 type=checkbox id=__nav_4_3_4_2> <label class=md-nav__link for=__nav_4_3_4_2> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=4> <label class=md-nav__title for=__nav_4_3_4_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/linux/enumeration/ class=md-nav__link> <span class=md-ellipsis> Enumeration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_4_2_2 type=checkbox id=__nav_4_3_4_2_2> <label class=md-nav__link for=__nav_4_3_4_2_2> <span class=md-ellipsis> Local Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Local Techniques" data-md-level=5> <label class=md-nav__title for=__nav_4_3_4_2_2> <span class="md-nav__icon md-icon"></span> Local Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../privesc/linux/kernel_exploits/ class=md-nav__link> <span class=md-ellipsis> Kernel Exploits </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/vulnerable_services/ class=md-nav__link> <span class=md-ellipsis> Vulnerable Services </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/cron_jobs/ class=md-nav__link> <span class=md-ellipsis> Cron Jobs </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/special_permissions/ class=md-nav__link> <span class=md-ellipsis> Special Permissions </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/sudo_rights_abuse/ class=md-nav__link> <span class=md-ellipsis> Sudo Rights Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/path_abuse/ class=md-nav__link> <span class=md-ellipsis> Path Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/wilcard_abuse/ class=md-nav__link> <span class=md-ellipsis> Wildcard Abuse </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/shared_libraries/ class=md-nav__link> <span class=md-ellipsis> Shared Libraries </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/shared_object_hijacking/ class=md-nav__link> <span class=md-ellipsis> Shared Object Hijacking </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/privileged_groups/ class=md-nav__link> <span class=md-ellipsis> Privileged Groups </span> </a> </li> <li class=md-nav__item> <a href=../../../privesc/linux/misc_techniques/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_5 type=checkbox id=__nav_4_3_5> <label class=md-nav__link for=__nav_4_3_5> <span class=md-ellipsis> File Transfers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_4_3_5> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_5_1 type=checkbox id=__nav_4_3_5_1> <label class=md-nav__link for=__nav_4_3_5_1> <span class=md-ellipsis> File Tranfer Methods </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Tranfer Methods" data-md-level=4> <label class=md-nav__title for=__nav_4_3_5_1> <span class="md-nav__icon md-icon"></span> File Tranfer Methods </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../file_transfers/windows_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/linux_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/transfering_files_w_code/ class=md-nav__link> <span class=md-ellipsis> Transfering Files with Code </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/miscellaneous_file_transfer_methods/ class=md-nav__link> <span class=md-ellipsis> Miscellaneous </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/protected_file_transfers/ class=md-nav__link> <span class=md-ellipsis> Protected File Transfers </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/catching_files_over_https/ class=md-nav__link> <span class=md-ellipsis> Catching Files over HTTP/S </span> </a> </li> <li class=md-nav__item> <a href=../../../file_transfers/living_off_the_land/ class=md-nav__link> <span class=md-ellipsis> LOTL </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6 type=checkbox id=__nav_4_3_6> <label class=md-nav__link for=__nav_4_3_6> <span class=md-ellipsis> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_4_3_6> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/nmap/ class=md-nav__link> <span class=md-ellipsis> Nmap </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2 type=checkbox id=__nav_4_3_6_2> <label class=md-nav__link for=__nav_4_3_6_2> <span class=md-ellipsis> MSF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=MSF data-md-level=4> <label class=md-nav__title for=__nav_4_3_6_2> <span class="md-nav__icon md-icon"></span> MSF </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2_1 type=checkbox id=__nav_4_3_6_2_1> <label class=md-nav__link for=__nav_4_3_6_2_1> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Components data-md-level=5> <label class=md-nav__title for=__nav_4_3_6_2_1> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_targets/ class=md-nav__link> <span class=md-ellipsis> Targets </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/components/msf_payloads/ class=md-nav__link> <span class=md-ellipsis> Payloads </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_6_2_2 type=checkbox id=__nav_4_3_6_2_2> <label class=md-nav__link for=__nav_4_3_6_2_2> <span class=md-ellipsis> Sessions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Sessions data-md-level=5> <label class=md-nav__title for=__nav_4_3_6_2_2> <span class="md-nav__icon md-icon"></span> Sessions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/msf/sessions/msf_sessions_jobs/ class=md-nav__link> <span class=md-ellipsis> Sessions & Jobs </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/msf/sessions/msf_sessions_meterpreter/ class=md-nav__link> <span class=md-ellipsis> Meterpreter </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tools/msf/additional_features/evasion/ class=md-nav__link> <span class=md-ellipsis> Evasion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7 type=checkbox id=__nav_4_3_7> <label class=md-nav__link for=__nav_4_3_7> <span class=md-ellipsis> Password Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Password Attacks" data-md-level=3> <label class=md-nav__title for=__nav_4_3_7> <span class="md-nav__icon md-icon"></span> Password Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_1 type=checkbox id=__nav_4_3_7_1> <label class=md-nav__link for=__nav_4_3_7_1> <span class=md-ellipsis> Remote Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_1> <span class="md-nav__icon md-icon"></span> Remote Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/remote_password_attacks/network_services/ class=md-nav__link> <span class=md-ellipsis> Network Services </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/remote_password_attacks/password_mutations/ class=md-nav__link> <span class=md-ellipsis> Password Mutations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_2 type=checkbox id=__nav_4_3_7_2> <label class=md-nav__link for=__nav_4_3_7_2> <span class=md-ellipsis> Windows Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Local Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_2> <span class="md-nav__icon md-icon"></span> Windows Local Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_sam/ class=md-nav__link> <span class=md-ellipsis> Attacking Sam </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_lsass/ class=md-nav__link> <span class=md-ellipsis> Attacking LSASS </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/attacking_ad_ntdsdit/ class=md-nav__link> <span class=md-ellipsis> Attacking AD & NTDS.dit </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/windows_local_password_attacks/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_3 type=checkbox id=__nav_4_3_7_3> <label class=md-nav__link for=__nav_4_3_7_3> <span class=md-ellipsis> Linux Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux Local Attacks" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_3> <span class="md-nav__icon md-icon"></span> Linux Local Attacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/linux_local_password_attacks/credential_hunting/ class=md-nav__link> <span class=md-ellipsis> Credential Hunting </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/linux_local_password_attacks/passwd_shadow_opasswd/ class=md-nav__link> <span class=md-ellipsis> Passwd, Shadow, Opasswd </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_7_4 type=checkbox id=__nav_4_3_7_4> <label class=md-nav__link for=__nav_4_3_7_4> <span class=md-ellipsis> Cracking Files </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cracking Files" data-md-level=4> <label class=md-nav__title for=__nav_4_3_7_4> <span class="md-nav__icon md-icon"></span> Cracking Files </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../password_attacks/cracking_files/protected_files/ class=md-nav__link> <span class=md-ellipsis> Protected Files </span> </a> </li> <li class=md-nav__item> <a href=../../../password_attacks/cracking_files/protected_archives/ class=md-nav__link> <span class=md-ellipsis> Protected Archives </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_8 type=checkbox id=__nav_4_3_8> <label class=md-nav__link for=__nav_4_3_8> <span class=md-ellipsis> Pivoting, Tunneling, Port Forwarding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pivoting, Tunneling, Port Forwarding" data-md-level=3> <label class=md-nav__title for=__nav_4_3_8> <span class="md-nav__icon md-icon"></span> Pivoting, Tunneling, Port Forwarding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ptpf/dynamic_port_forwarding_ssh/ class=md-nav__link> <span class=md-ellipsis> Dynamic Port Forwarding w/ SSH and SOCKS Tunneling </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/remote_reverse_port_forwarding_ssh/ class=md-nav__link> <span class=md-ellipsis> Remote/Reverse Port Forwarding w/ SSH </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/meterpreter_tunneling_and_port_forwarding/ class=md-nav__link> <span class=md-ellipsis> Meterpreter Tunneling & Port Forwarding </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_8_4 type=checkbox id=__nav_4_3_8_4> <label class=md-nav__link for=__nav_4_3_8_4> <span class=md-ellipsis> Socat </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Socat data-md-level=4> <label class=md-nav__title for=__nav_4_3_8_4> <span class="md-nav__icon md-icon"></span> Socat </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ptpf/socat/socat_reverse_shell/ class=md-nav__link> <span class=md-ellipsis> Reverse Shell </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/socat/socat_bind_shell/ class=md-nav__link> <span class=md-ellipsis> Bind Shell </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/ssh_for_win_plink/ class=md-nav__link> <span class=md-ellipsis> SSH for Windows: plink </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/ssh_pivoting_sshuttle/ class=md-nav__link> <span class=md-ellipsis> SSH Pivoting w/ Sshuttle </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/webserver_pivoting_rpivot/ class=md-nav__link> <span class=md-ellipsis> WebServer Pivoting w/ Rpivot </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/obstacles/port_forwarding_windows_netsh/ class=md-nav__link> <span class=md-ellipsis> Port Forwarding Windows: Netsh </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/dns_tunneling_dnscat2/ class=md-nav__link> <span class=md-ellipsis> DNS Tunneling w/ Dnscat2 </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/socks5_tunneling_chisel/ class=md-nav__link> <span class=md-ellipsis> SOCKS5 Tunneling with Chisel </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/icmp_tunneling_socks/ class=md-nav__link> <span class=md-ellipsis> ICMP Tunneling with SOCKS </span> </a> </li> <li class=md-nav__item> <a href=../../../ptpf/rdp_socks_tunneling_socksoverrdp/ class=md-nav__link> <span class=md-ellipsis> RDP and SOCKS Tunneling w/ SocksOverRDP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9 type=checkbox id=__nav_4_3_9> <label class=md-nav__link for=__nav_4_3_9> <span class=md-ellipsis> Web </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Web data-md-level=3> <label class=md-nav__title for=__nav_4_3_9> <span class="md-nav__icon md-icon"></span> Web </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1 type=checkbox id=__nav_4_3_9_1> <label class=md-nav__link for=__nav_4_3_9_1> <span class=md-ellipsis> Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Information Gathering" data-md-level=4> <label class=md-nav__title for=__nav_4_3_9_1> <span class="md-nav__icon md-icon"></span> Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1_1 type=checkbox id=__nav_4_3_9_1_1> <label class=md-nav__link for=__nav_4_3_9_1_1> <span class=md-ellipsis> Passive Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Passive Information Gathering" data-md-level=5> <label class=md-nav__title for=__nav_4_3_9_1_1> <span class="md-nav__icon md-icon"></span> Passive Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/whois/ class=md-nav__link> <span class=md-ellipsis> WHOIS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/dns/ class=md-nav__link> <span class=md-ellipsis> DNS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/passive_subdomain_enum/ class=md-nav__link> <span class=md-ellipsis> Subdomain Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/passive_info_gathering/passive_infrastructure_identification/ class=md-nav__link> <span class=md-ellipsis> Infrastructure Identification </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_1_2 type=checkbox id=__nav_4_3_9_1_2> <label class=md-nav__link for=__nav_4_3_9_1_2> <span class=md-ellipsis> Active Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Information Gathering" data-md-level=5> <label class=md-nav__title for=__nav_4_3_9_1_2> <span class="md-nav__icon md-icon"></span> Active Information Gathering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/active_infrastructure_identification/ class=md-nav__link> <span class=md-ellipsis> Infrastructure Identification </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/active_subdomain_enumeration/ class=md-nav__link> <span class=md-ellipsis> Subdomain Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/virtual_hosts/ class=md-nav__link> <span class=md-ellipsis> Virtual Hosts </span> </a> </li> <li class=md-nav__item> <a href=../../../web/info_gathering/active_info_gathering/crawling/ class=md-nav__link> <span class=md-ellipsis> Crawling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tools/ffuf/ class=md-nav__link> <span class=md-ellipsis> Ffuf </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/hydra/ class=md-nav__link> <span class=md-ellipsis> Hydra </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9_4 type=checkbox id=__nav_4_3_9_4> <label class=md-nav__link for=__nav_4_3_9_4> <span class=md-ellipsis> SQLMap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SQLMap data-md-level=4> <label class=md-nav__title for=__nav_4_3_9_4> <span class="md-nav__icon md-icon"></span> SQLMap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/sqlmap/build_attacks/ class=md-nav__link> <span class=md-ellipsis> Building Attacks </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/db_enumeration/ class=md-nav__link> <span class=md-ellipsis> DB Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/advanced_db_enumeration/ class=md-nav__link> <span class=md-ellipsis> Advanced DB Enumeration </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/bypassing_web_protections/ class=md-nav__link> <span class=md-ellipsis> Bypassing Web App Protections </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/sqlmap/os_exploitation/ class=md-nav__link> <span class=md-ellipsis> OS Exploitation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../web/xss/cross_site_scripting/ class=md-nav__link> <span class=md-ellipsis> XSS </span> </a> </li> <li class=md-nav__item> <a href=../../../web/lfi/local_file_inclusion/ class=md-nav__link> <span class=md-ellipsis> Local File Inclusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_10 type=checkbox id=__nav_4_3_10> <label class=md-nav__link for=__nav_4_3_10> <span class=md-ellipsis> Documenting & Reporting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Documenting & Reporting" data-md-level=3> <label class=md-nav__title for=__nav_4_3_10> <span class="md-nav__icon md-icon"></span> Documenting & Reporting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../documentation_and_reporting/preparation/ class=md-nav__link> <span class=md-ellipsis> Preparation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> <span class=md-ellipsis> Blue Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../file_analysis/useful_links/ class=md-nav__link> <span class=md-ellipsis> File Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2 type=checkbox id=__nav_4_4_2> <label class=md-nav__link for=__nav_4_4_2> <span class=md-ellipsis> Network Traffic Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_4_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/layers/ class=md-nav__link> <span class=md-ellipsis> Layers </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_3 type=checkbox id=__nav_4_4_2_3> <label class=md-nav__link for=__nav_4_4_2_3> <span class=md-ellipsis> Tcpdump </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> <span class=md-ellipsis> Fundamentals </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> <span class=md-ellipsis> Packet Filtering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_2_4 type=checkbox id=__nav_4_4_2_4> <label class=md-nav__link for=__nav_4_4_2_4> <span class=md-ellipsis> Wireshark </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_4_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> <span class=md-ellipsis> Advanced Usage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Credentialed Enumeration - Windows</h1> <h3>ActiveDirectory PowerShell Module</h3> <p>Discover Modules <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>PS C:\xyz&gt; Get-Module
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>ModuleType Version    Name                                ExportedCommands
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>---------- -------    ----                                ----------------
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>Manifest   3.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>Script     2.0.0      PSReadline                          {Get-PSReadLineKeyHandler, Get-PSReadLineOption, Remove-PS...
</code></pre></div></p> <p>The ActiveDirectory module is not yet imported. Import it. <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>PS C:\xyz&gt; Import-Module ActiveDirectory
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>PS C:\xyz&gt; Get-Module
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>ModuleType Version    Name                                ExportedCommands
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>---------- -------    ----                                ----------------
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>Manifest   1.0.1.0    ActiveDirectory                     {Add-ADCentralAccessPolicyMember, Add-ADComputerServiceAcc...
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>Manifest   3.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>Script     2.0.0      PSReadline                          {Get-PSReadLineKeyHandler, Get-PSReadLineOption, Remove-PS...  
</code></pre></div></p> <p>Enumerate some basic information about the domain with <a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-addomain?view=windowsserver2022-ps" target=_blank rel="noopener nofollow">Get-ADDomain</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>PS C:\xyz&gt; Get-ADDomain
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>AllowedDNSSuffixes                 : {}
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>ChildDomains                       : {LOGISTICS.legalcorp.local}
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>ComputersContainer                 : CN=Computers,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>DeletedObjectsContainer            : CN=Deleted Objects,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>DistinguishedName                  : DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>DNSRoot                            : legalcorp.local
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>DomainControllersContainer         : OU=Domain Controllers,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>DomainMode                         : Windows2016Domain
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>DomainSID                          : S-1-5-21-3842939050-3880317879-2865463114
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>ForeignSecurityPrincipalsContainer : CN=ForeignSecurityPrincipals,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>Forest                             : legalcorp.local
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>InfrastructureMaster               : ACADEMY-EA-DC01.legalcorp.local
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>LastLogonReplicationInterval       :
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>LinkedGroupPolicyObjects           : {cn={DDBB8574-E94E-4525-8C9D-ABABE31223D0},cn=policies,cn=system,DC=LEGALCORP,
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>                                     DC=LOCAL, CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=INLAN
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>                                     EFREIGHT,DC=LOCAL}
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>LostAndFoundContainer              : CN=LostAndFound,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>ManagedBy                          :
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>Name                               : LEGALCORP
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>NetBIOSName                        : LEGALCORP
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>ObjectClass                        : domainDNS
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>ObjectGUID                         : 71e4ecd1-a9f6-4f55-8a0b-e8c398fb547a
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>ParentDomain                       :
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>PDCEmulator                        : ACADEMY-EA-DC01.legalcorp.local
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>PublicKeyRequiredPasswordRolling   : True
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>QuotasContainer                    : CN=NTDS Quotas,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>ReadOnlyReplicaDirectoryServers    : {}
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>ReplicaDirectoryServers            : {ACADEMY-EA-DC01.legalcorp.local}
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>RIDMaster                          : ACADEMY-EA-DC01.legalcorp.local
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>SubordinateReferences              : {DC=LOGISTICS,DC=LEGALCORP,DC=LOCAL,
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>                                     DC=ForestDnsZones,DC=LEGALCORP,DC=LOCAL,
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>                                     DC=DomainDnsZones,DC=LEGALCORP,DC=LOCAL,
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a>                                     CN=Configuration,DC=LEGALCORP,DC=LOCAL}
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a>SystemsContainer                   : CN=System,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a>UsersContainer                     : CN=Users,DC=LEGALCORP,DC=LOCAL
</code></pre></div> <p>&lt;p<a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-aduser?view=windowsserver2022-ps" target=_blank rel="noopener nofollow">Get-ADUser</a> cmdlet. We will be filtering for accounts with the <code>ServicePrincipalName</code> property populated. This will get us a listing of accounts that may be susceptible to a Kerberoasting attack.</p></p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>PS C:\xyz&gt; Get-ADUser -Filter {ServicePrincipalName -ne &quot;$null&quot;} -Properties ServicePrincipalName
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>DistinguishedName    : CN=adfs,OU=Service Accounts,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>Enabled              : True
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>GivenName            : Sharepoint
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>Name                 : adfs
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>ObjectClass          : user
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>ObjectGUID           : 49b53bea-4bc4-4a68-b694-b806d9809e95
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>SamAccountName       : adfs
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>ServicePrincipalName : {adfsconnect/azure01.legalcorp.local}
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>SID                  : S-1-5-21-3842939050-3880317879-2865463114-5244
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>Surname              : Admin
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>UserPrincipalName    :
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>DistinguishedName    : CN=BACKUPAGENT,OU=Service Accounts,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>Enabled              : True
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>GivenName            : Jessica
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>Name                 : BACKUPAGENT
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>ObjectClass          : user
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>ObjectGUID           : 2ec53e98-3a64-4706-be23-1d824ff61bed
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>SamAccountName       : backupagent
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>ServicePrincipalName : {backupjob/veam001.legalcorp.local}
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>SID                  : S-1-5-21-3842939050-3880317879-2865463114-5220
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>Surname              : Systemmailbox 8Cc370d3-822A-4Ab8-A926-Bb94bd0641a9
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>UserPrincipalName    :
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>&lt;SNIP&gt;
</code></pre></div> <p>Verify domain trust relationships using <a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adtrust?view=windowsserver2022-ps" target=_blank rel="noopener nofollow">Get-ADTrust</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>PS C:\xyz&gt; Get-ADTrust -Filter *
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>Direction               : BiDirectional
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>DisallowTransivity      : False
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>DistinguishedName       : CN=LOGISTICS.legalcorp.local,CN=System,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>ForestTransitive        : False
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>IntraForest             : True
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>IsTreeParent            : False
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>IsTreeRoot              : False
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>Name                    : LOGISTICS.legalcorp.local
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>ObjectClass             : trustedDomain
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>ObjectGUID              : f48a1169-2e58-42c1-ba32-a6ccb10057ec
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>SelectiveAuthentication : False
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>SIDFilteringForestAware : False
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>SIDFilteringQuarantined : False
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>Source                  : DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>Target                  : LOGISTICS.legalcorp.local
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>TGTDelegation           : False
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>TrustAttributes         : 32
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>TrustedPolicy           :
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>TrustingPolicy          :
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>TrustType               : Uplevel
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>UplevelOnly             : False
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>UsesAESKeys             : False
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>UsesRC4Encryption       : False
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>Direction               : BiDirectional
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>DisallowTransivity      : False
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>DistinguishedName       : CN=LEGALLOGISTICS.LOCAL,CN=System,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>ForestTransitive        : True
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>IntraForest             : False
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>IsTreeParent            : False
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>IsTreeRoot              : False
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>Name                    : LEGALLOGISTICS.LOCAL
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>ObjectClass             : trustedDomain
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a>ObjectGUID              : 1597717f-89b7-49b8-9cd9-0801d52475ca
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>SelectiveAuthentication : False
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>SIDFilteringForestAware : False
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>SIDFilteringQuarantined : False
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a>Source                  : DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>Target                  : LEGALLOGISTICS.LOCAL
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a>TGTDelegation           : False
<a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a>TrustAttributes         : 8
<a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>TrustedPolicy           :
<a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a>TrustingPolicy          :
<a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a>TrustType               : Uplevel
<a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a>UplevelOnly             : False
<a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a>UsesAESKeys             : False
<a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a>UsesRC4Encryption       : False  
</code></pre></div> <p>This will print out any trust relationships the domain has. We can determine if they are trusts within our forest or with domains in other forests, the type of trust, the direction of the trust, and the name of the domain the relationship is with. This will be useful later on when looking to take advantage of child-to-parent trust relationships and attacking across forest trusts. Next, we can gather AD group information using the <a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup?view=windowsserver2022-ps" target=_blank rel="noopener nofollow">Get-ADGroup</a>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>PS C:\xyz&gt; Get-ADGroup -Filter * | select name
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>name
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>----
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>Administrators
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>Users
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>Guests
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>Print Operators
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>Backup Operators
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>Replicator
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>Remote Desktop Users
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>Network Configuration Operators
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>Performance Monitor Users
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>Performance Log Users
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>Distributed COM Users
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>IIS_IUSRS
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>Cryptographic Operators
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>Event Log Readers
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>Certificate Service DCOM Access
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>RDS Remote Access Servers
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>RDS Endpoint Servers
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>RDS Management Servers
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>Hyper-V Administrators
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>Access Control Assistance Operators
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>Remote Management Users
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>Storage Replica Administrators
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>Domain Computers
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>Domain Controllers
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>Schema Admins
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>Enterprise Admins
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>Cert Publishers
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>Domain Admins
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>&lt;SNIP&gt;
</code></pre></div> <p>We can take the results and feed interesting names back into the cmdlet to get more detailed information about a particular group:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>PS C:\xyz&gt; Get-ADGroup -Identity &quot;Backup Operators&quot;
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>DistinguishedName : CN=Backup Operators,CN=Builtin,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>GroupCategory     : Security
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>GroupScope        : DomainLocal
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>Name              : Backup Operators
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>ObjectClass       : group
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>ObjectGUID        : 6276d85d-9c39-4b7c-8449-cad37e8abc38
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>SamAccountName    : Backup Operators
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>SID               : S-1-5-32-551
</code></pre></div> <p>Member listing using <a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroupmember?view=windowsserver2022-ps" target=_blank rel="noopener nofollow">Get-ADGroupMember</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>PS C:\xyz&gt; Get-ADGroupMember -Identity &quot;Backup Operators&quot;
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>distinguishedName : CN=BACKUPAGENT,OU=Service Accounts,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>name              : BACKUPAGENT
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>objectClass       : user
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>objectGUID        : 2ec53e98-3a64-4706-be23-1d824ff61bed
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>SamAccountName    : backupagent
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>SID               : S-1-5-21-3842939050-3880317879-2865463114-5220
</code></pre></div> <p>We can see that one account, <code>backupagent</code>, belongs to this account. It is worth noting this down because if we can take over this service account through some attack, we could use its membership in the Backup Operators group to take over the domain.</p> <p>Tools like BloodHound can speed up this process and make our results far more accurate and organized.</p> <blockquote> <p>Utilizing the ActiveDirectory module on a host can be a stealthier way of performing actions than dropping a tool onto a host or loading it into memory and attempting to use it.</p> </blockquote> <hr> <h3>PowerView</h3> <p><a href=https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon target=_blank rel="noopener nofollow">PowerView</a> is a tool written in PowerShell to help us gain situational awareness within an AD environment.</p> <table> <thead> <tr> <th><strong>Command</strong></th> <th><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td><code>Export-PowerViewCSV </code></td> <td>Append results to a CSV file</td> </tr> <tr> <td><code>ConvertTo-SID</code></td> <td>Convert a User or group name to its SID value</td> </tr> <tr> <td><code>Get-DomainSPNTicket</code></td> <td>Requests the Kerberos ticket for a specified Service Principal Name (SPN) account</td> </tr> <tr> <td><strong>Domain/LDAP Functions:</strong></td> <td></td> </tr> <tr> <td><code>Get-Domain</code></td> <td>Will return the AD object for the current (or specified) domain</td> </tr> <tr> <td><code>Get-DomainController</code></td> <td>Return a list of the Domain Controllers for the specified domain</td> </tr> <tr> <td><code>Get-DomainUser</code></td> <td>Will return all users or specific user objects in AD</td> </tr> <tr> <td><code>Get-DomainComputer</code></td> <td>Will return all computers or specific computer objects in AD</td> </tr> <tr> <td><code>Get-DomainGroup</code></td> <td>Will return all groups or specific group objects in AD</td> </tr> <tr> <td><code>Get-DomainOU</code></td> <td>Search for all or specific OU objects in AD</td> </tr> <tr> <td><code>Find-InterestingDomainAcl</code></td> <td>Finds object ACLs in the domain with modification rights set to non-built in objects</td> </tr> <tr> <td><code>Get-DomainGroupMember </code></td> <td>Will return the members of a specific domain group</td> </tr> <tr> <td><code>Get-DomainFileServer </code></td> <td>Returns a list of servers likely functioning as file servers</td> </tr> <tr> <td><code>Get-DomainDFSShare</code></td> <td>Returns a list of all distributed file systems for the current (or specified) domain</td> </tr> <tr> <td><strong>GPO Functions:</strong></td> <td></td> </tr> <tr> <td><code>Get-DomainGPO</code></td> <td>Will return all GPOs or specific GPO objects in AD</td> </tr> <tr> <td><code>Get-DomainPolicy</code></td> <td>Returns the default domain policy or the domain controller policy for the current domain</td> </tr> <tr> <td><strong>Computer Enumeration Functions:</strong></td> <td></td> </tr> <tr> <td><code>Get-NetLocalGroup</code></td> <td>Enumerates local groups on the local or a remote machine</td> </tr> <tr> <td><code>Get-NetLocalGroupMember</code></td> <td>Enumerates members of a specific local group</td> </tr> <tr> <td><code>Get-NetShare </code></td> <td>Returns open shares on the local (or a remote) machine</td> </tr> <tr> <td><code>Get-NetSession</code></td> <td>Will return session information for the local (or a remote) machine</td> </tr> <tr> <td><code>Test-AdminAccess</code></td> <td>Tests if the current user has administrative access to the local (or a remote) machine</td> </tr> <tr> <td><strong>Threaded 'Meta'-Functions:</strong></td> <td></td> </tr> <tr> <td><code>Find-DomainUserLocation</code></td> <td>Finds machines where specific users are logged in</td> </tr> <tr> <td><code>Find-DomainShare</code></td> <td>Finds reachable shares on domain machines</td> </tr> <tr> <td><code>Find-InterestingDomainShareFile</code></td> <td>Searches for files matching specific criteria on readable shares in the domain</td> </tr> <tr> <td><code>Find-LocalAdminAccess</code></td> <td>Find machines on the local domain where the current user has local administrator access</td> </tr> <tr> <td><strong>Domain Trust Functions:</strong></td> <td></td> </tr> <tr> <td><code>Get-DomainTrust</code></td> <td>Returns domain trusts for the current domain or a specified domain</td> </tr> <tr> <td><code>Get-ForestTrust</code></td> <td>Returns all forest trusts for the current forest or a specified forest</td> </tr> <tr> <td><code>Get-DomainForeignUser</code></td> <td>Enumerates users who are in groups outside of the user's domain</td> </tr> <tr> <td><code>Get-DomainForeignGroupMember</code></td> <td>Enumerates groups with users outside of the group's domain and returns each foreign member</td> </tr> <tr> <td><code>Get-DomainTrustMapping</code></td> <td>Will enumerate all trusts for the current domain and any others seen.</td> </tr> </tbody> </table> <p><a href=https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainUser/ target=_blank rel="noopener nofollow">Get-DomainUser</a> will provide us with information on all users or specific users we specify.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>PS C:\xyz&gt; Get-DomainUser -Identity mmorgan -Domain legalcorp.local | Select-Object -Property name,samaccountname,description,memberof,whencreated,pwdlastset,lastlogontimestamp,accountexpires,admincount,userprincipalname,serviceprincipalname,useraccountcontrol
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>name                 : Matthew Morgan
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>samaccountname       : mmorgan
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>description          :
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>memberof             : {CN=VPN Users,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=Shared Calendar
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>                       Read,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=Printer Access,OU=Security
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>                       Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=File Share H Drive,OU=Security
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>                       Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL...}
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>whencreated          : 10/27/2021 5:37:06 PM
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>pwdlastset           : 11/18/2021 10:02:57 AM
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>lastlogontimestamp   : 2/27/2022 6:34:25 PM
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>accountexpires       : NEVER
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>admincount           : 1
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>userprincipalname    : mmorgan@legalcorp.local
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>serviceprincipalname :
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>mail                 :
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>useraccountcontrol   : NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD, DONT_REQ_PREAUTH
</code></pre></div> <p>We can use <a href=https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainGroupMember/ target=_blank rel="noopener nofollow">Get-DomainGroupMember</a> to retrieve group-specific information. Adding the <code>-Recurse</code> switch tells PowerView that if it finds any groups that are part of the target group (nested group membership) to list out the members of those groups. For example, the output below shows that the <code>Secadmins</code> group is part of the <code>Domain Admins</code> group through nested group membership. In this case, we will be able to view all of the members of that group who inherit Domain Admin rights via their group membership.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>PS C:\xyz&gt;  Get-DomainGroupMember -Identity &quot;Domain Admins&quot; -Recurse
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>GroupDomain             : legalcorp.local
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>GroupName               : Domain Admins
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>GroupDistinguishedName  : CN=Domain Admins,CN=Users,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>MemberDomain            : legalcorp.local
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>MemberName              : svc_qualys
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>MemberDistinguishedName : CN=svc_qualys,OU=Service Accounts,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>MemberObjectClass       : user
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>MemberSID               : S-1-5-21-3842939050-3880317879-2865463114-5613
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>GroupDomain             : legalcorp.local
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>GroupName               : Domain Admins
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>GroupDistinguishedName  : CN=Domain Admins,CN=Users,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>MemberDomain            : legalcorp.local
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>MemberName              : sp-admin
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>MemberDistinguishedName : CN=Sharepoint Admin,OU=Service Accounts,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>MemberObjectClass       : user
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>MemberSID               : S-1-5-21-3842939050-3880317879-2865463114-5228
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>GroupDomain             : legalcorp.local
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>GroupName               : Secadmins
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>GroupDistinguishedName  : CN=Secadmins,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>MemberDomain            : legalcorp.local
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>MemberName              : spong1990
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>MemberDistinguishedName : CN=Maggie
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>                          Jablonski,OU=Operations,OU=Logistics-HK,OU=Employees,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>MemberObjectClass       : user
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>MemberSID               : S-1-5-21-3842939050-3880317879-2865463114-1965
<a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>
<a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>&lt;SNIP&gt;  
</code></pre></div> <p>Now we know who to target for potential elevation of privileges. We can also enumerate domain trust mappings.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>PS C:\xyz&gt; Get-DomainTrustMapping
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>SourceName      : legalcorp.local
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>TargetName      : LOGISTICS.legalcorp.local
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>TrustType       : WINDOWS_ACTIVE_DIRECTORY
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>TrustAttributes : WITHIN_FOREST
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>TrustDirection  : Bidirectional
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>WhenCreated     : 11/1/2021 6:20:22 PM
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>WhenChanged     : 2/26/2022 11:55:55 PM
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>SourceName      : legalcorp.local
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>TargetName      : LEGALLOGISTICS.LOCAL
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>TrustType       : WINDOWS_ACTIVE_DIRECTORY
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>TrustAttributes : FOREST_TRANSITIVE
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>TrustDirection  : Bidirectional
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>WhenCreated     : 11/1/2021 8:07:09 PM
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>WhenChanged     : 2/27/2022 12:02:39 AM
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>SourceName      : LOGISTICS.legalcorp.local
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>TargetName      : legalcorp.local
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a>TrustType       : WINDOWS_ACTIVE_DIRECTORY
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>TrustAttributes : WITHIN_FOREST
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a>TrustDirection  : Bidirectional
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a>WhenCreated     : 11/1/2021 6:20:22 PM
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>WhenChanged     : 2/26/2022 11:55:55 PM 
</code></pre></div> <p>We can use <a href=https://powersploit.readthedocs.io/en/latest/Recon/Test-AdminAccess/ target=_blank rel="noopener nofollow">Test-AdminAccess</a> to test for local admin access on either the current machine or a remote one.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>PS C:\xyz&gt; Test-AdminAccess -ComputerName ACADEMY-EA-MS01
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>ComputerName    IsAdmin
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>------------    -------
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>ACADEMY-EA-MS01    True 
</code></pre></div> <p>We determined that the user we are currently using is an administrator on the host ACADEMY-EA-MS01.</p> <p>Now we can check for users with the SPN attribute set, which indicates that the account may be subjected to a Kerberoasting attack.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>PS C:\xyz&gt; Get-DomainUser -SPN -Properties samaccountname,ServicePrincipalName
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>serviceprincipalname                          samaccountname
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>--------------------                          --------------
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>adfsconnect/azure01.legalcorp.local       adfs
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>backupjob/veam001.legalcorp.local         backupagent
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>d0wngrade/kerberoast.legalcorp.local      d0wngrade
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>kadmin/changepw                               krbtgt
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>MSSQLSvc/DEV-PRE-SQL.legalcorp.local:1433 sqldev
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>MSSQLSvc/SPSJDB.legalcorp.local:1433      sqlprod
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>MSSQLSvc/SQL-CL01-01legalcorp.local:49351 sqlqa
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>sts/legalcorp.local                       solarwindsmonitor
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>testspn/kerberoast.legalcorp.local        testspn
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>testspn2/kerberoast.legalcorp.local       testspn2
</code></pre></div> <hr> <h3>SharpView</h3> <p>Here we can use SharpView to enumerate information about a specific user, such as the user <code>forend</code>, which we control.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>PS C:\xyz&gt; .\SharpView.exe Get-DomainUser -Identity forend
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>[Get-DomainSearcher] search base: LDAP://ACADEMY-EA-DC01.legalcorp.local/DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>[Get-DomainUser] filter string: (&amp;(samAccountType=805306368)(|(samAccountName=forend)))
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>objectsid                      : {S-1-5-21-3842939050-3880317879-2865463114-5614}
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>samaccounttype                 : USER_OBJECT
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>objectguid                     : 53264142-082a-4cb8-8714-8158b4974f3b
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>useraccountcontrol             : NORMAL_ACCOUNT
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>accountexpires                 : 12/31/1600 4:00:00 PM
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>lastlogon                      : 4/18/2022 1:01:21 PM
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>lastlogontimestamp             : 4/9/2022 1:33:21 PM
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>pwdlastset                     : 2/28/2022 12:03:45 PM
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>lastlogoff                     : 12/31/1600 4:00:00 PM
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>badPasswordTime                : 4/5/2022 7:09:07 AM
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>name                           : forend
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>distinguishedname              : CN=forend,OU=IT Admins,OU=IT,OU=HQ-NYC,OU=Employees,OU=Corp,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>whencreated                    : 2/28/2022 8:03:45 PM
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>whenchanged                    : 4/9/2022 8:33:21 PM
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>samaccountname                 : forend
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>memberof                       : {CN=VPN Users,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=Shared Calendar Read,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=Printer Access,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=File Share H Drive,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL, CN=File Share G Drive,OU=Security Groups,OU=Corp,DC=LEGALCORP,DC=LOCAL}
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>cn                             : {forend}
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>objectclass                    : {top, person, organizationalPerson, user}
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>badpwdcount                    : 0
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>countrycode                    : 0
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>usnchanged                     : 3259288
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>logoncount                     : 26618
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>primarygroupid                 : 513
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>objectcategory                 : CN=Person,CN=Schema,CN=Configuration,DC=LEGALCORP,DC=LOCAL
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>dscorepropagationdata          : {3/24/2022 3:58:07 PM, 3/24/2022 3:57:44 PM, 3/24/2022 3:52:58 PM, 3/24/2022 3:49:31 PM, 7/14/1601 10:36:49 PM}
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>usncreated                     : 3054181
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>instancetype                   : 4
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>codepage                       : 0
</code></pre></div> <p>SharpView can be useful when a client has hardened against PowerShell usage or we need to avoid using PowerShell.</p> <hr> <h3>Snaffler</h3> <p><a href=https://github.com/SnaffCon/Snaffler target=_blank rel="noopener nofollow">Snaffler</a> is a tool that can help us acquire credentials or other sensitive data in an Active Directory environment. Snaffler works by obtaining a list of hosts within the domain and then enumerating those hosts for shares and readable directories. Once that is done, it iterates through any directories readable by our user and hunts for files that could serve to better our position within the assessment. Snaffler requires that it be run from a domain-joined host or in a domain-user context.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>Snaffler.exe -s -d legalcorp.local -o snaffler.log -v data
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>PS C:\xyz&gt; .\Snaffler.exe  -d legalcorp.local -s -v data
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a> .::::::.:::.    :::.  :::.    .-:::::&#39;.-:::::&#39;:::    .,:::::: :::::::..
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>;;;`    ``;;;;,  `;;;  ;;`;;   ;;;&#39;&#39;&#39;&#39; ;;;&#39;&#39;&#39;&#39; ;;;    ;;;;&#39;&#39;&#39;&#39; ;;;;``;;;;
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>&#39;[==/[[[[, [[[[[. &#39;[[ ,[[ &#39;[[, [[[,,== [[[,,== [[[     [[cccc   [[[,/[[[&#39;
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>  &#39;&#39;&#39;    $ $$$ &#39;Y$c$$c$$$cc$$$c`$$$&#39;`` `$$$&#39;`` $$&#39;     $$&quot;&quot;   $$$$$$c
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a> 88b    dP 888    Y88 888   888,888     888   o88oo,.__888oo,__ 888b &#39;88bo,
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>  &#39;YMmMY&#39;  MMM     YM YMM   &#39;&#39;` &#39;MM,    &#39;MM,  &#39;&#39;&#39;&#39;YUMMM&#39;&#39;&#39;&#39;YUMMMMMMM   &#39;W&#39;
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>                         by l0ss and Sh3r4 - github.com/SnaffCon/Snaffler
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>2022-03-31 12:16:54 -07:00 [Share] {Black}(\\ACADEMY-EA-MS01.legalcorp.local\ADMIN$)
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>2022-03-31 12:16:54 -07:00 [Share] {Black}(\\ACADEMY-EA-MS01.legalcorp.local\C$)
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-MX01.legalcorp.local\address)
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares)
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.legalcorp.local\User Shares)
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>2022-03-31 12:16:54 -07:00 [Share] {Green}(\\ACADEMY-EA-DC01.legalcorp.local\ZZZ_archive)
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>2022-03-31 12:17:18 -07:00 [Share] {Green}(\\ACADEMY-EA-CA01.legalcorp.local\CertEnroll)
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.kdb$|289B|3/31/2022 12:09:22 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\GroupBackup.kdb) .kdb
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.key$|299B|3/31/2022 12:05:33 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\ShowReset.key) .key
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>2022-03-31 12:17:19 -07:00 [Share] {Green}(\\ACADEMY-EA-FILE.legalcorp.local\UpdateServicesPackages)
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.kwallet$|302B|3/31/2022 12:04:45 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\WriteUse.kwallet) .kwallet
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.key$|298B|3/31/2022 12:05:10 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\ProtectStep.key) .key
<a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.ppk$|275B|3/31/2022 12:04:40 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\StopTrace.ppk) .ppk
<a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.key$|301B|3/31/2022 12:09:17 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\WaitClear.key) .key
<a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.sqldump$|312B|3/31/2022 12:05:30 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\DenyRedo.sqldump) .sqldump
<a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.sqldump$|310B|3/31/2022 12:05:02 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\AddPublish.sqldump) .sqldump
<a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>2022-03-31 12:17:19 -07:00 [Share] {Green}(\\ACADEMY-EA-FILE.legalcorp.local\WsusContent)
<a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.keychain$|295B|3/31/2022 12:08:42 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\SetStep.keychain) .keychain
<a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.tblk$|279B|3/31/2022 12:05:25 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\FindConnect.tblk) .tblk
<a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.psafe3$|301B|3/31/2022 12:09:33 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\GetUpdate.psafe3) .psafe3
<a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.keypair$|278B|3/31/2022 12:09:09 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Infosec\UnprotectConvertTo.keypair) .keypair
<a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a>2022-03-31 12:17:19 -07:00 [File] {Black}&lt;KeepExtExactBlack|R|^\.tblk$|280B|3/31/2022 12:05:17 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\ExportJoin.tblk) .tblk
<a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.mdf$|305B|3/31/2022 12:09:27 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\FormatShow.mdf) .mdf
<a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a>2022-03-31 12:17:19 -07:00 [File] {Red}&lt;KeepExtExactRed|R|^\.mdf$|299B|3/31/2022 12:09:14 PM&gt;(\\ACADEMY-EA-DC01.legalcorp.local\Department Shares\IT\Development\LockConfirm.mdf) .mdf
<a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a>
<a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a>&lt;SNIP&gt;
</code></pre></div> <hr> <h3>BloodHound</h3> <p>First, we must authenticate as a domain user from a Windows attack host positioned within the network (but not joined to the domain) or transfer the tool to a domain-joined host. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>PS C:\xyz&gt; .\SharpHound.exe -c All --zipfilename lcorp
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>2022-04-18T13:58:22.1163680-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>2022-04-18T13:58:22.1163680-07:00|INFORMATION|Initializing SharpHound at 1:58 PM on 4/18/2022
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>2022-04-18T13:58:22.6788709-07:00|INFORMATION|Flags: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>2022-04-18T13:58:23.0851206-07:00|INFORMATION|Beginning LDAP search for legalcorp.local
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>2022-04-18T13:58:53.9132950-07:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 67 MB RAM
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>2022-04-18T13:59:15.7882419-07:00|INFORMATION|Producer has finished, closing LDAP channel
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>2022-04-18T13:59:16.1788930-07:00|INFORMATION|LDAP channel closed, waiting for consumers
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>2022-04-18T13:59:23.9288698-07:00|INFORMATION|Status: 3793 objects finished (+3793 63.21667)/s -- Using 112 MB RAM
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>2022-04-18T13:59:45.4132561-07:00|INFORMATION|Consumers finished, closing output channel
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>Closing writers
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>2022-04-18T13:59:45.4601086-07:00|INFORMATION|Output channel closed, waiting for output task to complete
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>2022-04-18T13:59:45.8663528-07:00|INFORMATION|Status: 3809 objects finished (+16 46.45122)/s -- Using 110 MB RAM
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>2022-04-18T13:59:45.8663528-07:00|INFORMATION|Enumeration finished in 00:01:22.7919186
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>2022-04-18T13:59:46.3663660-07:00|INFORMATION|SharpHound Enumeration Completed at 1:59 PM on 4/18/2022! Happy Graphing
</code></pre></div> <p>We can start by typing <code>domain:</code> in the search bar on the top left and choosing <code>legalcorp.local</code> from the results. The query <code>Find Computers with Unsupported Operating Systems</code> is great for finding outdated and unsupported operating systems running legacy software.</p> <p>We will often see users with local admin rights on their host. We can run the query <code>Find Computers where Domain Users are Local Admin</code> to quickly see if there are any hosts where all users have local admin rights. If this is the case, then any account we control can typically be used to access the host(s) in question, and we may be able to retrieve credentials from memory or find other sensitive data.</p> </article> </div> <script>var input,hash=location.hash.slice(1);hash.startsWith("__tabbed_")&&((input=document.getElementById(hash)).checked=!0)</script> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../credentialed_enumeration_from_linux/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Credentialed Enumeration - Linux" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Credentialed Enumeration - Linux </div> </div> </a> <a href=../living_off_the_land/ class="md-footer__link md-footer__link--next" aria-label="Next: Living Off The Land" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Living Off The Land </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 neutronsec </div> </div> <div class=md-social> <a href=https://github.com/neutronsec target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/neutronctf target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://secops.cc target=_blank rel=noopener title=secops.cc class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=mailto:hello@neutronsec.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m-3 13H7v-2h10m0-2H7v-2h10m3-2h-3V6h3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.720157f5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.d36b1844.min.js></script> </body> </html>